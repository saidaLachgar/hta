{"version":3,"file":"src_app_pages_visites_visite_module_ts.js","mappings":"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","sources":["./src/app/pages/visites/visite-details/visite-details.component.ts","./src/app/pages/visites/visite-details/visite-details.component.html","./src/app/pages/visites/visite-persist/visite-persist.component.ts","./src/app/pages/visites/visite-persist/visite-persist.component.html","./src/app/pages/visites/visite-routing.module.ts","./src/app/pages/visites/visite.module.ts","./src/app/pages/visites/visite.service.ts","./src/app/pages/visites/visites-list/visites-list.component.ts","./src/app/pages/visites/visites-list/visites-list.component.html"],"sourcesContent":["import { Component } from \"@angular/core\";\r\n\r\nimport { ActivatedRoute } from \"@angular/router\";\r\nimport { Visite } from \"src/app/core/models\";\r\nimport { AuthenticationService } from \"src/app/core/services/auth.service\";\r\nimport { visiteService } from \"../visite.service\";\r\n\r\n@Component({\r\n  selector: \"app-visite-details\",\r\n  templateUrl: \"./visite-details.component.html\",\r\n})\r\nexport class visiteDetailsComponent {\r\n  breadCrumbItems: Array<{}>;\r\n  visite: Visite;\r\n  currentEdge: any;\r\n\r\n  constructor(\r\n    private route: ActivatedRoute,\r\n    public service: visiteService,\r\n    public authService: AuthenticationService,\r\n  ) {\r\n    let id = route.snapshot.paramMap.get(\"id\");\r\n    service.getByKey(id).subscribe(obj => {\r\n      this.visite = obj;\r\n\r\n      // anomalies\r\n      this.currentEdge = {\r\n        ANode: obj.node_a[\"@id\"],\r\n        BNode: obj.node_b[\"@id\"],\r\n        department: obj.node_a.department[\"@id\"],\r\n        type: 'false'\r\n      }\r\n    });\r\n    \r\n  }\r\n}\r\n","<div class=\"container-fluid\">\r\n  <!-- start page title -->\r\n  <app-page-title\r\n    title=\"Détail de l'interruption\"\r\n    [Loading]=\"service.loading$ | async\"\r\n    [breadcrumbItems]=\"breadCrumbItems\"\r\n  ></app-page-title>\r\n  <!-- end page title -->\r\n  <div class=\"row\">\r\n    <div class=\"card mt-4\">\r\n      <div class=\"card-body pt-5\">\r\n        <div class=\"table-responsive\">\r\n          <table class=\"table table-nowrap mb-0\" *ngIf=\"visite\">\r\n            <tbody>\r\n              <tr>\r\n                <th scope=\"row\">Date :</th>\r\n                <td>{{visite.date | date:'medium':'Africa/Casablanca'}}</td>\r\n              </tr>\r\n              <tr>\r\n                <th scope=\"row\">Départ :</th>\r\n                <td><a \r\n                  *ngIf=\"visite.node_a.department\"\r\n                  [routerLink]=\"authService.isAuthorized('departments_details') ? ['/departments/details', visite.node_a.department.id] : null\"\r\n                  target=\"_blank\">{{visite.node_a.department.titre}}</a></td>\r\n              </tr>\r\n              <tr>\r\n                <th scope=\"row\">De :</th>\r\n                <td><a \r\n                  *ngIf=\"visite.node_a\"\r\n                  [routerLink]=\"authService.isAuthorized('nodes_details') ? ['/nodes/details', visite.node_a.id] : null\"\r\n                  target=\"_blank\">{{visite.node_a.titre}}</a></td>\r\n              </tr>\r\n              <tr>\r\n                <th scope=\"row\">À :</th>\r\n                <td><div *ngFor=\"let node_b of visite.node_b\">\r\n                  <a \r\n                    [routerLink]=\"authService.isAuthorized('nodes_details') ? ['/nodes/details', node_b.id] : null\"\r\n                    target=\"_blank\">- {{node_b.titre}}</a>\r\n                </div></td>\r\n              </tr>\r\n              <tr>\r\n                <th scope=\"row\">Longueur visitée :</th>\r\n                <td><b>{{visite.nbSupport}}</b> <small class=\"text-muted\">({{visite.nbSupport * 100}}/{{visite.edge_set_length}}km)</small></td>\r\n              </tr>\r\n              <tr>\r\n                <th scope=\"row\">Équipe :</th>\r\n                <td><a \r\n                  *ngIf=\"visite.team\"\r\n                  [routerLink]=\"authService.isAuthorized('teams_details') ? ['/teams/details', visite.team.id] : null\"\r\n                  target=\"_blank\">{{visite.team.titre}}</a></td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n        <button class=\"btn btn-light mt-4 float-end\" routerLink=\"/visite\"><i class=\"fas fa-arrow-circle-left me-1\"></i>Retour à la liste</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <app-related-anomalies  [currentEdge]=\"currentEdge\"></app-related-anomalies>\r\n</div>\r\n\r\n","import { Component } from \"@angular/core\";\r\nimport { FormArray, FormBuilder, FormGroup, Validators } from \"@angular/forms\";\r\nimport { visiteService } from \"../visite.service\";\r\nimport { AuthenticationService } from \"src/app/core/services/auth.service\";\r\nimport { anomalyService } from \"../../anomalies/anomaly.service\";\r\nimport { Edge, User } from \"src/app/core/models\";\r\nimport { ActivatedRoute } from \"@angular/router\";\r\nimport { Observable } from \"rxjs\";\r\n\r\nconst parseDate = d => new Date(Date.parse(d))\r\nconst timeObject = d => { return { hour: d.getHours(), minute: d.getMinutes(), second: d.getSeconds() } };\r\nconst dateObject = d => { return { year: d.getFullYear(), month: d.getMonth() + 1, day: d.getDate() } };\r\ninterface Alert {\r\n  message: string;\r\n  type: string;\r\n}\r\n@Component({\r\n  selector: \"app-visite-persist\",\r\n  templateUrl: \"./visite-persist.component.html\",\r\n})\r\nexport class visitePersistComponent {\r\n  breadCrumbItems: Array<{}>;\r\n  showError: boolean = false;\r\n  currentEdge: any;\r\n  id: string;\r\n  alert = window.alert;\r\n  alerts: Alert[] = [];\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private route: ActivatedRoute,\r\n    public service: visiteService,\r\n    public authService: AuthenticationService) {\r\n    this.breadCrumbItems = [{ label: 'Visites' }, { label: 'Fiche visite', active: true }];\r\n    service.loadDepartments(false);\r\n    service.loadANodes();\r\n    service.loadBNodes();\r\n    service.loadTeams();\r\n    service.visiteForm = this.fb.group({\r\n      anomalies: this.fb.array([]),\r\n      date: [\"\"],\r\n      time: [\"\"],\r\n      team: [\"\"],\r\n      nbSupport: [null],\r\n      department: [\"\", Validators.required],\r\n      nodeA: [\"\", Validators.required],\r\n      nodeB: [[]],\r\n    });\r\n    let paramId = this.route.snapshot.paramMap.get(\"id\");\r\n    if (paramId) {\r\n      this.service.EditeMode = true;\r\n\r\n      service.getByKey(Number(paramId)).subscribe((obj) => {\r\n        this.service.existingVisit = obj;\r\n        this.id = String(obj.id);\r\n\r\n        // fill ng-select\r\n        service.loadTeams(obj.team ? [obj.team] : []);\r\n        service.loadANodes(obj.node_a ? [obj.node_a] : []);\r\n        service.loadBNodes(obj.node_b ? obj.node_b : []);\r\n\r\n        // date / time start\r\n        let time = null; let date = null;\r\n        if (obj.date) {\r\n          date = parseDate(obj.date);\r\n          time = timeObject(date);\r\n        }\r\n\r\n        // date: obj.date ?  dateObject(new Date(obj.date)) : null,\r\n        service.visiteForm.patchValue({\r\n          date: dateObject(date),\r\n          time: time,\r\n          team: obj.team ? obj.team[\"@id\"] : null,\r\n          department: obj.node_a.department ? obj.node_a.department[\"@id\"] : null,\r\n          nodeA: obj.node_a ? obj.node_a[\"@id\"] : null,\r\n          nbSupport: obj.nbSupport ? obj.nbSupport : 0,\r\n          nodeB: obj.node_b.length ? obj.node_b.map((e) => e[\"@id\"]) : [],\r\n        });\r\n        this.currentEdge = {\r\n          ANode: this.service.ANode.value,\r\n          BNode: this.service.BNode.value,\r\n          department: obj.node_a.department[\"@id\"],\r\n          type: true\r\n        }\r\n\r\n        this.formListeners();\r\n      });\r\n\r\n    } else {\r\n      let d = new Date();\r\n      let currentTime = timeObject(d);\r\n      let today = dateObject(d);\r\n      service.visiteForm.patchValue({\r\n        date: today,\r\n        time: currentTime,\r\n      });\r\n\r\n      this.formListeners();\r\n    }\r\n\r\n  }\r\n\r\n  // Validation && Alerts\r\n  AlertANodeChange() {\r\n    this.addAlert(\"En changeant le PS, les champs tronçons d'anomalies seront réinitialisés.\", \"warning\")\r\n  }\r\n \r\n  AlertDeparChange() {\r\n    let anode = this.service.ANode.value;\r\n    let bnode = this.service.BNode.value;\r\n\r\n    let hasNonEmptyNodes = (anode && anode.trim() !== '') || (bnode && bnode.length !== 0);\r\n    let hasNonEmptyEdges = this.hasNonEmptyEdges;\r\n    (hasNonEmptyNodes || hasNonEmptyNodes) && this.addAlert(`En changeant le département, les champs ${hasNonEmptyNodes ? \"appareils de coupeur\" : \"\"}${hasNonEmptyNodes && hasNonEmptyEdges ? \" et \" : \"\"}${hasNonEmptyEdges ? \"tronçons d'anomalies\" : \"\"} seront réinitialisés.`, \"warning\")\r\n  }\r\n  removeAlert(alert: Alert) {\r\n    const index = this.alerts.indexOf(alert);\r\n    if (index !== -1) {\r\n      this.alerts.splice(index, 1);\r\n    }\r\n  }\r\n  addAlert(message: string, type: string) {\r\n    const index = this.alerts.findIndex(alert =>\r\n      alert.message === message && alert.type === type\r\n    );\r\n    if (index === -1) {\r\n      window.scrollTo(0, 0);\r\n      const alert: Alert = { message, type };\r\n      // add alert if not already exists\r\n      this.alerts.push(alert);\r\n      // remove alert after 30s\r\n      setTimeout(() => this.removeAlert(alert), 15000);\r\n    }\r\n  }\r\n \r\n  formListeners() {\r\n    let na = this.service.ANode;\r\n    let nb = this.service.BNode;\r\n    let dp = this.service.department;\r\n\r\n    // on change ANode -> reset && reload edges and anomalies\r\n    na.valueChanges.subscribe(() => {\r\n      // reset anomalies edges\r\n      this.anomalies.controls.forEach((control) => {\r\n        control.get('edge').reset();\r\n      });\r\n      //  reload edges and anomalies\r\n      this.currentEdge = {\r\n        ANode: na.value,\r\n        BNode: nb.value,\r\n        department: dp.value,\r\n        type: true\r\n      }\r\n    });\r\n\r\n    // on change BNode > reload edges and anomalies\r\n    nb.valueChanges.subscribe(() => {\r\n        na.value && na.value.trim() !== '' && (this.currentEdge = {\r\n          ANode: na.value,\r\n          BNode: nb.value,\r\n          department: dp.value,\r\n          type: true\r\n        });\r\n    });\r\n\r\n    // on change depar > reset edges  \r\n    dp.valueChanges.subscribe(() => {\r\n      na.reset();\r\n      nb.reset();\r\n      // reset anomalies edges\r\n      this.anomalies.controls.forEach((control) => {\r\n        control.get('edge').reset();\r\n      });\r\n\r\n    });\r\n  }\r\n  // Getters\r\n  get anomalies(): FormArray {\r\n    return this.service.visiteForm.get(\"anomalies\") as FormArray\r\n  }\r\n  get hasNonEmptyEdges() {\r\n    return this.anomalies.controls.some((control) => {\r\n      const edgeControl = control.get('edge');\r\n      return edgeControl && edgeControl.value.trim() !== '';\r\n    });\r\n  }\r\n\r\n  // logger(sa){console.log(sa);}\r\n}\r\n\r\n","<form class=\"container-fluid pb-5 mb-5\" [formGroup]=\"service.visiteForm\">\r\n  <!-- start page title -->\r\n  <app-page-title\r\n    title=\"Formulaire de visite\"\r\n    [Loading]=\"service.loading$ | async\"\r\n    [breadcrumbItems]=\"breadCrumbItems\"\r\n  ></app-page-title>\r\n  <!-- end page title -->\r\n\r\n  <div *ngFor=\"let alert of alerts\">\r\n    <ngb-alert \r\n    type=\"{{alert.type}}\" \r\n    (closed)=\"removeAlert(alert)\" \r\n    class=\"custom-alert glow mt-3\"\r\n    >\r\n      {{alert.message}}\r\n    </ngb-alert>\r\n  </div>\r\n\r\n  <div class=\"row mt-4\"> \r\n    <!-- visit -->\r\n    <div class=\"col-12\">\r\n      <div class=\"card\">\r\n        <div class=\"card-body\">\r\n          <div class=\"mb-3 row\">\r\n            <label for=\"name-input\" class=\"col-md-2 col-form-label\">Date</label>\r\n            <div class=\"col-md-10 row\">\r\n              <div class=\"col\">\r\n                <div class=\"input-group clockpicker\">\r\n                  <input ngbDatepicker [minDate]=\"{year: 1900, month: 1, day: 1}\" formControlName=\"date\" class=\"form-control\" (click)=\"ds.open()\" #ds=\"ngbDatepicker\">\r\n                </div>\r\n              </div>\r\n              <div class=\"col-auto\">\r\n                <ngb-timepicker [spinners]=\"false\" seconds=\"true\"  formControlName=\"time\"></ngb-timepicker>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"mb-3 row\">\r\n            <label for=\"input-2\" class=\"col-md-2 col-form-label\">Départ</label>\r\n            <div class=\"col-md-10\" id=\"input-2\" >\r\n              <ng-select \r\n                formControlName=\"department\"\r\n                placeholder=\"Dépar..\"\r\n                (open)=\"service.department.value && AlertDeparChange()\"\r\n              >\r\n              <ng-option *ngFor=\"let depar of (service.departments$ | async)\" [value]=\"'/api/departments/'+depar.id\">{{depar.titre}}</ng-option>\r\n            </ng-select>\r\n            <div #postfeedback *ngIf=\"showError && !service.department.value\" class=\"invalid-feedback d-block d-block\">Ce champ est obligatoire.</div>\r\n          </div>\r\n          </div>\r\n          <div class=\"mb-3 row\">\r\n            <label for=\"input-1\" class=\"col-md-2 col-form-label\">De</label>\r\n            <div class=\"col-md-10\" (click)=\"showError = true\" id=\"input-1\">\r\n                <ng-select [items]=\"service.ANode$ | async\"\r\n                          formControlName=\"nodeA\"\r\n                          bindLabel=\"titre\"\r\n                          bindValue=\"@id\"\r\n                          [minTermLength]=\"2\"\r\n                          [readonly]=\"!service.department.value\"\r\n                          [loading]=\"service.ANodeLoading\"\r\n                          [ngClass]=\"{'is-invalid':service.ANode.invalid && service.submitted}\"\r\n                          typeToSearchText=\"Veuillez saisir 2 caractères ou plus\"\r\n                          [typeahead]=\"service.ANodeInput$\">\r\n                </ng-select>\r\n                <div\r\n                  *ngIf=\"service.submitted && service.ANode.errors\"\r\n                  class=\"invalid-feedback d-block\">\r\n                  <span *ngIf=\"service.ANode.errors.required\">Ce champ est obligatoire.</span>\r\n                </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"mb-3 row\">\r\n            <label for=\"input-1\" class=\"col-md-2 col-form-label\">À</label>\r\n            <div class=\"col-md-10\" >\r\n              <ng-select [items]=\"service.BNode$ | async\"\r\n                      formControlName=\"nodeB\"\r\n                      bindLabel=\"titre\"\r\n                      bindValue=\"@id\"\r\n                      [minTermLength]=\"2\"\r\n                      [multiple]=\"true\"\r\n                      [readonly]=\"!service.department.value\"\r\n                      [loading]=\"service.BNodeLoading\"\r\n                      typeToSearchText=\"Veuillez saisir 2 caractères ou plus\"\r\n                      [typeahead]=\"service.BNodeInput$\">\r\n              </ng-select>\r\n              <div\r\n                *ngIf=\"service.submitted && service.BNode.errors\"\r\n                class=\"invalid-feedback d-block\">\r\n                <span *ngIf=\"service.BNode.errors.required\">Ce champ est obligatoire.</span>\r\n              </div>\r\n            </div>\r\n\r\n          </div>\r\n          <div class=\"mb-3 row\">\r\n            <label for=\"name-input\" class=\"col-md-2 col-form-label\">Équipe</label>\r\n            <div class=\"col-md-10\">\r\n              <ng-select [items]=\"service.teams$ | async\"\r\n                        formControlName=\"team\"\r\n                        bindLabel=\"titre\"\r\n                        bindValue=\"@id\"\r\n                        [minTermLength]=\"2\"\r\n                        [loading]=\"service.teamLoading\"\r\n                        typeToSearchText=\"Veuillez saisir 2 caractères ou plus\"\r\n                        [typeahead]=\"service.teamInput$\">\r\n              </ng-select>\r\n            </div>\r\n          </div>\r\n          <div class=\"mb-3 row\">\r\n            <label for=\"nbSupport-input\" class=\"col-md-2 col-form-label\">Longueur visitée</label>\r\n            <div class=\"col-md-10\">\r\n              <input\r\n                formControlName=\"nbSupport\"\r\n                class=\"form-control\"\r\n                type=\"number\"\r\n                step=\"1\" \r\n                id=\"nbSupport-input\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <!-- end col -->\r\n\r\n    <app-related-anomalies \r\n      [anomalies]=\"anomalies\"\r\n      [currentEdge]=\"currentEdge\"\r\n      [parentFormGroup]=\"service.visiteForm\"\r\n      [showErrors]=\"service.submitted\"\r\n      (addAlert)=\"addAlert($event.message, $event.type)\"\r\n    ></app-related-anomalies>\r\n\r\n  <div class=\"sticky-actions\">\r\n    <button\r\n      (click)=\"service.Persist('EDIT')\"\r\n      [disabled]=\"(service.loading$ | async) || service.anomalyLoading\"\r\n      class=\"btn btn-primary float-end\"\r\n    > Sauvegarder</button>\r\n\r\n    <button\r\n      (click)=\"service.Persist('NEW')\"\r\n      [disabled]=\"(service.loading$ | async) || service.anomalyLoading\"\r\n      *ngIf=\"!service.EditeMode\"\r\n      class=\"btn btn-light me-2 float-end text-primary\"\r\n      >Créer et ajouter un nouveau</button>\r\n\r\n    <button\r\n      [disabled]=\"(service.loading$ | async) || service.anomalyLoading\"\r\n      (click)=\"service.Persist('LIST')\"\r\n      class=\"btn btn-light me-2 float-end text-primary\"\r\n      ><i class=\"fas fa-arrow-circle-left me-1\"></i> Sauvegarder et retourner à la liste</button>\r\n\r\n    <button \r\n      [disabled]=\"(service.loading$ | async) || service.anomalyLoading\"\r\n      [class.d-none]=\"!service.EditeMode || !service.existingVisit\" \r\n      (click)=\"service.deleteItem()\"\r\n      type=\"button\" class=\"btn text-danger float-end me-2 fw-medium btn-light\">\r\n      <i class=\"mdi mdi-trash-can align-middle me-2\"></i>Supprimer\r\n    </button>\r\n    <i class=\"bx bx-loader-alt fa-spin float-end me-3\" *ngIf=\"service.submitted && ((service.loading$ | async) || service.anomalyLoading)\"></i>\r\n  </div>\r\n\r\n    <!-- end row -->\r\n</div>\r\n</form>\r\n","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { RoleGuard } from 'src/app/core/guards/role.guard';\r\nimport { visiteDetailsComponent } from './visite-details/visite-details.component';\r\nimport { visitesListComponent } from './visites-list/visites-list.component';\r\nimport { visitePersistComponent } from './visite-persist/visite-persist.component';\r\n\r\n\r\n\r\nconst routes: Routes = [\r\n  {path: '', component: visitesListComponent, canActivate: [RoleGuard], data: {access: 'visites_show'}},\r\n  {path: 'details/:id', component: visiteDetailsComponent, canActivate: [RoleGuard], data: {access: 'visites_details'}},\r\n  {path: 'persist/:id', component: visitePersistComponent, canActivate: [RoleGuard], data: {access: 'visites_update'}},\r\n  {path: 'persist', component: visitePersistComponent, canActivate: [RoleGuard], data: {access: 'visites_add'}},\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class visiteRoutingModule { }\r\n","import { NgModule } from '@angular/core';\r\n\r\n// import { UIModule } from 'src/app/shared/ui/ui.module';\r\nimport { visiteRoutingModule } from './visite-routing.module';\r\n\r\nimport { NgbAlertModule, NgbDatepickerModule, NgbPopoverModule, NgbTimepickerModule } from '@ng-bootstrap/ng-bootstrap';\r\nimport { SharedModule } from 'src/app/shared/shared.module';\r\nimport { NgApexchartsModule } from 'ng-apexcharts';\r\nimport { visitesListComponent } from './visites-list/visites-list.component';\r\nimport { visitePersistComponent } from './visite-persist/visite-persist.component';\r\nimport { visiteDetailsComponent } from './visite-details/visite-details.component';\r\nimport { relatedAnomaliesModule } from '../related-anomalies/related-anomalies.module';\r\n\r\n@NgModule({\r\n  imports: [\r\n    visiteRoutingModule,\r\n    SharedModule,\r\n    NgbDatepickerModule,\r\n    NgbTimepickerModule,\r\n    NgbPopoverModule,\r\n    NgbAlertModule,\r\n    NgApexchartsModule,\r\n    relatedAnomaliesModule\r\n  ],\r\n  declarations: [\r\n    visitesListComponent,\r\n    visitePersistComponent,\r\n    visiteDetailsComponent,\r\n  ],\r\n})\r\nexport class visiteModule { }\r\n","import { HttpClient } from \"@angular/common/http\";\r\nimport { Injectable } from \"@angular/core\";\r\nimport { FormArray, FormGroup } from \"@angular/forms\";\r\nimport { Router } from \"@angular/router\";\r\nimport { HotToastService } from \"@ngneat/hot-toast\";\r\nimport {\r\n  EntityCollectionServiceBase,\r\n  EntityCollectionServiceElementsFactory\r\n} from \"@ngrx/data\";\r\nimport { Observable, Subject, concat, of } from \"rxjs\";\r\nimport { catchError, debounceTime, distinctUntilChanged, filter, map, switchMap, tap } from \"rxjs/operators\";\r\nimport { Department, Node, Pagination, Team, Visite } from \"src/app/core/models\";\r\nimport { ConfirmDialogService } from \"src/app/shared/components/confirm-dialog/confirm-dialog.service\";\r\nimport { environment } from \"src/environments/environment\";\r\nimport { anomalyService } from \"../anomalies/anomaly.service\";\r\nimport { communeService } from \"../communes/commune.service\";\r\nimport { departmentService } from \"../departments/department.service\";\r\nimport { nodeService } from \"../nodes/node.service\";\r\n\r\nconst zeroPad = (num, places = 2) => String(num).padStart(places, '0');\r\nconst DateTimeToString = (date, time) => new Date(date.year, date.month - 1, date.day, time.hour, time.minute, time.second).toISOString();\r\nconst DateToString = (date) => date !== \"\" ? `${date.year}-${zeroPad(date.month)}-${zeroPad(date.day)}` : \"\";\r\n\r\n@Injectable({\r\n  providedIn: \"root\",\r\n})\r\nexport class visiteService extends EntityCollectionServiceBase<Visite> {\r\n  readonly pageSize = environment.pageSize;\r\n  private server = environment.serverURL;\r\n  visites$: Observable<Visite[]>;\r\n  existingVisit: Visite | boolean = false;\r\n  EditeMode: boolean = false;\r\n\r\n  ANode$: Observable<any[] | Node[]>;\r\n  ANodeLoading = false;\r\n  ANodeInput$ = new Subject<string>();\r\n\r\n  BNode$: Observable<any[] | Node[]>;\r\n  BNodeLoading = false;\r\n  BNodeInput$ = new Subject<string>();\r\n\r\n  departments$: Observable<Department[]>;\r\n  departmentLoading = false;\r\n  departmentInput$ = new Subject<string>();\r\n\r\n  teams$: Observable<Team[]>;\r\n  teamLoading = false;\r\n  teamInput$ = new Subject<string>();\r\n\r\n  pagination$: Observable<Pagination>;\r\n  submitted: boolean = false;\r\n  page: number = 1;\r\n  anomalyLoading: boolean = false;\r\n  lastSearchedParams;\r\n  public visiteForm: FormGroup;\r\n\r\n  constructor(\r\n    private serviceElementsFactory: EntityCollectionServiceElementsFactory,\r\n    private confirmDialogService: ConfirmDialogService,\r\n    public departmentService: departmentService,\r\n    public anomalyService: anomalyService,\r\n    public communeService: communeService,\r\n    public nodeService: nodeService,\r\n    private toast: HotToastService,\r\n    private http: HttpClient,\r\n    private router: Router,\r\n  ) {\r\n    super(\"visites\", serviceElementsFactory);\r\n  }\r\n\r\n  /**\r\n   * Get records\r\n   */\r\n  findAll(): void {\r\n    this.findByCriteria({ page: 1 });\r\n  }\r\n\r\n  loadTeams(defaultVal = []): void {\r\n    this.teams$ = concat(\r\n      of(defaultVal), // default items\r\n      this.teamInput$.pipe(\r\n        debounceTime(500),\r\n        distinctUntilChanged(),\r\n        filter((val) => val != null),\r\n        tap(() => this.teamLoading = true),\r\n        switchMap(term =>\r\n          this.http.get<Team[]>(`${this.server}/api/teams?properties[]=id&properties[]=titre&titre=` + term)\r\n            .pipe(\r\n              map(response => response[\"hydra:member\"]),\r\n              catchError(() => of([])), // empty list on error\r\n              tap(() => this.teamLoading = false)\r\n            )\r\n        )\r\n      )\r\n    );\r\n  }\r\n  loadDepartments(byTerm = true): void {\r\n    if (byTerm) {\r\n      this.departments$ = concat(\r\n        of([]), // default items\r\n        this.departmentInput$.pipe(\r\n          debounceTime(500),\r\n          distinctUntilChanged(),\r\n          filter((val) => val != null),\r\n          tap(() => this.departmentLoading = true),\r\n          switchMap(term => this.departmentService.getWithQuery(\"properties[]=id&properties[]=titre&titre=\" + term).pipe(\r\n            catchError(() => of([])), // empty list on error\r\n            tap(() => this.departmentLoading = false)\r\n          ))\r\n        )\r\n      );\r\n    } else {\r\n      this.departments$ = this.departmentService.getWithQuery(\"properties[]=id&properties[]=titre\");\r\n    }\r\n  }\r\n  loadANodes(defaultVal = []): void {\r\n    this.ANode$ = concat(\r\n      of(defaultVal), // default items\r\n      this.ANodeInput$.pipe(\r\n        debounceTime(500),\r\n        distinctUntilChanged(),\r\n        filter((val) => val != null),\r\n        tap(() => this.ANodeLoading = true),\r\n        switchMap(term => this.nodeService.getWithQuery(\r\n          \"properties[]=id&properties[]=titre&titre=\" + term +\r\n          (this.department ? \"&department.id=\" + this.department.value.match(/\\d+/)[0] : \"\") +\r\n          (this.departments ? \"&properties[department][]=titre&\" + this.departments.map(value => `department.id[]=${value}`).join('&') : \"\")\r\n        ).pipe(\r\n          catchError(() => of([])), // empty list on error\r\n          tap(() => this.ANodeLoading = false)\r\n        ))\r\n      )\r\n    );\r\n  }\r\n\r\n  loadBNodes(defaultVal = []): void {\r\n    this.BNode$ = concat(\r\n      of(defaultVal), // default items\r\n      this.BNodeInput$.pipe(\r\n        debounceTime(500),\r\n        distinctUntilChanged(),\r\n        filter((val) => val != null),\r\n        tap(() => this.BNodeLoading = true),\r\n        switchMap(term => this.nodeService.getWithQuery(\r\n          \"properties[]=id&properties[]=titre&titre=\" + term +\r\n          (this.department ? \"&department.id=\" + this.department.value.match(/\\d+/)[0] : \"\") +\r\n          (this.departments ? \"&properties[department][]=titre&\" + this.departments.map(value => `department.id[]=${value}`).join('&') : \"\")\r\n        ).pipe(\r\n          catchError(() => of([])), // empty list on error\r\n          tap(() => this.BNodeLoading = false)\r\n        ))\r\n      )\r\n    );\r\n  }\r\n  /**\r\n   * Get pagination\r\n   */\r\n  getPagination(): void {\r\n    this.pagination$ = of(); // reset pagination\r\n    // console.log(\"getPagination\")\r\n    this.pagination$ = this.selectors$.entityActions$.pipe(\r\n      map(action => (action as any).payload.pagination)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Delete item\r\n   * @param id visite id\r\n   * @param target html element\r\n   */\r\n  deleteItem(id: number = null, target: HTMLElement = null) {\r\n    this.confirmDialogService.setConfirmation(\"Vous êtes sûr de vouloir supprimer?\", () => {\r\n      this.delete(id ? id : (this.existingVisit as Visite).id)\r\n        .pipe(\r\n          this.toast.observe({\r\n            loading: \"Suppression...\",\r\n            success: () => {\r\n              target ? target.closest(\"tr\").remove() : this.router.navigate(['/visites']);\r\n              return \"supprimé avec succès\";\r\n            },\r\n            error: \"un problème est survenu, veuillez réessayer\",\r\n          })\r\n        )\r\n        .subscribe();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Search\r\n   */\r\n  onSearch(): void {\r\n    this.page = 1;\r\n    this.lastSearchedParams = this.visiteForm.value;\r\n    this.findByCriteria({ page: 1, ...this.lastSearchedParams });\r\n  }\r\n\r\n  /**\r\n   * Persist : Create / update\r\n   */\r\n  async Persist(Action: string): Promise<void> {\r\n    this.submitted = true;\r\n    if (this.visiteForm.invalid) return;\r\n    this.submitted = false;\r\n    let id = null;\r\n    if (!this.EditeMode) {\r\n      this.EditeMode = Action == 'EDIT';\r\n    } else {\r\n      // update Taff\r\n      id = this.existingVisit ? (this.existingVisit as Visite).id : null;\r\n    }\r\n\r\n    let form = this.visiteForm.value;\r\n    let _this = this;\r\n    let toast = this.toast;\r\n    let visite = {\r\n      date: form.date ? DateTimeToString(form.date, form.time) : null,\r\n      team: form.team ? form.team : null,\r\n      nbSupport: form.nbSupport ? form.nbSupport : 0,\r\n      department: form.department ? form.department : null,\r\n      nodeA: form.nodeA ? form.nodeA : null,\r\n      nodeB: form.nodeB && form.nodeB.length ? form.nodeB : [],\r\n    };\r\n    let anomalies = form.anomalies;\r\n    this.anomalyLoading = true;\r\n\r\n    anomalies.length && await this.anomalyService.bulkCreate(anomalies).toPromise();\r\n    this.anomalyLoading = false;\r\n\r\n    // compare last query with the new one to avoid unnecessary requests\r\n    if (id) {\r\n      visite[\"id\"] = id;\r\n      this.update(visite).subscribe({\r\n        error: () => toast.error(\"un problème est survenu, veuillez réessayer\"),\r\n        complete() {\r\n          toast.success(\"L'interuption a été sauvegardée avec succès \");\r\n          Action == 'LIST' && _this.router.navigate(['/visites']);\r\n          _this.submitted = false;\r\n        },\r\n      });\r\n    } else {\r\n      this.add(visite).pipe(tap(data => this.existingVisit = data))\r\n        .subscribe({\r\n          error: () => toast.error(\"un problème est survenu, veuillez réessayer\"),\r\n          complete() {\r\n            toast.success(\"L'interuption ajoutée avec succès\");\r\n            Action == 'NEW' && location.reload();\r\n            Action == 'LIST' && _this.router.navigate(['/visites']);\r\n            _this.submitted = false;\r\n          },\r\n        });\r\n    }\r\n\r\n    let anomalyFormArray = this.visiteForm.get(\"anomalies\") as FormArray;\r\n    while (anomalyFormArray.length !== 0) anomalyFormArray.removeAt(0);\r\n    this.anomalyService.getRelatedAnomalies(form.nodeA, form.nodeB, form.department);\r\n  }\r\n\r\n  /**\r\n   * find By Criteria\r\n   * @param obj query parameters\r\n   */\r\n  findByCriteria(obj): void {\r\n    this.visites$ = of([]); // clear table\r\n\r\n    // format date\r\n    if (Object.keys(obj).length > 1) {\r\n      // console.log(obj);\r\n      const updateObj = (key: string) => obj[key] && delete Object.assign(obj, { [\"date[\" + key + \"]\"]: DateToString(obj[key]) })[key];\r\n      updateObj(\"before\"); updateObj(\"after\");\r\n    }\r\n\r\n    // remove empty values\r\n    let queryParams = Object.keys(obj)\r\n      .filter((k) => obj[k] != \"\" && obj[k] != null)\r\n      .reduce((a, k) => ({ ...a, [k]: obj[k] }), {});\r\n    this.visites$ = this.getWithQuery(queryParams);\r\n    this.getPagination();\r\n  }\r\n\r\n  /**\r\n   * on Paginate\r\n   * @param page page to search for\r\n   */\r\n  onPaginate(page: number) {\r\n    this.findByCriteria({ page: page, ...this.lastSearchedParams });\r\n  }\r\n  get departments() {\r\n    let departments = this.visiteForm.controls[\"node_a.department.id[]\"];\r\n    return departments ? departments.value : null;\r\n  }\r\n  get designation() {\r\n    return this.visiteForm.get(\"designation\");\r\n  }\r\n  get department() {\r\n    return this.visiteForm.get(\"department\");\r\n  }\r\n  get BNode() {\r\n    return this.visiteForm.get(\"nodeB\");\r\n  }\r\n  get ANode() {\r\n    return this.visiteForm.get(\"nodeA\");\r\n  }\r\n}\r\n","import { Component } from \"@angular/core\";\r\nimport { FormBuilder } from \"@angular/forms\";\r\nimport { NgSelectConfig } from \"@ng-select/ng-select\";\r\nimport { AuthenticationService } from \"src/app/core/services/auth.service\";\r\nimport { visiteService } from \"../visite.service\";\r\n\r\n// Chart data\r\nexport interface ChartType {\r\n  chart?: any;\r\n  plotOptions?: any;\r\n  colors?: any;\r\n  series?: any;\r\n  stroke?: any;\r\n  fill?: any;\r\n  labels?: any;\r\n  markers?: any;\r\n  legend?: any;\r\n  xaxis?: any;\r\n  yaxis?: any;\r\n  tooltip?: any;\r\n  grid?: any;\r\n  datasets?: any;\r\n  options?: any;\r\n  toolbar?: any;\r\n  type?: any;\r\n  height?: any;\r\n  dataLabels?: any;\r\n  sparkline?: any;\r\n  responsive?: any;\r\n  states?: any;\r\n  title?: any;\r\n  subtitle?: any;\r\n}\r\n\r\n\r\n@Component({\r\n  selector: \"app-visites-list\",\r\n  templateUrl: \"./visites-list.component.html\",\r\n})\r\nexport class visitesListComponent {\r\n  breadCrumbItems: Array<{}>;\r\n  Chartdata: ChartType;\r\n\r\n  constructor(\r\n    public service: visiteService,\r\n    private fb: FormBuilder,\r\n    public authService: AuthenticationService,\r\n    private config: NgSelectConfig,\r\n  ) {\r\n    service.findAll();\r\n    service.loadTeams();\r\n    service.loadANodes();\r\n    service.loadBNodes();\r\n    service.loadDepartments();\r\n\r\n\r\n    service.visiteForm = fb.group({\r\n      nbSupport: [null],\r\n      before: [\"\"],\r\n      after: [\"\"],\r\n      \"node_a.department.id[]\": [\"\"],\r\n      \"node_a.id[]\": [''],\r\n      \"node_b.id[]\": [''],\r\n      \"team.id[]\": [\"\"],\r\n    });\r\n\r\n    config.notFoundText = 'Aucune donnée trouvée !';\r\n\r\n\r\n    this.Chartdata = {\r\n      chart: {\r\n        height: 220,\r\n        type: 'bar',\r\n        toolbar: {\r\n          show: false\r\n        }\r\n      },\r\n      plotOptions: {\r\n        bar: {\r\n          horizontal: true,\r\n        }\r\n      },\r\n      dataLabels: {\r\n        enabled: false\r\n      },\r\n      series: [{\r\n        data: [380, 430, 450, 475, 550, 584]\r\n      }],\r\n      colors: ['#269ffb'],\r\n      xaxis: {\r\n        // tslint:disable-next-line: max-line-length\r\n        categories: ['LAMZOUDIA', 'Chichaoua', 'SIDI BOUZID', 'Saidate', 'SIDI MED DALIL', 'Ahdil'],\r\n      },\r\n      grid: {\r\n        borderColor: '#f1f1f1'\r\n      },\r\n    };\r\n  }\r\n}\r\n","<div class=\"container-fluid mb-5\">\r\n  <!-- statistics -->\r\n  <div class=\"row\">\r\n    <div class=\"col-6 d-flex flex-column\">\r\n      <div class=\"card card-body py-2 flex-grow-0\">\r\n      <div class=\"row\">\r\n        <div class=\"col-7 p-1\">\r\n          <div class=\"border p-3 rounded-3\">\r\n            <p class=\"fw-medium mb-1\">Distance parcourue</p>\r\n            <div class=\"row\">\r\n              <div class=\"col-6\">\r\n                <small class=\"text-muted\">Année courante</small>\r\n                <strong class=\"h2 d-block\">1800 <small class=\"text-muted\">/12000 km</small></strong>\r\n              </div>\r\n              <div class=\"col-6\">\r\n                <small class=\"text-muted\">Mois en cours</small>\r\n                <strong class=\"h2 d-block\">800 km</strong>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"col-5 p-1\">\r\n          <div class=\"border p-3 rounded-3\">\r\n            <p class=\"fw-medium mb-2\">Anomalies <small class=\"text-muted\">(mois en cours)</small></p>\r\n            <p class=\"mt-2 mb-2\">\r\n              <span class=\"badge badge-soft-success font-size-11 me-2\"> 0.6% \r\n              <i class=\"mdi mdi-arrow-up\"></i></span><small>De la période précédente</small>\r\n            </p>\r\n            <strong class=\"h2 mb-0\">239</strong>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      </div>\r\n      <div class=\"card card-body flex-1\">\r\n        <div>\r\n            <div class=\"py-2\">\r\n                <h5 class=\"fw-medium mb-2\">Total des visites <small class=\"text-muted\">(par objectif annuel)</small><span class=\"float-end\">78%</span></h5>\r\n                <div class=\"progress animated-progess progress-sm\">\r\n                    <div class=\"progress-bar\" role=\"progressbar\" style=\"width: 78%\"\r\n                        aria-valuenow=\"78\" aria-valuemin=\"0\" aria-valuemax=\"100\"></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"col-6\">\r\n      <div class=\"card card-body pb-0\">\r\n        <p class=\"fw-medium mb-0\">Vistes par communes <small class=\"text-muted\">(année courante)</small></p>\r\n        <apx-chart class=\"apex-charts\" dir=\"ltr\" [series]=\"Chartdata.series\" [chart]=\"Chartdata.chart\"\r\n            [plotOptions]=\"Chartdata.plotOptions\" [dataLabels]=\"Chartdata.dataLabels\" [xaxis]=\"Chartdata.xaxis\"\r\n            [colors]=\"Chartdata.colors\" [grid]=\"Chartdata.grid\"></apx-chart>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n\r\n  <!-- actions -->\r\n  <div class=\"row align-items-center justify-content-between mb-4\">\r\n    <div class=\"col-auto\">\r\n      <app-page-title\r\n        title=\"Liste des visites\"\r\n        [breadcrumbItems]=\"breadCrumbItems\"\r\n      ></app-page-title>\r\n    </div>\r\n    \r\n    <div class=\"col-auto\">\r\n      <a routerLink=\"/visites/persist\" class=\"btn btn-primary ms-2\"\r\n      *ngIf=\"authService.isAuthorized('visites_add')\"\r\n        ><i class=\"fas fa-plus-circle\"></i> Ajouter</a\r\n      >\r\n    </div>\r\n  </div>\r\n\r\n  <!-- data -->\r\n  <div class=\"row\">\r\n    <div class=\"col-12\">\r\n      <div class=\"card\">\r\n        <div class=\"card-body\">\r\n          <!-- Table -->\r\n          <form [formGroup]=\"service.visiteForm\" (ngSubmit)=\"service.onSearch()\" class=\"table-responsive\">\r\n            <table class=\"table table-bordered\">\r\n              <thead>\r\n                <tr>\r\n                  <th style=\"min-width: 200px;\">Date</th>\r\n                  <th style=\"min-width: 200px;\">Départ</th>\r\n                  <th style=\"min-width: 130px;\">De</th>\r\n                  <th style=\"min-width: 130px;\">À</th>\r\n                  <th style=\"min-width: 130px;\">Longueur visitée</th>\r\n                  <th style=\"min-width: 130px;\">Équipe</th>\r\n                  <th style=\"min-width: 130px;\">Anomalies</th>\r\n                  <th width=\"123px\"></th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                <!-- search -->\r\n                <tr valign=\"middle\">\r\n                  <!-- date -->\r\n                  <td>\r\n                    <div class=\"d-flex gap-2\">\r\n                    <div class=\"input-group clockpicker\">\r\n                      <input #searchDateStart ngbDatepicker formControlName=\"after\" class=\"form-control\" (click)=\"ds.open()\" placeholder=\"De...\" #ds=\"ngbDatepicker\">\r\n                    </div>\r\n                    <div class=\"input-group clockpicker\">\r\n                      <input #searchDateEnd ngbDatepicker formControlName=\"before\" class=\"form-control\" (click)=\"de.open()\" placeholder=\"À...\" #de=\"ngbDatepicker\">\r\n                    </div>\r\n                    </div>\r\n                  </td>\r\n                  <!-- Départ -->\r\n                  <td>\r\n                    <ng-select [items]=\"service.departments$ | async\"\r\n                        #searchDepar\r\n                        formControlName=\"node_a.department.id[]\"\r\n                        bindLabel=\"titre\"\r\n                        bindValue=\"id\"\r\n                        [multiple]=\"true\"\r\n                        [minTermLength]=\"2\"\r\n                        placeholder=\"Départ..\"\r\n                        [loading]=\"service.departmentLoading\"\r\n                        typeToSearchText=\"Veuillez saisir 2 caractères ou plus\"\r\n                        [typeahead]=\"service.departmentInput$\">\r\n                    </ng-select>\r\n                  </td>\r\n                   <!-- nodeA -->\r\n                   <td>\r\n                    <ng-select [items]=\"service.ANode$ | async\"\r\n                        #searchANode\r\n                        formControlName=\"node_a.id[]\"\r\n                        bindValue=\"id\"\r\n                        [multiple]=\"true\"\r\n                        [minTermLength]=\"2\"\r\n                        placeholder=\"De..\"\r\n                        [readonly]=\"!service.departments\"\r\n                        [loading]=\"service.ANodeLoading\"\r\n                        typeToSearchText=\"Veuillez saisir 2 caractères ou plus\"\r\n                        [typeahead]=\"service.ANodeInput$\">\r\n                        <ng-template ng-label-tmp let-item=\"item\">\r\n                          {{ item.titre }}<span *ngIf=\"service.departments && service.departments.length > 1\"> - {{ item.department.titre }}</span>\r\n                        </ng-template>\r\n                        <ng-template ng-option-tmp let-item=\"item\">\r\n                          {{ item.titre }}<span *ngIf=\"service.departments && service.departments.length > 1\"> - {{ item.department.titre }}</span>\r\n                        </ng-template>\r\n                    </ng-select>\r\n                  </td>\r\n                  <!-- nodeB -->\r\n                  <td>\r\n                    <ng-select [items]=\"service.BNode$ | async\"\r\n                        #searchBNode\r\n                        formControlName=\"node_b.id[]\"\r\n                        bindValue=\"id\"\r\n                        [multiple]=\"true\"\r\n                        [minTermLength]=\"2\"\r\n                        placeholder=\"À..\"\r\n                        [readonly]=\"!service.departments\"\r\n                        [loading]=\"service.BNodeLoading\"\r\n                        typeToSearchText=\"Veuillez saisir 2 caractères ou plus\"\r\n                        [typeahead]=\"service.BNodeInput$\">\r\n                        <ng-template ng-label-tmp let-item=\"item\">\r\n                          {{ item.titre }}<span *ngIf=\"service.departments && service.departments.length > 1\"> - {{ item.department.titre }}</span>\r\n                        </ng-template>\r\n                        <ng-template ng-option-tmp let-item=\"item\">\r\n                          {{ item.titre }}<span *ngIf=\"service.departments && service.departments.length > 1\"> - {{ item.department.titre }}</span>\r\n                        </ng-template>\r\n                    </ng-select>\r\n                  </td>\r\n                  <!-- Longueur visitée -->\r\n                  <td>\r\n                    <input type=\"text\" placeholder=\"Longueur visitée...\" formControlName=\"nbSupport\" #searchNbSupport class=\"form-control\">\r\n                  </td>\r\n                  <!-- Équipe -->\r\n                  <td>\r\n                    <ng-select [items]=\"service.teams$ | async\"\r\n                              #searchTeam\r\n                              formControlName=\"team.id[]\"\r\n                              bindLabel=\"titre\"\r\n                              bindValue=\"id\"\r\n                              [multiple]=\"true\"\r\n                              [minTermLength]=\"2\"\r\n                              placeholder=\"Équipe..\"\r\n                              [loading]=\"service.teamLoading\"\r\n                              typeToSearchText=\"Veuillez saisir 2 caractères ou plus\"\r\n                              [typeahead]=\"service.teamInput$\">\r\n                    </ng-select>\r\n                  </td>\r\n                  <td></td>\r\n                 <!-- Actions -->\r\n                  <td>\r\n                    <button type=\"submit\" class=\"btn btn-sm btn-primary d-flex align-items-center\">\r\n                      <i class=\"bx bx-search me-1\"></i>Rechercher\r\n                    </button>\r\n                    <button type=\"reset\" class=\"btn btn-sm text-primary flex align-items-center\" (click)=\"service.findAll()\">\r\n                      <i class=\"bx bx-x me-1\"></i>Réinitialiser\r\n                    </button>\r\n                  </td>\r\n                </tr>\r\n                <!-- state -->\r\n                <tr>\r\n                  <td\r\n                    class=\"text-center\"\r\n                    colspan=\"8\"\r\n                    *ngIf=\"!(service.visites$ | async) && service.loading$ | async\"\r\n                  >\r\n                    Chargement...\r\n                  </td>\r\n                  <td\r\n                    class=\"text-center\"\r\n                    colspan=\"8\"\r\n                    *ngIf=\"(service.visites$ | async) && (service.visites$ | async).length === 0 && service.loaded$ | async\"\r\n                  >\r\n                  Aucune donnée trouvée !\r\n                  </td>\r\n                </tr>\r\n                <!-- data -->\r\n                <tr *ngFor=\"let item of (service.visites$ | async); let i = index\" valign=\"middle\">\r\n                  <!-- date -->\r\n                  <td>\r\n                    <ngb-highlight\r\n                      [result]=\"item.date | date:'medium':'Africa/Casablanca'\"\r\n                      [term]=\"searchDateStart.value+searchDateEnd.value\"\r\n                    ></ngb-highlight>\r\n                  </td>\r\n                  <!-- department -->\r\n                  <td>\r\n                    <a \r\n                      *ngIf=\"item.node_a.department\"\r\n                      [routerLink]=\"authService.isAuthorized('departments_details') ? ['/departments/details', item.node_a.department.id] : null\"\r\n                      target=\"_blank\">{{item.node_a.department.titre}}</a>\r\n                  </td>\r\n                  <!-- nodeA -->\r\n                  <td>\r\n                    <a \r\n                      *ngIf=\"item.node_a\"\r\n                      [routerLink]=\"authService.isAuthorized('nodes_details') ? ['/nodes/details', item.node_a.id] : null\"\r\n                      target=\"_blank\">{{item.node_a.titre}}</a>\r\n                  </td>\r\n                  \r\n                  <!-- nodeB -->\r\n                  <td>\r\n                    <div *ngFor=\"let node_b of item.node_b\">\r\n                      <a \r\n                        [routerLink]=\"authService.isAuthorized('nodes_details') ? ['/nodes/details', node_b.id] : null\"\r\n                        target=\"_blank\">- {{node_b.titre}}</a>\r\n                    </div>\r\n                  </td>\r\n                  \r\n                  <!-- Longueur visitée -->\r\n                  <td>\r\n                    <b><ngb-highlight\r\n                      [result]=\"item.nbSupport\"\r\n                      [term]=\"searchNbSupport.value\"\r\n                    ></ngb-highlight> Support</b><br>\r\n                    <small class=\"text-muted\">({{item.nbSupport * 100}}/{{item.edge_set_length}}km)</small>\r\n                  </td>\r\n\r\n                  <!-- team -->\r\n                  <td>\r\n                    <a \r\n                      *ngIf=\"item.team\"\r\n                      [routerLink]=\"authService.isAuthorized('teams_details') ? ['/teams/details', item.team.id] : null\"\r\n                      target=\"_blank\">{{item.team.titre}}</a>\r\n                  </td>\r\n                  \r\n\r\n                  <!-- Anomalies -->\r\n                  <td>\r\n                    <a\r\n                      href=\"javascript: void(0);\"\r\n                      fragment=\"anomalies-list\"\r\n                      [routerLink]=\"authService.isAuthorized('visites_details') ? ['details', item.id] : []\"\r\n                    >\r\n                    <ng-container *ngIf=\"item.undone_anomalies > 0 && item.undone_anomalies != item.total_anomalies; else NoAnomalies\">\r\n                      <div  class=\"badge badge-soft-danger c-pointer rounded-pill border-danger border px-3 py-2 font-size-13 w-100\">\r\n                        <i class=\"fas fa-exclamation-triangle me-2\"></i> <span class=\"text-body\">{{item.undone_anomalies}}/{{item.total_anomalies}} Anomalies</span>\r\n                      </div>\r\n                    </ng-container>\r\n                    <ng-template #NoAnomalies>\r\n                      <ng-container *ngIf=\"item.total_anomalies == 0; else AllResolved\">\r\n                        <div class=\"badge badge-soft-info c-pointer rounded-pill border-info border px-3 py-2 font-size-13 w-100\">\r\n                          <i class=\"fas fa-info-circle me-2\"></i> <span class=\"text-body\">Pas d'anomalies</span>\r\n                        </div>\r\n                      </ng-container>\r\n                      <ng-template #AllResolved>\r\n                        <div class=\"badge badge-soft-success c-pointer rounded-pill border-success border px-3 py-2 font-size-13 w-100\">\r\n                          <i class=\"fas fa-check-circle me-2\"></i> <span class=\"text-body\">Toutes résolues</span>\r\n                        </div>\r\n                      </ng-template>\r\n                    </ng-template>\r\n                    </a>\r\n                  </td>\r\n\r\n                  <!-- actions -->\r\n                  <td align=\"center\">\r\n                    <div ngbDropdown \r\n                      placement=\"bottom-left\"\r\n                      *ngIf=\"authService.isAuthorized('visites_details') || authService.isAuthorized('visites_update') || authService.isAuthorized('visites_delete')\"\r\n                      >\r\n                      <i\r\n                        class=\"fas fa-ellipsis-h dropdown-toggle c-pointer\"\r\n                        ngbDropdownToggle\r\n                        data-toggle=\"dropdown\"\r\n                        aria-expanded=\"true\"\r\n                      ></i>\r\n                      <div\r\n                        class=\"dropdown-menu dropdown-menu-end\"\r\n                        ngbDropdownMenu\r\n                      >\r\n                        <a class=\"dropdown-item\"\r\n                          [routerLink]=\"['details', item.id]\"\r\n                          href=\"javascript: void(0);\"\r\n                          *ngIf=\"authService.isAuthorized('visites_details')\"\r\n                          >\r\n                          <i class=\"fas fa-eye me-2\"></i> Voir\r\n                        </a>\r\n                        <a\r\n                          class=\"dropdown-item\"\r\n                          href=\"javascript: void(0);\"\r\n                          *ngIf=\"authService.isAuthorized('visites_update')\"\r\n                          [routerLink]=\"['persist', item.id]\"\r\n                          >\r\n                          <!-- skipLocationChange -->\r\n                          <i class=\"fas fa-edit me-2\"></i> Modifier\r\n                        </a>\r\n                        <a\r\n                          class=\"dropdown-item text-danger\"\r\n                          href=\"javascript: void(0);\"\r\n                          *ngIf=\"authService.isAuthorized('visites_delete')\"\r\n                          (click)=\"service.deleteItem(item.id, $event.target)\"\r\n                        >\r\n                          <i class=\"fas fa-trash me-2\"></i> Supprimer\r\n                        </a>\r\n                      </div>\r\n                    </div>\r\n                  </td>\r\n                  \r\n                  \r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </form>\r\n          <!-- End table -->\r\n          <!-- Pagination -->\r\n          <ng-container *ngIf=\"(service.pagination$ | async) as pagination\">\r\n            <div\r\n              *ngIf=\"pagination.totalRecords > service.pageSize\"\r\n              class=\"row justify-content-md-between align-items-md-center mt-2\"\r\n            >\r\n              <div class=\"col-sm-12 col-md-5\">\r\n                <div\r\n                  class=\"dataTables_info mb-2\"\r\n                  id=\"tickets-table_info\"\r\n                  role=\"status\"\r\n                  aria-live=\"polite\"\r\n                >\r\n                Affichage de {{pagination.startIndex}} \r\n                à {{pagination.endIndex}} \r\n                de {{pagination.totalRecords}} entrées\r\n                </div>\r\n              </div>\r\n              <div class=\"col-sm-12 col-md-5\">\r\n                <div class=\"text-md-right float-md-end pagination-rounded\">\r\n                  <ngb-pagination\r\n                    [collectionSize]=\"pagination.totalRecords\"\r\n                    [(page)]=\"service.page\"\r\n                    [pageSize]=\"service.pageSize\"\r\n                    (pageChange)=\"service.onPaginate($event)\" [maxSize]=\"5\" \r\n                  >\r\n                  </ngb-pagination>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </ng-container>\r\n          <!-- End Pagination -->\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>"],"names":[],"sourceRoot":"webpack:///"}