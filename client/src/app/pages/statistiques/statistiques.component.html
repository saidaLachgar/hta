<div class="container-fluid">
    <!-- start page title -->
    <div class="row">
        <div class="col-12">
            <div class="page-title-box">
                <p class="mb-0 h4">Statistiques</p>
            </div>
        </div>
    </div>
    <!-- end page title -->

    <div class="row mt-4">
        <div class="col-12">
            <form class="card card-body" [formGroup]="form" (ngSubmit)="getStatistics()">
                <div class="row g-2 align-items-center justify-content-center">

                <label class="col-xl-auto">Date : </label>
                <div class="col-xl-auto clockpicker">
                    <input ngbDatepicker [minDate]="{year: 1900, month: 1, day: 1}" formControlName="dateStart" class="form-control" (click)="ds.open()" #ds="ngbDatepicker">
                </div>
                <div class="col-xl-auto clockpicker">
                    <input ngbDatepicker [minDate]="{year: 1900, month: 1, day: 1}" formControlName="dateEnd" class="form-control" (click)="de.open()" #de="ngbDatepicker">
                </div>
                
                <span class="mx-3 my-0 text-muted w-auto d-none d-xl-block">|</span>

                <label class="col-xl-auto mt-3 mt-xl-2" [ngClass]="{'text-danger':team.invalid && submitted}">Equipe * : </label>
                <div class="col-xl-2">
                <ng-select formControlName="team" placeholder="Equipe">
                    <ng-option *ngFor="let team of (service.teams$ | async)" [value]="team.id">{{team.titre}}</ng-option>
                </ng-select>
                </div>
                
                <span class="mx-3 my-0 text-muted w-auto d-none d-xl-block">|</span>
                <button class="btn btn-success w-auto">Appliquer</button>

                </div>
            </form>
        </div>
    </div>

    <ng-template #noFilter>
    <div class="row"><div class="col-12">
        <div class="card card-body py-5 text-center fs-5 fw-bold">
            <svg class="mx-auto mb-3" xmlns="http://www.w3.org/2000/svg" width="280" height="234.533" viewBox="0 0 821.16801 687.80201" xmlns:xlink="http://www.w3.org/1999/xlink"><polygon points="755.994 674.556 743.734 674.555 737.902 627.268 755.996 627.268 755.994 674.556" fill="#9e616a"/><path d="M948.53667,792.539l-39.53076-.00146v-.5a15.3873,15.3873,0,0,1,15.38647-15.38623h.001l24.144.001Z" transform="translate(-189.41599 -106.099)" fill="#2f2e41"/><polygon points="708.994 674.556 696.734 674.555 690.902 627.268 708.996 627.268 708.994 674.556" fill="#9e616a"/><path d="M901.53667,792.539l-39.53076-.00146v-.5a15.3873,15.3873,0,0,1,15.38647-15.38623h.001l24.144.001Z" transform="translate(-189.41599 -106.099)" fill="#2f2e41"/><path id="ae5c11dc-7e77-468a-a39f-cc8da6ee1565-135" data-name="Path 1495" d="M368.748,790.71V410.9a8.82,8.82,0,0,1,8.82-8.82h39.36a8.82,8.82,0,0,1,8.82,8.82h0V791.7Z" transform="translate(-189.41599 -106.099)" fill="#2a3042"/><path id="bc696f83-47b6-45c9-967f-bb64f1f3bee5-136" data-name="Path 1496" d="M498.748,791.9v-302a8.82,8.82,0,0,1,8.82-8.82h39.36a8.82,8.82,0,0,1,8.82,8.82h0V791.25Z" transform="translate(-189.41599 -106.099)" fill="#2a3042"/><path d="M267.747,433.09884a2.9998,2.9998,0,0,1-2.23278-5.00244l131.60547-146.791L526.638,354.03488,656.92679,129.53732,789.65458,238.78244a3.00008,3.00008,0,1,1-3.813,4.63281L658.56937,138.66037,528.85819,362.16281,398.37614,288.8923,269.9816,432.10129A2.99144,2.99144,0,0,1,267.747,433.09884Z" transform="translate(-189.41599 -106.099)" fill="#2a3042"/><circle id="a1f8771a-4bf9-4603-9747-6ae739e4ad47" data-name="Ellipse 300" cx="77.832" cy="324" r="28" fill="#e8e8e8"/><circle id="ffdbdf53-78c2-412f-9ede-372406e5d245" data-name="Ellipse 301" cx="207.832" cy="179" r="28" fill="#ccc"/><circle id="b7cff929-f00d-4f86-944c-e500b6ceb6ad" data-name="Ellipse 302" cx="337.832" cy="252" r="28" fill="#e6e6e6"/><circle id="eabc0b76-6faa-4fa0-934c-daff28b491dd" data-name="Ellipse 303" cx="467.832" cy="28" r="28" fill="#e8e8e8"/><circle id="a7ca0488-8ee6-49e2-b245-2872b84c042e" data-name="Ellipse 304" cx="717.832" cy="236.535" r="28" fill="#e8e8e8"/><path id="b579ef19-595a-43de-9b6d-0ead8268ca48-137" data-name="Path 1507" d="M897.348,560.755c10.47981,1.26236,37.279-8.29806,38.73146,6.24641,13.7938,40.605,13.38448,196.25632,13.38448,196.25632l-21,1S911.683,640.58334,903.74813,614.12488c-3.98187,32.159-3.28421,155.13285-3.28421,155.13285l-19,1s-17.04317-104.7174-17.14045-135.45308c-2.07126-22.51351,3.00876-55.87593.83463-77.63979a83.21836,83.21836,0,0,0,32.19,3.59Z" transform="translate(-189.41599 -106.099)" fill="#2a3042"/><path id="b3465432-03e0-48eb-8016-b04aa244e72c-138" data-name="Path 1513" d="M758.748,790.554V352.8c0-5.614,3.949-10.166,8.82-10.166h39.36c4.871,0,8.82,4.551,8.82,10.166V791.7Z" transform="translate(-189.41599 -106.099)" fill="#2a3042"/><path id="ac7870c5-efcc-4c4b-b17f-07e0bff4d096-139" data-name="Path 1508" d="M861.698,442.955a130.65716,130.65716,0,0,0-15.31-24.17,38.322,38.322,0,0,1-3.4-4.64c-2.15-3.73-2.79-8.11-4.15-12.19-3.8-11.44-13.28-20.63-15.59-32.46-.84-4.3-7.93567,8.19791-6.07,13.53,3.33,9.65,3.76,19.87,8,29.19s9.22,18.26,12.88,27.79c2.08,5.41,3.74,11,6.79,16s7.81,9.19,13.56,9.94a33.44983,33.44983,0,0,1,1.63013-10.68C861.288,451.325,863.508,446.685,861.698,442.955Z" transform="translate(-189.41599 -106.099)" fill="#9e616a"/><path id="be4b35b3-6955-40b7-9549-45fdba6a2930-140" data-name="Path 1509" d="M924.608,449.435a55.25867,55.25867,0,0,1,3.25-20.78c.92-2.55,2-5.14,1.91-7.85-.13-2.52-1.33-4.83-2.42-7.11-3.76-7.85-6.4-16.17-9-24.47l-5-15.65c-1.63018-1.19543,7.89-1.61,9.92,1.2,6.64,9.22,11.67,19.81,16.93005,29.88a50.57714,50.57714,0,0,1,3.42,7.49,41.18565,41.18565,0,0,1,1.8,12.94c0,8.19-1.07995,16.35-2.19995,24.47-.71,5.09-1.64,10.63-5.49,14C933.72793,458.435,929.708,453.435,924.608,449.435Z" transform="translate(-189.41599 -106.099)" fill="#9e616a"/><circle id="a7d383a2-21d6-4551-be8a-8c82a5e576cb" data-name="Ellipse 307" cx="708.75198" cy="314.48401" r="20.75" fill="#9e616a"/><path id="fb091cb1-8ad4-4d57-b74d-c940c723d6bf-141" data-name="Path 1512" d="M881.29986,399.881a3.602,3.602,0,0,1,.75956-3.72335c.51814-.40831,1.20624-.56062,1.7617-.95027a7.602,7.602,0,0,0,1.89952-2.40314,10.31516,10.31516,0,0,1,12.909-3.27672c3.42909,1.79484,5.49957,5.38869,8.54935,7.80841,1.54823,1.25389,3.34408,2.18449,4.90161,3.43838a20.14613,20.14613,0,0,1,6.35451,10.27787,58.31035,58.31035,0,0,1,1.7617,12.12454,10.90476,10.90476,0,0,1-.142,3.68607,10.31659,10.31659,0,0,1-1.39586,2.84979c-3.13478,4.7493-7.26645,9.0623-12.4437,11.5131s-11.47477,2.84979-16.58055.285a2.84975,2.84975,0,0,1-1.27259-1.01658,3.65791,3.65791,0,0,1-.199-2.19382,15.01763,15.01763,0,0,0-1.65284-8.40634c-.95027-1.89951-2.37516-3.53373-3.13479-5.49956a19.15971,19.15971,0,0,1-.89328-6.81979C882.39205,411.59309,882.79831,405.63756,881.29986,399.881Z" transform="translate(-189.41599 -106.099)" fill="#2d293d"/><path id="ef6ae9ea-be37-4bc6-b1be-067860dc7e9d-142" data-name="Path 1514" d="M238.747,791.149V579.808c0-2.71,3.949-4.908,8.82-4.908h39.36c4.871,0,8.82,2.2,8.82,4.908V791.7Z" transform="translate(-189.41599 -106.099)" fill="#2a3042"/><path id="b4c810f7-8361-4f56-9780-d97c96bbbba4-143" data-name="Path 944" d="M1009.585,793.901H190.416a1,1,0,1,1,0-2h819.168a1,1,0,0,1,0,2Z" transform="translate(-189.41599 -106.099)" fill="#e6e6e6"/><path id="b32730d1-ac43-40b1-a176-73e18bf362e5-144" data-name="Path 1515" d="M628.747,790.405V293.635c0-6.371,3.949-11.536,8.82-11.536h39.36c4.871,0,8.82,5.165,8.82,11.536V791.7Z" transform="translate(-189.41599 -106.099)" fill="#e8e8e8"/><circle cx="627.18243" cy="265.36557" r="9" fill="#a0616a"/><circle cx="727.18243" cy="261.36557" r="9" fill="#a0616a"/><path d="M938.46807,478.875c.87817-.80359,8.0376-42.67377,7.99585-43.61731-.1106-5.15845-15.85-11.05-19-9-2.97187,1.93408-8.14667,24.12415-11.477,28.16529l-3.523-6.16529h-28l-1.69708,3.15174c-3.674-2.21338-6.97907-4.25409-8.15784-4.92933a5.30006,5.30006,0,0,0-1.311-.64495,20.31093,20.31093,0,0,1-8-3.76c-2.3-1.77-12.97412-20.30744-15.8341-19.81745-3.23.54-14.1247,9.96-14,19,1.37152-.02929,19.21374,35.64765,19.46411,36.97736,1.37,5.62,5.89392,87.57995,7.35394,91.4,6.726-.65,1.416-1.81,7.926,0,7.01,1.95,14.41-.16,21.64-.94a83.11362,83.11362,0,0,1,9.06-.4c11,.05,26.7.66,37.35,3.39.06006-6.98-6.06994-22.08-8.34-28.67a19.24793,19.24793,0,0,1,.03-5.94C930.23809,534.66508,936.09356,481.53978,938.46807,478.875Z" transform="translate(-189.41599 -106.099)" fill="#e6e6e6"/></svg>
            Veuillez sélectionner vos critères de filtre pour générer les statistiques.
        </div>
    </div></div>
    </ng-template>


    <!-- charts -->
    <div class="row" *ngIf="!team.invalid && submitted; else noFilter">
        <!-- Total des interruptions -  Total des Vistes -  Total des anomalies -->
        <div class="col-lg-6 col-xl-3 pb-4">
            <div class="card card-body pb-2 mb-0 h-100">
                <ng-container *ngIf="TotalActivity$ | async as data;else ActivityLoading">
                    <div class="border p-3 rounded-3 mb-2" *ngFor="let item of data | keyvalue">
                        <p class="fw-medium mb-3">{{item.key}}</p>
                        <strong class="h2">{{item.value}}</strong>
                    </div>
                </ng-container>
                <ng-template #ActivityLoading>
                    <ng-container *ngFor="let _ of [].constructor(3)">
                        <div class="border p-3 rounded-3 mb-2">
                            <svg aria-labelledby="loading-8-aria" role="img" viewBox="0 0 340 84" width="320" height="50" class="mt-3"><title id="loading-8-aria">Loading...</title><rect role="presentation" x="0" y="0" width="100%" height="100%" clip-path="url(#loading-8-diff)" style="fill:url(#loading-8-animated-diff)"></rect><defs><clipPath id="loading-8-diff"><rect x="9" y="4" rx="0" ry="0" width="320" height="22"></rect><rect x="18" y="14" rx="0" ry="0" width="303" height="6"></rect><rect x="11" y="33" rx="0" ry="0" width="108" height="13"></rect></clipPath><linearGradient id="loading-8-animated-diff"><stop offset="0%" stop-color="#f6f6ef" stop-opacity="1"><animate attributeName="offset" values="-2; -2; 1" keyTimes="0; 0.25; 1" dur="1s" repeatCount="indefinite"></animate></stop><stop offset="50%" stop-color="#e8e8e3" stop-opacity="1"><animate attributeName="offset" values="-1; -1; 2" keyTimes="0; 0.25; 1" dur="1s" repeatCount="indefinite"></animate></stop><stop offset="100%" stop-color="#f6f6ef" stop-opacity="1" style=""><animate attributeName="offset" values="0; 0; 3" keyTimes="0; 0.25; 1" dur="1s" repeatCount="indefinite"></animate></stop></linearGradient></defs></svg>
                        </div>
                    </ng-container>
                </ng-template>
            </div>
        </div>

        <!-- Le nombre des fois un post copée + nb des hours -->
        <div class="col-lg-6 col-xl-3 pb-4">
            <div class="card card-body pb-2 mb-0 h-100">
                <div class="fw-bold mb-2">
                    Nombre de fois un poste est copié avec la durée
                </div>

                <ng-template #RelatedPostesLoading>
                    <svg aria-labelledby="loading-8-aria" role="img" viewBox="0 0 340 84" width="190" height="50"><title id="loading-8-aria">Loading...</title><rect role="presentation" x="0" y="0" width="100%" height="100%" clip-path="url(#loading-8-diff)" style="fill:url(#loading-8-animated-diff)"></rect><defs><clipPath id="loading-8-diff"><rect x="9" y="4" rx="0" ry="0" width="320" height="22"></rect><rect x="18" y="14" rx="0" ry="0" width="303" height="6"></rect><rect x="11" y="33" rx="0" ry="0" width="108" height="13"></rect></clipPath><linearGradient id="loading-8-animated-diff"><stop offset="0%" stop-color="#f6f6ef" stop-opacity="1"><animate attributeName="offset" values="-2; -2; 1" keyTimes="0; 0.25; 1" dur="1s" repeatCount="indefinite"></animate></stop><stop offset="50%" stop-color="#e8e8e3" stop-opacity="1"><animate attributeName="offset" values="-1; -1; 2" keyTimes="0; 0.25; 1" dur="1s" repeatCount="indefinite"></animate></stop><stop offset="100%" stop-color="#f6f6ef" stop-opacity="1" style=""><animate attributeName="offset" values="0; 0; 3" keyTimes="0; 0.25; 1" dur="1s" repeatCount="indefinite"></animate></stop></linearGradient></defs></svg>
                </ng-template>

                <ng-container *ngIf="RelatedPostes$ | async as data;else RelatedPostesLoading">
                    <div class="small text-muted mb-3">Veuillez sélectionner un poste pour voir ses statistiques</div>
                    <label>Designation</label>
                    <ng-select 
                        [(ngModel)]="selectedPoste"
                        placeholder="Designation..">
                        <ng-option *ngFor="let item of data" [value]="item.id">{{item.designation}}</ng-option>
                    </ng-select>
                    <button class="btn btn-primary d-block ms-auto mt-3" (click)="postesStats()">Soumettre</button>
                </ng-container>

                <ng-container *ngIf="PostInterruptionInfo$ | async as data;else PostInterruptionInfoLoading">
                    <div class="row pt-3">
                        <div class="col-6">
                            <div class="border p-3 rounded-3 h-100">
                                <p class="fw-medium mb-3">La durée de coupure</p>
                                <strong class="h2">{{data.Duration ? data.Duration : 0}}</strong>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="border p-3 rounded-3 h-100">
                                <p class="fw-medium mb-3">Nombre de fois</p>
                                <strong class="h2">{{data.TIMES ? data.TIMES : 0}}</strong>
                            </div>
                        </div>
                    </div>
                </ng-container>
                <ng-template #PostInterruptionInfoLoading>
                    <p *ngIf="postesStatsSubmitted">Chargement...</p>
                </ng-template>

            </div>
        </div>

        <!-- Causes And Types -->
        <ng-container *ngIf="CausesAndType$ | async as data;else CausesAndTypeLoading">
            <!-- Causes des interruptions -->
            <div class="col-lg-6 col-xl-4 pb-4">
                <div class="card card-body pb-2 mb-0 h-100">
                    <div class="fw-bold mb-4">
                        Causes des interruptions
                    </div>
                    <ng-container *ngIf="data['causes'] as causes; else noCauses">
                        <apx-chart
                            [series]="causes.series"
                            [chart]="causes.chart"
                            [labels]="causes.labels"
                            [responsive]="causes.responsive"
                        ></apx-chart>
                    </ng-container>
                    <ng-template #noCauses>
                        <p class="alert alert-info">Aucune cause connue d'interruptions sur cette période donnée</p>
                    </ng-template>
                </div>
            </div>
            <!-- Interruptions par type -->
            <div class="col-lg-6 col-xl-2 pb-4">
                <div class="card card-body pb-2 mb-0 h-100">
                    <div class="fw-bold mb-4">
                        Interruptions par type
                    </div>
                    <div *ngIf="data['types'] as types">
                    <apx-chart
                        [series]="types.series"
                        [chart]="types.chart"
                        [dataLabels]="types.dataLabels"
                        [plotOptions]="types.plotOptions"
                        [yaxis]="types.yaxis"
                        [xaxis]="types.xaxis"
                        [legend]="types.legend"
                        [colors]="types.colors"
                        [grid]="types.grid"
                    ></apx-chart>
                    </div>
                </div>
            </div>
        </ng-container>

        <ng-template #CausesAndTypeLoading>
            <!-- Causes des interruptions -->
            <div class="col-lg-6 col-xl-4">
                <div class="card card-body">
                    <div class="fw-bold mb-4">
                        Causes des interruptions
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin: auto; opacity: 0.2; display: block;" width="200px" height="310px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
                        <g transform="rotate(180 50 50)"><rect x="15" y="15" width="10" height="40" fill="#e8e8e8">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-2.1052631578947367s"></animate>
                        </rect><rect x="35" y="15" width="10" height="40" fill="#dce4eb">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-1.0526315789473684s"></animate>
                        </rect><rect x="55" y="15" width="10" height="40" fill="#bbcedd">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-3.1578947368421053s"></animate>
                        </rect><rect x="75" y="15" width="10" height="40" fill="#85a2b6">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-5.2631578947368425s"></animate>
                        </rect></g>
                    </svg>
                </div>
            </div>
             <!-- Interruptions par type -->
            <div class="col-lg-6 col-xl-2">
                <div class="card card-body">
                    <div class="fw-bold mb-4">
                        Interruptions par type
                    </div>

                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin: auto; opacity: 0.2; display: block;" width="200px" height="310px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
                    <g transform="rotate(180 50 50)"><rect x="15" y="15" width="10" height="40" fill="#e8e8e8">
                    <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-2.1052631578947367s"></animate>
                    </rect><rect x="35" y="15" width="10" height="40" fill="#dce4eb">
                    <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-1.0526315789473684s"></animate>
                    </rect><rect x="55" y="15" width="10" height="40" fill="#bbcedd">
                    <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-3.1578947368421053s"></animate>
                    </rect><rect x="75" y="15" width="10" height="40" fill="#85a2b6">
                    <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-5.2631578947368425s"></animate>
                    </rect></g>
                    </svg>
                </div>
            </div>
        </ng-template>

        <!-- DMS - IFS - END -->
        <ng-container *ngIf="InterruptionsPerformance$ | async as data;else InterruptionsPerformanceLoading">
            <div class="col-12" *ngFor="let chart of data;">
                <div class="card card-body">
                    <div class="fw-bold mb-4">
                        <div *ngIf="chart.type == 'DMS_TOTAL'">
                          DMS <small class="text-muted font-size-12">(Durée moyenne des interruptions de l'année en cours)</small>
                          <br>Total : {{ chart.total | decimalHourToTime }}
                        </div>
                        <div *ngIf="chart.type == 'IFS_TOTAL'">
                          IFS <small class="text-muted font-size-12">(Fréquence des interruptions de l'année en cours)</small>
                          <br>Total : {{ chart.total }}
                        </div>
                        <div *ngIf="chart.type == 'END_TOTAL'">
                          END <small class="text-muted font-size-12">(année en cours)</small>
                          <br>Total : {{ chart.total | decimalHourToTime }}
                        </div>
                    </div>
                    <apx-chart
                    [series]="chart.series"
                    [chart]="chart.chart"
                    [xaxis]="chart.xaxis"
                    [yaxis]="chart.yaxis"
                    [stroke]="chart.stroke"
                    [tooltip]="chart.tooltip"
                    [dataLabels]="chart.dataLabels"
                    [colors]="chart.colors"
                    ></apx-chart>
              </div>
            </div>
        </ng-container>
        <ng-template #InterruptionsPerformanceLoading>
            <!-- DMS  -->
            <div class="col-12">
                <div class="card card-body">
                    <div class="fw-bold mb-4">
                    DMS <small class="text-muted font-size-12">(Durée moyenne des interruptions par départ)</small>
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin: auto; opacity: 0.2; display: block;" width="200px" height="310px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
                        <g transform="rotate(180 50 50)"><rect x="15" y="15" width="10" height="40" fill="#e8e8e8">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-2.1052631578947367s"></animate>
                        </rect><rect x="35" y="15" width="10" height="40" fill="#dce4eb">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-1.0526315789473684s"></animate>
                        </rect><rect x="55" y="15" width="10" height="40" fill="#bbcedd">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-3.1578947368421053s"></animate>
                        </rect><rect x="75" y="15" width="10" height="40" fill="#85a2b6">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-5.2631578947368425s"></animate>
                        </rect></g>
                    </svg>
                </div>
            </div>
            <!-- END -->
            <div class="col-12">
                <div class="card card-body">
                    <div class="fw-bold mb-4">
                    END <small class="text-muted font-size-12">(L’énergie non distribuée par départ)</small>
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin: auto; opacity: 0.2; display: block;" width="200px" height="310px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
                        <g transform="rotate(180 50 50)"><rect x="15" y="15" width="10" height="40" fill="#e8e8e8">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-2.1052631578947367s"></animate>
                        </rect><rect x="35" y="15" width="10" height="40" fill="#dce4eb">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-1.0526315789473684s"></animate>
                        </rect><rect x="55" y="15" width="10" height="40" fill="#bbcedd">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-3.1578947368421053s"></animate>
                        </rect><rect x="75" y="15" width="10" height="40" fill="#85a2b6">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-5.2631578947368425s"></animate>
                        </rect></g>
                    </svg>
                </div>
            </div>
            <!-- IFS -->
            <div class="col-12">
            <div class="card card-body">
                <div class="fw-bold mb-4">
                IFS <small class="text-muted font-size-12">(Fréquence des interruptions par départ)</small>
                </div>
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin: auto; opacity: 0.2; display: block;" width="200px" height="310px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
                    <g transform="rotate(180 50 50)"><rect x="15" y="15" width="10" height="40" fill="#e8e8e8">
                    <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-2.1052631578947367s"></animate>
                    </rect><rect x="35" y="15" width="10" height="40" fill="#dce4eb">
                    <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-1.0526315789473684s"></animate>
                    </rect><rect x="55" y="15" width="10" height="40" fill="#bbcedd">
                    <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-3.1578947368421053s"></animate>
                    </rect><rect x="75" y="15" width="10" height="40" fill="#85a2b6">
                    <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-5.2631578947368425s"></animate>
                    </rect></g>
                </svg>
            </div>
            </div>
        </ng-template>

        <!-- Taux de correction des anomalies -->
        <div class="col-12">
            <div class="card card-body">
              <div class="fw-bold mb-4">Taux de correction des anomalies</div>
                <ng-container *ngIf="AnomalyCorrection$ | async as data; else AnomalyCorrectionLoading">
                    <apx-chart
                      [series]="data.series"
                      [chart]="data.chart"
                      [dataLabels]="data.dataLabels"
                      [plotOptions]="data.plotOptions"
                      [responsive]="data.responsive"
                      [xaxis]="data.xaxis"
                      [legend]="data.legend"
                      [fill]="data.fill"
                  ></apx-chart>
                </ng-container>
                <ng-template #AnomalyCorrectionLoading>
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin: auto; opacity: 0.2; display: block;" width="200px" height="310px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
                        <g transform="rotate(180 50 50)"><rect x="15" y="15" width="10" height="40" fill="#e8e8e8">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-2.1052631578947367s"></animate>
                        </rect><rect x="35" y="15" width="10" height="40" fill="#dce4eb">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-1.0526315789473684s"></animate>
                        </rect><rect x="55" y="15" width="10" height="40" fill="#bbcedd">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-3.1578947368421053s"></animate>
                        </rect><rect x="75" y="15" width="10" height="40" fill="#85a2b6">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-5.2631578947368425s"></animate>
                        </rect></g>
                    </svg>
                </ng-template>
            </div>
          </div>

        <!-- Nombre de kilomètres visités par commune -->
        <div class="col-12">
            <div class="card card-body">
                <div class="fw-bold mb-4">
                    Nombre de kilomètres visités par commune
                </div>
                <ng-template #KMVisitedPerCommuneLoading>
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin: auto; opacity: 0.2; display: block;" width="200px" height="310px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
                        <g transform="rotate(180 50 50)"><rect x="15" y="15" width="10" height="40" fill="#e8e8e8">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-2.1052631578947367s"></animate>
                        </rect><rect x="35" y="15" width="10" height="40" fill="#dce4eb">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-1.0526315789473684s"></animate>
                        </rect><rect x="55" y="15" width="10" height="40" fill="#bbcedd">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-3.1578947368421053s"></animate>
                        </rect><rect x="75" y="15" width="10" height="40" fill="#85a2b6">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-5.2631578947368425s"></animate>
                        </rect></g>
                    </svg>
                </ng-template>

                <ng-container *ngIf="KMVisitedPerCommune$ | async as data; else KMVisitedPerCommuneLoading">
                    <apx-chart
                        [series]="data.series"
                        [chart]="data.chart"
                        [dataLabels]="data.dataLabels"
                        [plotOptions]="data.plotOptions"
                        [yaxis]="data.yaxis"
                        [xaxis]="data.xaxis"
                        [legend]="data.legend"
                        [grid]="data.grid"
                    ></apx-chart>
                </ng-container>
                
            </div>
        </div>

        <!-- Le nombre de clients coupés par commune -->
        <div class="col-12">
            <div class="card card-body">
                <div class="fw-bold mb-4">
                    Le nombre de clients coupés par commune
                </div>
                <ng-template #ClientCutsByCommuneLoading>
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin: auto; opacity: 0.2; display: block;" width="200px" height="310px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
                        <g transform="rotate(180 50 50)"><rect x="15" y="15" width="10" height="40" fill="#e8e8e8">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-2.1052631578947367s"></animate>
                        </rect><rect x="35" y="15" width="10" height="40" fill="#dce4eb">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-1.0526315789473684s"></animate>
                        </rect><rect x="55" y="15" width="10" height="40" fill="#bbcedd">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-3.1578947368421053s"></animate>
                        </rect><rect x="75" y="15" width="10" height="40" fill="#85a2b6">
                        <animate attributeName="height" values="50;70;30;50" keyTimes="0;0.33;0.66;1" dur="5.2631578947368425s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1" begin="-5.2631578947368425s"></animate>
                        </rect></g>
                    </svg>
                </ng-template>

                <ng-container *ngIf="ClientCutsByCommune$ | async as data; else ClientCutsByCommuneLoading">
                    <apx-chart
                        [series]="data.series"
                        [chart]="data.chart"
                        [dataLabels]="data.dataLabels"
                        [plotOptions]="data.plotOptions"
                        [yaxis]="data.yaxis"
                        [xaxis]="data.xaxis"
                        [legend]="data.legend"
                        [grid]="data.grid"
                    ></apx-chart>
                </ng-container>
            </div>
        </div>
    </div>
</div> <!-- container-fluid -->
