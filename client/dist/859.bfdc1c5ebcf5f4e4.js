"use strict";(self.webpackChunkskote=self.webpackChunkskote||[]).push([[859],{9859:(gt,k,o)=>{o.r(k),o.d(k,{visiteModule:()=>vt});var h=o(7317),x=o(9167),e=o(3668),G=o(4762),D=o(1824),E=o(3405),b=o(3596),u=o(2411),y=o(5686),C=o(5389),I=o(8735),f=o(1366),L=o(9204),T=o(8053),N=o(2047),A=o(8260),J=o(5633),W=o(6761),K=o(4038),Y=o(7777),H=o(2360),X=o(8274),F=o(4522);const P=(n,a=2)=>String(n).padStart(a,"0"),Z=(n,a)=>new Date(n.year,n.month-1,n.day,a.hour,a.minute,a.second).toISOString(),q=n=>""!==n?`${n.year}-${P(n.month)}-${P(n.day)}`:"";let $=(()=>{class n extends D.c8{constructor(t,i,r,s,l,d,v,g,_){super("visites",t),this.serviceElementsFactory=t,this.confirmDialogService=i,this.departmentService=r,this.anomalyService=s,this.communeService=l,this.nodeService=d,this.toast=v,this.http=g,this.router=_,this.pageSize=A.N.pageSize,this.server=A.N.serverURL,this.existingVisit=!1,this.EditeMode=!1,this.ANodeLoading=!1,this.ANodeInput$=new E.xQ,this.BNodeLoading=!1,this.BNodeInput$=new E.xQ,this.departmentLoading=!1,this.departmentInput$=new E.xQ,this.teamLoading=!1,this.teamInput$=new E.xQ,this.submitted=!1,this.page=1,this.anomalyLoading=!1}findAll(){this.findByCriteria({page:1})}loadTeams(t=[]){this.teams$=(0,b.z)((0,u.of)(t),this.teamInput$.pipe((0,y.b)(500),(0,C.x)(),(0,I.h)(i=>null!=i),(0,f.b)(()=>this.teamLoading=!0),(0,L.w)(i=>this.http.get(`${this.server}/api/teams?properties[]=id&properties[]=titre&titre=`+i).pipe((0,T.U)(r=>r["hydra:member"]),(0,N.K)(()=>(0,u.of)([])),(0,f.b)(()=>this.teamLoading=!1)))))}loadDepartments(t=!0){this.departments$=t?(0,b.z)((0,u.of)([]),this.departmentInput$.pipe((0,y.b)(500),(0,C.x)(),(0,I.h)(i=>null!=i),(0,f.b)(()=>this.departmentLoading=!0),(0,L.w)(i=>this.departmentService.getWithQuery("properties[]=id&properties[]=titre&titre="+i).pipe((0,N.K)(()=>(0,u.of)([])),(0,f.b)(()=>this.departmentLoading=!1))))):this.departmentService.getWithQuery("properties[]=id&properties[]=titre")}loadANodes(t=[]){this.ANode$=(0,b.z)((0,u.of)(t),this.ANodeInput$.pipe((0,y.b)(500),(0,C.x)(),(0,I.h)(i=>null!=i),(0,f.b)(()=>this.ANodeLoading=!0),(0,L.w)(i=>this.nodeService.getWithQuery("properties[]=id&properties[]=titre&titre="+i+(this.department?"&department.id="+this.department.value.match(/\d+/)[0]:"")+(this.departments?"&properties[department][]=titre&"+this.departments.map(r=>`department.id[]=${r}`).join("&"):"")).pipe((0,N.K)(()=>(0,u.of)([])),(0,f.b)(()=>this.ANodeLoading=!1)))))}loadBNodes(t=[]){this.BNode$=(0,b.z)((0,u.of)(t),this.BNodeInput$.pipe((0,y.b)(500),(0,C.x)(),(0,I.h)(i=>null!=i),(0,f.b)(()=>this.BNodeLoading=!0),(0,L.w)(i=>this.nodeService.getWithQuery("properties[]=id&properties[]=titre&titre="+i+(this.department?"&department.id="+this.department.value.match(/\d+/)[0]:"")+(this.departments?"&properties[department][]=titre&"+this.departments.map(r=>`department.id[]=${r}`).join("&"):"")).pipe((0,N.K)(()=>(0,u.of)([])),(0,f.b)(()=>this.BNodeLoading=!1)))))}getPagination(){this.pagination$=(0,u.of)(),this.pagination$=this.selectors$.entityActions$.pipe((0,T.U)(t=>t.payload.pagination))}deleteItem(t=null,i=null){this.confirmDialogService.setConfirmation("Vous \xeates s\xfbr de vouloir supprimer?",()=>{this.delete(t||this.existingVisit.id).pipe(this.toast.observe({loading:"Suppression...",success:()=>(i?i.closest("tr").remove():this.router.navigate(["/visites"]),"supprim\xe9 avec succ\xe8s"),error:"un probl\xe8me est survenu, veuillez r\xe9essayer"})).subscribe()})}onSearch(){this.page=1,this.lastSearchedParams=this.visiteForm.value,this.findByCriteria(Object.assign({page:1},this.lastSearchedParams))}Persist(t){return(0,G.mG)(this,void 0,void 0,function*(){if(this.submitted=!0,this.visiteForm.invalid)return;this.submitted=!1;let i=null;this.EditeMode?i=this.existingVisit?this.existingVisit.id:null:this.EditeMode="EDIT"==t;let r=this.visiteForm.value,s=this,l=this.toast,d={date:r.date?Z(r.date,r.time):null,team:r.team?r.team:null,nbSupport:r.nbSupport?r.nbSupport:0,department:r.department?r.department:null,nodeA:r.nodeA?r.nodeA:null,nodeB:r.nodeB&&r.nodeB.length?r.nodeB:[]},v=r.anomalies;v&&v.length&&(this.anomalyLoading=!0,yield this.anomalyService.bulkCreate(v.map(_=>Object.assign(Object.assign({},_),{createdAt:d.date}))).toPromise(),this.anomalyLoading=!1),i?(d.id=i,this.update(d).subscribe({error:()=>l.error("un probl\xe8me est survenu, veuillez r\xe9essayer"),complete(){l.success("L'interuption a \xe9t\xe9 sauvegard\xe9e avec succ\xe8s "),"LIST"==t&&s.router.navigate(["/visites"]),s.submitted=!1}})):this.add(d).pipe((0,f.b)(_=>this.existingVisit=_)).subscribe({error:()=>l.error("un probl\xe8me est survenu, veuillez r\xe9essayer"),complete(){l.success("L'interuption ajout\xe9e avec succ\xe8s"),"NEW"==t&&location.reload(),"LIST"==t&&s.router.navigate(["/visites"]),s.submitted=!1}});let g=this.visiteForm.get("anomalies");for(;0!==g.length;)g.removeAt(0);this.anomalyService.getRelatedAnomalies(r.nodeA,r.nodeB,r.department)})}findByCriteria(t){if(this.visites$=(0,u.of)([]),Object.keys(t).length>1){const r=s=>t[s]&&delete Object.assign(t,{["date["+s+"]"]:q(t[s])})[s];r("before"),r("after")}let i=Object.keys(t).filter(r=>""!=t[r]&&null!=t[r]).reduce((r,s)=>Object.assign(Object.assign({},r),{[s]:t[s]}),{});this.visites$=this.getWithQuery(i),this.getPagination()}onPaginate(t){this.findByCriteria(Object.assign({page:t},this.lastSearchedParams))}get departments(){let t=this.visiteForm.controls["node_a.department.id[]"];return t?t.value:null}get designation(){return this.visiteForm.get("designation")}get department(){return this.visiteForm.get("department")}get BNode(){return this.visiteForm.get("nodeB")}get ANode(){return this.visiteForm.get("nodeA")}get date(){return this.visiteForm.get("date")}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275inject(D.yV),e.\u0275\u0275inject(J.D),e.\u0275\u0275inject(W.l),e.\u0275\u0275inject(K.M),e.\u0275\u0275inject(Y.s),e.\u0275\u0275inject(H.B),e.\u0275\u0275inject(X.jE),e.\u0275\u0275inject(F.eN),e.\u0275\u0275inject(h.F0))},n.\u0275prov=e.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var w=o(7686),B=o(1950),p=o(6019),V=o(2008);const ee=function(n){return["/departments/details",n]};function te(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"a",15),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("routerLink",t.authService.isAuthorized("departments_details")?e.\u0275\u0275pureFunction1(2,ee,t.visite.node_a.department.id):null),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.visite.node_a.department.titre)}}const z=function(n){return["/nodes/details",n]};function ne(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"a",15),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("routerLink",t.authService.isAuthorized("nodes_details")?e.\u0275\u0275pureFunction1(2,z,t.visite.node_a.id):null),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.visite.node_a.titre)}}function ie(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275elementStart(1,"a",15),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()),2&n){const t=a.$implicit,i=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("routerLink",i.authService.isAuthorized("nodes_details")?e.\u0275\u0275pureFunction1(2,z,t.id):null),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("- ",t.titre,"")}}const ae=function(n){return["/teams/details",n]};function re(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"a",15),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("routerLink",t.authService.isAuthorized("teams_details")?e.\u0275\u0275pureFunction1(2,ae,t.visite.node_a.department.team.id):null),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.visite.node_a.department.team.titre)}}function se(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"table",10),e.\u0275\u0275elementStart(1,"tbody"),e.\u0275\u0275elementStart(2,"tr"),e.\u0275\u0275elementStart(3,"th",11),e.\u0275\u0275text(4,"Date :"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"td"),e.\u0275\u0275text(6),e.\u0275\u0275pipe(7,"date"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"tr"),e.\u0275\u0275elementStart(9,"th",11),e.\u0275\u0275text(10,"D\xe9part :"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"td"),e.\u0275\u0275template(12,te,2,4,"a",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"tr"),e.\u0275\u0275elementStart(14,"th",11),e.\u0275\u0275text(15,"De :"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"td"),e.\u0275\u0275template(17,ne,2,4,"a",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"tr"),e.\u0275\u0275elementStart(19,"th",11),e.\u0275\u0275text(20,"\xc0 :"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"td"),e.\u0275\u0275template(22,ie,3,4,"div",13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"tr"),e.\u0275\u0275elementStart(24,"th",11),e.\u0275\u0275text(25,"Longueur visit\xe9e :"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"td"),e.\u0275\u0275elementStart(27,"b"),e.\u0275\u0275text(28),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(29," Support\xa0"),e.\u0275\u0275elementStart(30,"small",14),e.\u0275\u0275text(31),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(32,"tr"),e.\u0275\u0275elementStart(33,"th",11),e.\u0275\u0275text(34,"\xc9quipe :"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(35,"td"),e.\u0275\u0275template(36,re,2,4,"a",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind3(7,7,t.visite.date,"medium","Africa/Casablanca")),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.visite.node_a.department),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.visite.node_a),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngForOf",t.visite.node_b),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate(t.visite.nbSupport),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1("(",t.visite.edge_set_length/1e3,"km)"),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.visite.node_a.department.team)}}let oe=(()=>{class n{constructor(t,i,r){this.route=t,this.service=i,this.authService=r;let s=t.snapshot.paramMap.get("id");i.getByKey(s).subscribe(l=>{this.visite=l,this.currentEdge={ANode:l.node_a["@id"],BNode:l.node_b.map(d=>d["@id"]),department:l.node_a.department["@id"],type:"false",date:l.date}})}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(h.gz),e.\u0275\u0275directiveInject($),e.\u0275\u0275directiveInject(w.$))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["app-visite-details"]],decls:12,vars:6,consts:[[1,"container-fluid"],["title","D\xe9tail de l'interruption",3,"Loading","breadcrumbItems"],[1,"row"],[1,"card","mt-4"],[1,"card-body","pt-5"],[1,"table-responsive"],["class","table table-nowrap mb-0",4,"ngIf"],["routerLink","/visite",1,"btn","btn-light","mt-4","float-end"],[1,"fas","fa-arrow-circle-left","me-1"],[3,"currentEdge"],[1,"table","table-nowrap","mb-0"],["scope","row"],["target","_blank",3,"routerLink",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"text-muted"],["target","_blank",3,"routerLink"]],template:function(t,i){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275element(1,"app-page-title",1),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementStart(3,"div",2),e.\u0275\u0275elementStart(4,"div",3),e.\u0275\u0275elementStart(5,"div",4),e.\u0275\u0275elementStart(6,"div",5),e.\u0275\u0275template(7,se,37,11,"table",6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"button",7),e.\u0275\u0275element(9,"i",8),e.\u0275\u0275text(10,"Retour \xe0 la liste"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(11,"app-related-anomalies",9),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("Loading",e.\u0275\u0275pipeBind1(2,4,i.service.loading$))("breadcrumbItems",i.breadCrumbItems),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",i.visite),e.\u0275\u0275advance(4),e.\u0275\u0275property("currentEdge",i.currentEdge))},directives:[B.V,p.NgIf,h.rH,V.T,p.NgForOf,h.yS],pipes:[p.AsyncPipe,p.DatePipe],encapsulation:2}),n})();var le=o(2036),m=o(9133),S=o(9785),c=o(6015),de=o(4287),M=o(5396),me=o(6865);function pe(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"div",59),e.\u0275\u0275elementStart(1,"small",60),e.\u0275\u0275text(2,"Ann\xe9e courante"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"strong",61),e.\u0275\u0275text(4),e.\u0275\u0275elementStart(5,"small",62),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()),2&n){const t=a.ngIf;e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1("",t.visitedLgthYear," "),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("/",t.annualVisitLgth," km")}}function ce(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"div",63),e.\u0275\u0275elementStart(1,"small",60),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"lowercase"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"strong",61),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()),2&n){const t=a.ngIf,i=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("Le mois ",e.\u0275\u0275pipeBind1(3,2,i.selectedMonth),"."),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1("",t.visitedLgthMonth," km")}}function ue(n,a){1&n&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"small"),e.\u0275\u0275text(2,"Identique \xe0 la p\xe9riode pr\xe9c\xe9dente"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd())}function ve(n,a){if(1&n&&(e.\u0275\u0275text(0),e.\u0275\u0275elementStart(1,"small"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext().ngIf,i=e.\u0275\u0275nextContext(2);e.\u0275\u0275textInterpolate1(" ",i.Math.abs(t.difference)," "),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" de ",t.difference>=0?"plus":"moins"," que la p\xe9riode pr\xe9c\xe9dente")}}const ge=function(n,a,t){return{"badge-soft-danger":n,"badge-soft-info":a,"badge-soft-success":t}};function fe(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"div",64),e.\u0275\u0275elementStart(1,"div",48),e.\u0275\u0275elementStart(2,"p",65),e.\u0275\u0275text(3,"Nombre d'anomalies "),e.\u0275\u0275elementStart(4,"small",62),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"lowercase"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"p",66),e.\u0275\u0275elementStart(8,"span",67),e.\u0275\u0275template(9,ue,3,0,"ng-container",57),e.\u0275\u0275template(10,ve,3,2,"ng-template",null,68,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"strong",69),e.\u0275\u0275text(13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()),2&n){const t=a.ngIf,i=e.\u0275\u0275reference(11),r=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1("(",e.\u0275\u0275pipeBind1(6,5,r.selectedMonth),".)"),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction3(7,ge,t.difference>0,0==t.difference,t.difference<0)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",0==t.difference)("ngIfElse",i),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(t.anomaliesCurrent)}}function he(n,a){if(1&n&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"p",73),e.\u0275\u0275text(2),e.\u0275\u0275elementStart(3,"span",45),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",74),e.\u0275\u0275element(6,"div",75),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&n){const t=a.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate2("title","",t.covered,"/",t.target," km"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.name),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",t.progress,"%"),e.\u0275\u0275advance(2),e.\u0275\u0275styleProp("width",t.progress+"%"),e.\u0275\u0275attribute("aria-valuenow",t.progress)}}function _e(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"div",70),e.\u0275\u0275elementStart(1,"p",71),e.\u0275\u0275text(2,"Parcours annuel de l'\xe9quipe "),e.\u0275\u0275elementStart(3,"small",62),e.\u0275\u0275text(4,"(double visites)"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,he,7,7,"ng-container",72),e.\u0275\u0275elementEnd()),2&n){const t=a.ngIf;e.\u0275\u0275advance(5),e.\u0275\u0275property("ngForOf",t)}}function Se(n,a){if(1&n&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275element(1,"apx-chart",78),e.\u0275\u0275elementContainerEnd()),2&n){const t=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("series",t.series)("chart",t.chart)("dataLabels",t.dataLabels)("plotOptions",t.plotOptions)("yaxis",t.yaxis)("xaxis",t.xaxis)("legend",t.legend)("grid",t.grid)}}function xe(n,a){1&n&&(e.\u0275\u0275elementStart(0,"p",79),e.\u0275\u0275text(1,"Pas de donn\xe9es trouv\xe9es !"),e.\u0275\u0275elementEnd())}function Ee(n,a){if(1&n&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"p",76),e.\u0275\u0275text(2,"Nombre de visites par commune "),e.\u0275\u0275elementStart(3,"small",62),e.\u0275\u0275text(4,"(ann\xe9e courante)"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,Se,2,8,"ng-container",57),e.\u0275\u0275template(6,xe,2,0,"ng-template",null,77,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementContainerEnd()),2&n){const t=a.ngIf,i=e.\u0275\u0275reference(7);e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",!t.empty)("ngIfElse",i)}}function be(n,a){1&n&&(e.\u0275\u0275namespaceSVG(),e.\u0275\u0275elementStart(0,"svg",80),e.\u0275\u0275elementStart(1,"g",81),e.\u0275\u0275elementStart(2,"rect",82),e.\u0275\u0275element(3,"animate",83),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"rect",84),e.\u0275\u0275element(5,"animate",85),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"rect",86),e.\u0275\u0275element(7,"animate",87),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"rect",88),e.\u0275\u0275element(9,"animate",89),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd())}function ye(n,a){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",6),e.\u0275\u0275elementStart(1,"div",42),e.\u0275\u0275elementStart(2,"div",43),e.\u0275\u0275elementStart(3,"div",44),e.\u0275\u0275elementStart(4,"div",45),e.\u0275\u0275elementStart(5,"months-selector",46),e.\u0275\u0275listener("selectionChange",function(r){return e.\u0275\u0275restoreView(t),e.\u0275\u0275nextContext().statsPerMonth(r)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"div",6),e.\u0275\u0275elementStart(7,"div",47),e.\u0275\u0275elementStart(8,"div",48),e.\u0275\u0275elementStart(9,"p",49),e.\u0275\u0275text(10,"Distance parcourue"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"div",6),e.\u0275\u0275template(12,pe,7,2,"div",50),e.\u0275\u0275pipe(13,"async"),e.\u0275\u0275template(14,ce,6,4,"div",51),e.\u0275\u0275pipe(15,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(16,fe,14,11,"div",52),e.\u0275\u0275pipe(17,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"div",53),e.\u0275\u0275template(19,_e,6,1,"div",54),e.\u0275\u0275pipe(20,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"div",55),e.\u0275\u0275elementStart(22,"div",56),e.\u0275\u0275template(23,Ee,8,2,"ng-container",57),e.\u0275\u0275pipe(24,"async"),e.\u0275\u0275template(25,be,10,0,"ng-template",null,58,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()}if(2&n){const t=e.\u0275\u0275reference(26),i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(12),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(13,6,i.totalCoveredDistance$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(15,8,i.statsPerMonth$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(17,10,i.statsPerMonth$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(20,12,i.teamCoveredDistance$)),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(24,14,i.visitsParCommunes$))("ngIfElse",t)}}function Ce(n,a){1&n&&(e.\u0275\u0275elementStart(0,"a",90),e.\u0275\u0275element(1,"i",91),e.\u0275\u0275text(2," Ajouter"),e.\u0275\u0275elementEnd())}function Ie(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext().item;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" - ",t.department.titre,"")}}function Le(n,a){if(1&n&&(e.\u0275\u0275text(0),e.\u0275\u0275template(1,Ie,2,1,"span",41)),2&n){const t=a.item,i=e.\u0275\u0275nextContext();e.\u0275\u0275textInterpolate1(" ",t.titre,""),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.service.departments&&i.service.departments.length>1)}}function Te(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext().item;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" - ",t.department.titre,"")}}function Ne(n,a){if(1&n&&(e.\u0275\u0275text(0),e.\u0275\u0275template(1,Te,2,1,"span",41)),2&n){const t=a.item,i=e.\u0275\u0275nextContext();e.\u0275\u0275textInterpolate1(" ",t.titre,""),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.service.departments&&i.service.departments.length>1)}}function Ae(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext().item;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" - ",t.department.titre,"")}}function $e(n,a){if(1&n&&(e.\u0275\u0275text(0),e.\u0275\u0275template(1,Ae,2,1,"span",41)),2&n){const t=a.item,i=e.\u0275\u0275nextContext();e.\u0275\u0275textInterpolate1(" ",t.titre,""),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.service.departments&&i.service.departments.length>1)}}function we(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext().item;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" - ",t.department.titre,"")}}function Be(n,a){if(1&n&&(e.\u0275\u0275text(0),e.\u0275\u0275template(1,we,2,1,"span",41)),2&n){const t=a.item,i=e.\u0275\u0275nextContext();e.\u0275\u0275textInterpolate1(" ",t.titre,""),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.service.departments&&i.service.departments.length>1)}}function ke(n,a){1&n&&(e.\u0275\u0275elementStart(0,"td",92),e.\u0275\u0275text(1," Chargement... "),e.\u0275\u0275elementEnd())}function De(n,a){1&n&&(e.\u0275\u0275elementStart(0,"td",92),e.\u0275\u0275text(1," Aucune donn\xe9e trouv\xe9e ! "),e.\u0275\u0275elementEnd())}const Fe=function(n){return["/departments/details",n]};function Pe(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"a",100),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext().$implicit,i=e.\u0275\u0275nextContext();e.\u0275\u0275property("routerLink",i.authService.isAuthorized("departments_details")?e.\u0275\u0275pureFunction1(2,Fe,t.node_a.department.id):null),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.node_a.department.titre)}}const O=function(n){return["/nodes/details",n]};function Ve(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"a",100),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext().$implicit,i=e.\u0275\u0275nextContext();e.\u0275\u0275property("routerLink",i.authService.isAuthorized("nodes_details")?e.\u0275\u0275pureFunction1(2,O,t.node_a.id):null),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.node_a.titre)}}function ze(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275elementStart(1,"a",100),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()),2&n){const t=a.$implicit,i=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("routerLink",i.authService.isAuthorized("nodes_details")?e.\u0275\u0275pureFunction1(2,O,t.id):null),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("- ",t.titre,"")}}function Me(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"small",62),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("(",t.edge_set_length/1e3,"km)")}}const Oe=function(n){return["/teams/details",n]};function je(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"a",100),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext().$implicit,i=e.\u0275\u0275nextContext();e.\u0275\u0275property("routerLink",i.authService.isAuthorized("teams_details")?e.\u0275\u0275pureFunction1(2,Oe,t.node_a.department.team.id):null),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.node_a.department.team.titre)}}const j=function(n){return["details",n]};function Re(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"a",106),e.\u0275\u0275element(1,"i",107),e.\u0275\u0275text(2," Voir "),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext(2).$implicit;e.\u0275\u0275property("routerLink",e.\u0275\u0275pureFunction1(1,j,t.id))}}const Ue=function(n){return["persist",n]};function Qe(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"a",106),e.\u0275\u0275element(1,"i",108),e.\u0275\u0275text(2," Modifier "),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext(2).$implicit;e.\u0275\u0275property("routerLink",e.\u0275\u0275pureFunction1(1,Ue,t.id))}}function Ge(n,a){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"a",109),e.\u0275\u0275listener("click",function(r){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext(2).$implicit;return e.\u0275\u0275nextContext().service.deleteItem(s.id,r.target)}),e.\u0275\u0275element(1,"i",110),e.\u0275\u0275text(2," Supprimer "),e.\u0275\u0275elementEnd()}}function Je(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"div",101),e.\u0275\u0275element(1,"i",102),e.\u0275\u0275elementStart(2,"div",103),e.\u0275\u0275template(3,Re,3,3,"a",104),e.\u0275\u0275template(4,Qe,3,3,"a",104),e.\u0275\u0275template(5,Ge,3,0,"a",105),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",t.authService.isAuthorized("visites_details")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.authService.isAuthorized("visites_update")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.authService.isAuthorized("visites_delete"))}}const We=function(){return[]};function Ke(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"tr",15),e.\u0275\u0275elementStart(1,"td"),e.\u0275\u0275element(2,"ngb-highlight",93),e.\u0275\u0275pipe(3,"date"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"td"),e.\u0275\u0275template(5,Pe,2,4,"a",94),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"td"),e.\u0275\u0275template(7,Ve,2,4,"a",94),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"td"),e.\u0275\u0275template(9,ze,3,4,"div",72),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"td"),e.\u0275\u0275elementStart(11,"b"),e.\u0275\u0275element(12,"ngb-highlight",93),e.\u0275\u0275text(13," Support"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(14,"br"),e.\u0275\u0275template(15,Me,2,1,"small",95),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"td"),e.\u0275\u0275template(17,je,2,4,"a",94),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"td"),e.\u0275\u0275elementStart(19,"a",96),e.\u0275\u0275element(20,"anomalies-badge",97),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"td",98),e.\u0275\u0275template(22,Je,6,3,"div",99),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()),2&n){const t=a.$implicit,i=e.\u0275\u0275nextContext(),r=e.\u0275\u0275reference(36),s=e.\u0275\u0275reference(40),l=e.\u0275\u0275reference(60);e.\u0275\u0275advance(2),e.\u0275\u0275property("result",e.\u0275\u0275pipeBind3(3,13,t.date,"medium","Africa/Casablanca"))("term",r.value+s.value),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",t.node_a.department),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.node_a),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",t.node_b),e.\u0275\u0275advance(3),e.\u0275\u0275property("result",t.nbSupport)("term",l.value),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",t.edge_set_length),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.node_a.department.team),e.\u0275\u0275advance(2),e.\u0275\u0275property("routerLink",i.authService.isAuthorized("visites_details")?e.\u0275\u0275pureFunction1(17,j,t.id):e.\u0275\u0275pureFunction0(19,We)),e.\u0275\u0275advance(1),e.\u0275\u0275property("total",t.total_anomalies)("undone",t.undone_anomalies),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.authService.isAuthorized("visites_details")||i.authService.isAuthorized("visites_update")||i.authService.isAuthorized("visites_delete"))}}function Ye(n,a){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",112),e.\u0275\u0275elementStart(1,"div",113),e.\u0275\u0275elementStart(2,"div",114),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",113),e.\u0275\u0275elementStart(5,"div",115),e.\u0275\u0275elementStart(6,"ngb-pagination",116),e.\u0275\u0275listener("pageChange",function(r){return e.\u0275\u0275restoreView(t),e.\u0275\u0275nextContext(2).service.page=r})("pageChange",function(r){return e.\u0275\u0275restoreView(t),e.\u0275\u0275nextContext(2).service.onPaginate(r)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()}if(2&n){const t=e.\u0275\u0275nextContext().ngIf,i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate3(" Affichage de ",t.startIndex," \xe0 ",t.endIndex," de ",t.totalRecords," entr\xe9es "),e.\u0275\u0275advance(3),e.\u0275\u0275property("collectionSize",t.totalRecords)("page",i.service.page)("pageSize",i.service.pageSize)("maxSize",5)}}function He(n,a){if(1&n&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Ye,7,7,"div",111),e.\u0275\u0275elementContainerEnd()),2&n){const t=a.ngIf,i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.totalRecords>i.service.pageSize)}}let Xe=(()=>{class n{constructor(t,i,r,s,l){this.service=t,this.fb=i,this.authService=r,this.http=s,this.config=l,this.server=A.N.serverURL,this.Math=Math,t.findAll(),t.loadTeams(),t.loadANodes(),t.loadBNodes(),t.loadDepartments(),this.visitsParCommunes(),this.teamCoveredDistance(),this.totalCoveredDistance(),l.notFoundText="Aucune donn\xe9e trouv\xe9e !",t.visiteForm=i.group({nbSupport:[null],before:[""],after:[""],"node_a.department.id[]":[""],"node_a.id[]":[""],"node_b.id[]":[""],"node_a.department.team.id[]":[""]})}statsPerMonth(t){this.selectedMonth=le.a[parseInt(t)-1],this.statsPerMonth$=this.http.get(`${this.server}/api/analytics/visits-stats/stats-per-month?m=`+t).pipe((0,T.U)(i=>(console.log(i),i.difference=1*i.anomaliesCurrent-1*i.anomaliesPrev,i)))}totalCoveredDistance(){this.totalCoveredDistance$=this.http.get(`${this.server}/api/analytics/visits-stats/total-covered-distance/`)}teamCoveredDistance(){this.teamCoveredDistance$=this.http.get(`${this.server}/api/analytics/visits-stats/team-covered-distance/`)}visitsParCommunes(){this.visitsParCommunes$=this.http.get(`${this.server}/api/analytics/visits-stats/visits-per-communes`).pipe((0,T.U)(t=>({empty:0==t.length,series:[{name:"Nombre de visites",data:t.map(i=>i.VISTES)}],responsive:[{breakpoint:480,options:{chart:{height:"auto"}}}],chart:{height:350,type:"bar"},plotOptions:{bar:{columnWidth:"45%",distributed:!0}},dataLabels:{enabled:!1},legend:{show:!1},grid:{show:!1},xaxis:{categories:t.map(i=>i.COMMUNE)},yaxis:{labels:{formatter:i=>Math.round(i)}}})))}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject($),e.\u0275\u0275directiveInject(m.qu),e.\u0275\u0275directiveInject(w.$),e.\u0275\u0275directiveInject(F.eN),e.\u0275\u0275directiveInject(S.$q))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["app-visites-list"]],decls:87,vars:52,consts:[[1,"container-fluid","mb-5"],["class","row",4,"ngIf"],[1,"row","align-items-center","justify-content-between","mb-4"],[1,"col-auto"],["title","Liste des visites",3,"breadcrumbItems"],["routerLink","/visites/persist","class","btn btn-primary ms-2",4,"ngIf"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"table-responsive",3,"formGroup","ngSubmit"],[1,"table","table-bordered","sticky-column"],[2,"min-width","200px"],[2,"min-width","130px"],["width","123px"],["valign","middle"],[1,"d-flex","gap-2"],[1,"input-group","clockpicker"],["ngbDatepicker","","formControlName","after","placeholder","De...",1,"form-control",3,"click"],["searchDateStart","","ds","ngbDatepicker"],["ngbDatepicker","","formControlName","before","placeholder","\xc0...",1,"form-control",3,"click"],["searchDateEnd","","de","ngbDatepicker"],["formControlName","node_a.department.id[]","bindLabel","titre","bindValue","id","placeholder","D\xe9part..","typeToSearchText","Veuillez saisir 2 caract\xe8res ou plus",3,"items","multiple","minTermLength","loading","typeahead"],["searchDepar",""],["formControlName","node_a.id[]","bindValue","id","placeholder","De..","typeToSearchText","Veuillez saisir 2 caract\xe8res ou plus",3,"items","multiple","minTermLength","readonly","loading","typeahead"],["searchANode",""],["ng-label-tmp",""],["ng-option-tmp",""],["formControlName","node_b.id[]","bindValue","id","placeholder","\xc0..","typeToSearchText","Veuillez saisir 2 caract\xe8res ou plus",3,"items","multiple","minTermLength","readonly","loading","typeahead"],["searchBNode",""],["type","text","placeholder","Longueur visit\xe9e...","formControlName","nbSupport",1,"form-control"],["searchNbSupport",""],["formControlName","node_a.department.team.id[]","bindLabel","titre","bindValue","id","placeholder","\xc9quipe..","typeToSearchText","Veuillez saisir 2 caract\xe8res ou plus",3,"items","multiple","minTermLength","loading","typeahead"],["searchTeam",""],["type","submit",1,"btn","btn-sm","btn-primary","d-flex","align-items-center"],[1,"bx","bx-search","me-1"],[1,"d-none","d-md-inline"],["type","reset",1,"btn","btn-sm","text-primary","flex","align-items-center",3,"click"],[1,"bx","bx-undo","me-md-1"],["class","text-center","colspan","8",4,"ngIf"],["valign","middle",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"col-xl-6","d-flex","flex-column"],[1,"card","card-body","py-2","flex-grow-0"],[1,"clearfix","mb-2"],[1,"float-end"],[3,"selectionChange"],[1,"col-lg-7","p-1"],[1,"border","p-3","rounded-3","h-100"],[1,"fw-medium","mb-1"],["class","col-auto pe-1",4,"ngIf"],["class","col",4,"ngIf"],["class","col-lg-5 p-1",4,"ngIf"],[1,"card","card-body","flex-1"],["class","py-2",4,"ngIf"],[1,"col-xl-6","pb-4"],[1,"card","card-body","pb-0","h-100","mb-0"],[4,"ngIf","ngIfElse"],["visitsParCommunesLoading",""],[1,"col-auto","pe-1"],[1,"text-muted","font-size-10"],[1,"h4","d-block"],[1,"text-muted"],[1,"col"],[1,"col-lg-5","p-1"],[1,"fw-medium","mb-2"],[1,"mt-2","mb-2"],[1,"font-size-11","me-2","badge",3,"ngClass"],["isDifferent",""],[1,"h4","mb-0"],[1,"py-2"],["title","la longueur visit\xe9e de chaque \xe9quipe pendant l'ann\xe9e en cours, o\xf9 elle est compar\xe9e \xe0 la longueur totale des d\xe9partements de l'\xe9quipe * 2 ( autrement dit, chaque \xe9quipe devrait passer dans chaque d\xe9partement deux fois par an).",1,"fw-medium","mb-2"],[4,"ngFor","ngForOf"],[1,"mt-4","pb-2","mb-0",3,"title"],[1,"progress","animated-progess","progress-sm"],["role","progressbar","aria-valuemin","0","attr.aria-valuemax","100",1,"progress-bar"],[1,"fw-medium","mb-0"],["VistesByCommuneEmpty",""],[3,"series","chart","dataLabels","plotOptions","yaxis","xaxis","legend","grid"],[1,"mt-4","alert","alert-info"],["xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","width","200px","height","310px","viewBox","0 0 100 100","preserveAspectRatio","xMidYMid",2,"margin","auto","opacity","0.2","display","block"],["transform","rotate(180 50 50)"],["x","15","y","15","width","10","height","40","fill","#e8e8e8"],["attributeName","height","values","50;70;30;50","keyTimes","0;0.33;0.66;1","dur","5.2631578947368425s","repeatCount","indefinite","calcMode","spline","keySplines","0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1","begin","-2.1052631578947367s"],["x","35","y","15","width","10","height","40","fill","#dce4eb"],["attributeName","height","values","50;70;30;50","keyTimes","0;0.33;0.66;1","dur","5.2631578947368425s","repeatCount","indefinite","calcMode","spline","keySplines","0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1","begin","-1.0526315789473684s"],["x","55","y","15","width","10","height","40","fill","#bbcedd"],["attributeName","height","values","50;70;30;50","keyTimes","0;0.33;0.66;1","dur","5.2631578947368425s","repeatCount","indefinite","calcMode","spline","keySplines","0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1","begin","-3.1578947368421053s"],["x","75","y","15","width","10","height","40","fill","#85a2b6"],["attributeName","height","values","50;70;30;50","keyTimes","0;0.33;0.66;1","dur","5.2631578947368425s","repeatCount","indefinite","calcMode","spline","keySplines","0.5 0 0.5 1;0.5 0 0.5 1;0.5 0 0.5 1","begin","-5.2631578947368425s"],["routerLink","/visites/persist",1,"btn","btn-primary","ms-2"],[1,"fas","fa-plus-circle"],["colspan","8",1,"text-center"],[3,"result","term"],["target","_blank",3,"routerLink",4,"ngIf"],["class","text-muted",4,"ngIf"],["href","javascript: void(0);","fragment","anomalies-list",3,"routerLink"],[3,"total","undone"],["align","center"],["ngbDropdown","","container","body","placement","bottom-right",4,"ngIf"],["target","_blank",3,"routerLink"],["ngbDropdown","","container","body","placement","bottom-right"],["ngbDropdownToggle","","data-toggle","dropdown","aria-expanded","true",1,"fas","fa-ellipsis-h","dropdown-toggle","c-pointer"],["ngbDropdownMenu","",1,"dropdown-menu","dropdown-menu-end"],["class","dropdown-item","href","javascript: void(0);",3,"routerLink",4,"ngIf"],["class","dropdown-item text-danger","href","javascript: void(0);",3,"click",4,"ngIf"],["href","javascript: void(0);",1,"dropdown-item",3,"routerLink"],[1,"fas","fa-eye","me-2"],[1,"fas","fa-edit","me-2"],["href","javascript: void(0);",1,"dropdown-item","text-danger",3,"click"],[1,"fas","fa-trash","me-2"],["class","row justify-content-md-between align-items-md-center mt-2",4,"ngIf"],[1,"row","justify-content-md-between","align-items-md-center","mt-2"],[1,"col-sm-12","col-md-5"],["id","tickets-table_info","role","status","aria-live","polite",1,"dataTables_info","mb-2"],[1,"text-md-right","float-md-end","pagination-rounded"],[3,"collectionSize","page","pageSize","maxSize","pageChange"]],template:function(t,i){if(1&t){const r=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,ye,27,16,"div",1),e.\u0275\u0275elementStart(2,"div",2),e.\u0275\u0275elementStart(3,"div",3),e.\u0275\u0275element(4,"app-page-title",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",3),e.\u0275\u0275template(6,Ce,3,0,"a",5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"div",6),e.\u0275\u0275elementStart(8,"div",7),e.\u0275\u0275elementStart(9,"div",8),e.\u0275\u0275elementStart(10,"div",9),e.\u0275\u0275elementStart(11,"form",10),e.\u0275\u0275listener("ngSubmit",function(){return i.service.onSearch()}),e.\u0275\u0275elementStart(12,"table",11),e.\u0275\u0275elementStart(13,"thead"),e.\u0275\u0275elementStart(14,"tr"),e.\u0275\u0275elementStart(15,"th",12),e.\u0275\u0275text(16,"Date"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"th",12),e.\u0275\u0275text(18,"D\xe9part"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"th",13),e.\u0275\u0275text(20,"De"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"th",13),e.\u0275\u0275text(22,"\xc0"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"th",13),e.\u0275\u0275text(24,"Longueur visit\xe9e"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(25,"th",13),e.\u0275\u0275text(26,"\xc9quipe"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(27,"th",13),e.\u0275\u0275text(28,"Anomalies"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(29,"th",14),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(30,"tbody"),e.\u0275\u0275elementStart(31,"tr",15),e.\u0275\u0275elementStart(32,"td"),e.\u0275\u0275elementStart(33,"div",16),e.\u0275\u0275elementStart(34,"div",17),e.\u0275\u0275elementStart(35,"input",18,19),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(r),e.\u0275\u0275reference(37).open()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(38,"div",17),e.\u0275\u0275elementStart(39,"input",20,21),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(r),e.\u0275\u0275reference(41).open()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(42,"td"),e.\u0275\u0275element(43,"ng-select",22,23),e.\u0275\u0275pipe(45,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(46,"td"),e.\u0275\u0275elementStart(47,"ng-select",24,25),e.\u0275\u0275pipe(49,"async"),e.\u0275\u0275template(50,Le,2,2,"ng-template",26),e.\u0275\u0275template(51,Ne,2,2,"ng-template",27),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(52,"td"),e.\u0275\u0275elementStart(53,"ng-select",28,29),e.\u0275\u0275pipe(55,"async"),e.\u0275\u0275template(56,$e,2,2,"ng-template",26),e.\u0275\u0275template(57,Be,2,2,"ng-template",27),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(58,"td"),e.\u0275\u0275element(59,"input",30,31),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(61,"td"),e.\u0275\u0275element(62,"ng-select",32,33),e.\u0275\u0275pipe(64,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(65,"td"),e.\u0275\u0275elementStart(66,"td"),e.\u0275\u0275elementStart(67,"button",34),e.\u0275\u0275element(68,"i",35),e.\u0275\u0275elementStart(69,"span",36),e.\u0275\u0275text(70,"Rechercher"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(71,"button",37),e.\u0275\u0275listener("click",function(){return i.service.findAll()}),e.\u0275\u0275element(72,"i",38),e.\u0275\u0275elementStart(73,"span",36),e.\u0275\u0275text(74,"R\xe9initialiser"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(75,"tr"),e.\u0275\u0275template(76,ke,2,0,"td",39),e.\u0275\u0275pipe(77,"async"),e.\u0275\u0275pipe(78,"async"),e.\u0275\u0275template(79,De,2,0,"td",39),e.\u0275\u0275pipe(80,"async"),e.\u0275\u0275pipe(81,"async"),e.\u0275\u0275pipe(82,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(83,Ke,23,20,"tr",40),e.\u0275\u0275pipe(84,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(85,He,2,1,"ng-container",41),e.\u0275\u0275pipe(86,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()}2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.authService.isAuthorized("statistiques_show")),e.\u0275\u0275advance(3),e.\u0275\u0275property("breadcrumbItems",i.breadCrumbItems),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.authService.isAuthorized("visites_add")),e.\u0275\u0275advance(5),e.\u0275\u0275property("formGroup",i.service.visiteForm),e.\u0275\u0275advance(32),e.\u0275\u0275property("items",e.\u0275\u0275pipeBind1(45,30,i.service.departments$))("multiple",!0)("minTermLength",2)("loading",i.service.departmentLoading)("typeahead",i.service.departmentInput$),e.\u0275\u0275advance(4),e.\u0275\u0275property("items",e.\u0275\u0275pipeBind1(49,32,i.service.ANode$))("multiple",!0)("minTermLength",2)("readonly",!i.service.departments)("loading",i.service.ANodeLoading)("typeahead",i.service.ANodeInput$),e.\u0275\u0275advance(6),e.\u0275\u0275property("items",e.\u0275\u0275pipeBind1(55,34,i.service.BNode$))("multiple",!0)("minTermLength",2)("readonly",!i.service.departments)("loading",i.service.BNodeLoading)("typeahead",i.service.BNodeInput$),e.\u0275\u0275advance(9),e.\u0275\u0275property("items",e.\u0275\u0275pipeBind1(64,36,i.service.teams$))("multiple",!0)("minTermLength",2)("loading",i.service.teamLoading)("typeahead",i.service.teamInput$),e.\u0275\u0275advance(14),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(77,38,!e.\u0275\u0275pipeBind1(78,40,i.service.visites$)&&i.service.loading$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(80,42,e.\u0275\u0275pipeBind1(81,44,i.service.visites$)&&0===e.\u0275\u0275pipeBind1(82,46,i.service.visites$).length&&i.service.loaded$)),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(84,48,i.service.visites$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(86,50,i.service.pagination$)))},directives:[p.NgIf,B.V,m._Y,m.JL,m.sg,c.J4,m.Fj,m.JJ,m.u,S.w9,S.bb,S.Z2,p.NgForOf,de.V,p.NgClass,M.x,h.yS,c._h,me.c,c.jt,c.iD,c.Vi,c.N9],pipes:[p.AsyncPipe,p.LowerCasePipe,p.DatePipe],encapsulation:2}),n})();function Ze(n,a){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275elementStart(1,"ngb-alert",38),e.\u0275\u0275listener("closed",function(){const s=e.\u0275\u0275restoreView(t).$implicit;return e.\u0275\u0275nextContext().removeAlert(s)}),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()}if(2&n){const t=a.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("type",t.type),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.message," ")}}function qe(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"ng-option",39),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=a.$implicit;e.\u0275\u0275property("value","/api/departments/"+t.id),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.titre)}}function et(n,a){1&n&&(e.\u0275\u0275elementStart(0,"div",40,41),e.\u0275\u0275text(2,"Ce champ est obligatoire."),e.\u0275\u0275elementEnd())}function tt(n,a){1&n&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1,"Ce champ est obligatoire."),e.\u0275\u0275elementEnd())}function nt(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"div",42),e.\u0275\u0275template(1,tt,2,0,"span",43),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.service.ANode.errors.required)}}function it(n,a){1&n&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1,"Ce champ est obligatoire."),e.\u0275\u0275elementEnd())}function at(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"div",42),e.\u0275\u0275template(1,it,2,0,"span",43),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.service.BNode.errors.required)}}function rt(n,a){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",33),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(t),e.\u0275\u0275nextContext().service.Persist("NEW")}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275text(2,"Cr\xe9er et ajouter un nouveau"),e.\u0275\u0275elementEnd()}if(2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(1,1,t.service.loading$)||t.service.anomalyLoading)}}function st(n,a){1&n&&e.\u0275\u0275element(0,"i",44)}const ot=function(){return{year:1900,month:1,day:1}},lt=function(n){return{"is-invalid":n}},R=n=>({hour:n.getHours(),minute:n.getMinutes(),second:n.getSeconds()}),U=n=>({year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate()});let Q=(()=>{class n{constructor(t,i,r,s){this.fb=t,this.route=i,this.service=r,this.authService=s,this.showError=!1,this.alert=window.alert,this.alerts=[],this.breadCrumbItems=[{label:"Visites"},{label:"Fiche visite",active:!0}],this.service.EditeMode=!1,r.loadDepartments(!1),r.visiteForm=this.fb.group({anomalies:this.fb.array([]),date:[""],time:[""],nbSupport:[null],department:["",m.kI.required],nodeA:["",m.kI.required],nodeB:[[]]});let l=this.route.snapshot.paramMap.get("id");if(l)this.service.EditeMode=!0,r.getByKey(Number(l)).subscribe(d=>{this.service.existingVisit=d,this.id=String(d.id),r.loadANodes(d.node_a?[d.node_a]:[]),r.loadBNodes(d.node_b?d.node_b:[]);let v=null,g=null;d.date&&(g=(n=>new Date(Date.parse(n)))(d.date),v=R(g)),r.visiteForm.patchValue({date:U(g),time:v,department:d.node_a.department?d.node_a.department["@id"]:null,nodeA:d.node_a?d.node_a["@id"]:null,nbSupport:d.nbSupport?d.nbSupport:0,nodeB:d.node_b.length?d.node_b.map(_=>_["@id"]):[]}),this.currentEdge={ANode:this.service.ANode.value,BNode:this.service.BNode.value,department:d.node_a.department["@id"],type:!0,date:d.date},this.formListeners()});else{let d=new Date,v=R(d),g=U(d);r.visiteForm.patchValue({date:g,time:v}),r.loadANodes(),r.loadBNodes(),this.formListeners()}}AlertANodeChange(){this.addAlert("En changeant le PS, les champs tron\xe7ons d'anomalies seront r\xe9initialis\xe9s.","warning")}AlertDeparChange(){let t=this.service.ANode.value,i=this.service.BNode.value,r=t&&""!==t.trim()||i&&0!==i.length,s=this.hasNonEmptyEdges;(r||r)&&this.addAlert(`En changeant le d\xe9partement, les champs ${r?"appareils de coupeur":""}${r&&s?" et ":""}${s?"tron\xe7ons d'anomalies":""} seront r\xe9initialis\xe9s.`,"warning")}removeAlert(t){const i=this.alerts.indexOf(t);-1!==i&&this.alerts.splice(i,1)}addAlert(t,i){if(-1===this.alerts.findIndex(s=>s.message===t&&s.type===i)){window.scrollTo(0,0);const s={message:t,type:i};this.alerts.push(s),setTimeout(()=>this.removeAlert(s),15e3)}}formListeners(){let t=this.service.ANode,i=this.service.BNode,r=this.service.department,s=this.service.date;t.valueChanges.subscribe(()=>{this.anomalies.controls.forEach(l=>{l.get("edge").reset()})}),[i,t,s].forEach(l=>{l.valueChanges.subscribe(()=>{this.currentEdge={ANode:t.value,BNode:i.value,department:r.value,type:!0,date:s.value}})}),r.valueChanges.subscribe(()=>{t.reset(),i.reset(),this.anomalies.controls.forEach(l=>{l.get("edge").reset()})})}get anomalies(){return this.service.visiteForm.get("anomalies")}get hasNonEmptyEdges(){return this.anomalies.controls.some(t=>{const i=t.get("edge");return i&&""!==i.value.trim()})}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(m.qu),e.\u0275\u0275directiveInject(h.gz),e.\u0275\u0275directiveInject($),e.\u0275\u0275directiveInject(w.$))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["app-visite-persist"]],decls:61,vars:52,consts:[[1,"container-fluid","pb-5","mb-5",3,"formGroup"],["title","Formulaire de visite",3,"Loading","breadcrumbItems"],[4,"ngFor","ngForOf"],[1,"row","mt-4"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"mb-3","row"],["for","name-input",1,"col-md-2","col-form-label"],[1,"col-md-10","row"],[1,"col"],[1,"input-group","clockpicker"],["ngbDatepicker","","formControlName","date",1,"form-control",3,"minDate","click"],["ds","ngbDatepicker"],[1,"col-auto"],["seconds","true","formControlName","time",3,"spinners"],["for","input-2",1,"col-md-2","col-form-label"],["id","input-2",1,"col-md-10"],["formControlName","department","placeholder","D\xe9par..",3,"open"],[3,"value",4,"ngFor","ngForOf"],["class","invalid-feedback d-block d-block",4,"ngIf"],["for","input-1",1,"col-md-2","col-form-label"],["id","input-1",1,"col-md-10",3,"click"],["formControlName","nodeA","bindLabel","titre","bindValue","@id","typeToSearchText","Veuillez saisir 2 caract\xe8res ou plus",3,"items","minTermLength","readonly","loading","ngClass","typeahead"],["class","invalid-feedback d-block",4,"ngIf"],[1,"col-md-10"],["formControlName","nodeB","bindLabel","titre","bindValue","@id","typeToSearchText","Veuillez saisir 2 caract\xe8res ou plus",3,"items","minTermLength","multiple","readonly","loading","typeahead"],["for","nbSupport-input",1,"col-md-2","col-form-label"],["formControlName","nbSupport","type","number","step","1","id","nbSupport-input",1,"form-control"],[3,"anomalies","currentEdge","parentFormGroup","showErrors","addAlert"],[1,"sticky-actions"],[1,"btn","btn-primary","float-end",3,"disabled","click"],["class","btn btn-light me-2 float-end text-primary",3,"disabled","click",4,"ngIf"],[1,"btn","btn-light","me-2","float-end","text-primary",3,"disabled","click"],[1,"fas","fa-arrow-circle-left","me-1"],["type","button",1,"btn","text-danger","float-end","me-2","fw-medium","btn-light",3,"disabled","click"],[1,"mdi","mdi-trash-can","align-middle","me-2"],["class","bx bx-loader-alt fa-spin float-end me-3",4,"ngIf"],[1,"custom-alert","glow","mt-3",3,"type","closed"],[3,"value"],[1,"invalid-feedback","d-block","d-block"],["postfeedback",""],[1,"invalid-feedback","d-block"],[4,"ngIf"],[1,"bx","bx-loader-alt","fa-spin","float-end","me-3"]],template:function(t,i){if(1&t){const r=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"form",0),e.\u0275\u0275element(1,"app-page-title",1),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275template(3,Ze,3,2,"div",2),e.\u0275\u0275elementStart(4,"div",3),e.\u0275\u0275elementStart(5,"div",4),e.\u0275\u0275elementStart(6,"div",5),e.\u0275\u0275elementStart(7,"div",6),e.\u0275\u0275elementStart(8,"div",7),e.\u0275\u0275elementStart(9,"label",8),e.\u0275\u0275text(10,"Date"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"div",9),e.\u0275\u0275elementStart(12,"div",10),e.\u0275\u0275elementStart(13,"div",11),e.\u0275\u0275elementStart(14,"input",12,13),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(r),e.\u0275\u0275reference(15).open()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"div",14),e.\u0275\u0275element(17,"ngb-timepicker",15),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"div",7),e.\u0275\u0275elementStart(19,"label",16),e.\u0275\u0275text(20,"D\xe9part"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"div",17),e.\u0275\u0275elementStart(22,"ng-select",18),e.\u0275\u0275listener("open",function(){return i.service.department.value&&i.AlertDeparChange()}),e.\u0275\u0275template(23,qe,2,2,"ng-option",19),e.\u0275\u0275pipe(24,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(25,et,3,0,"div",20),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"div",7),e.\u0275\u0275elementStart(27,"label",21),e.\u0275\u0275text(28,"De"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(29,"div",22),e.\u0275\u0275listener("click",function(){return i.showError=!0}),e.\u0275\u0275element(30,"ng-select",23),e.\u0275\u0275pipe(31,"async"),e.\u0275\u0275template(32,nt,2,1,"div",24),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(33,"div",7),e.\u0275\u0275elementStart(34,"label",21),e.\u0275\u0275text(35,"\xc0"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(36,"div",25),e.\u0275\u0275element(37,"ng-select",26),e.\u0275\u0275pipe(38,"async"),e.\u0275\u0275template(39,at,2,1,"div",24),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(40,"div",7),e.\u0275\u0275elementStart(41,"label",27),e.\u0275\u0275text(42,"Nb Support"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(43,"div",25),e.\u0275\u0275element(44,"input",28),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(45,"app-related-anomalies",29),e.\u0275\u0275listener("addAlert",function(l){return i.addAlert(l.message,l.type)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(46,"div",30),e.\u0275\u0275elementStart(47,"button",31),e.\u0275\u0275listener("click",function(){return i.service.Persist("EDIT")}),e.\u0275\u0275pipe(48,"async"),e.\u0275\u0275text(49," Sauvegarder"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(50,rt,3,3,"button",32),e.\u0275\u0275elementStart(51,"button",33),e.\u0275\u0275listener("click",function(){return i.service.Persist("LIST")}),e.\u0275\u0275pipe(52,"async"),e.\u0275\u0275element(53,"i",34),e.\u0275\u0275text(54," Sauvegarder et retourner \xe0 la liste"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(55,"button",35),e.\u0275\u0275listener("click",function(){return i.service.deleteItem()}),e.\u0275\u0275pipe(56,"async"),e.\u0275\u0275element(57,"i",36),e.\u0275\u0275text(58,"Supprimer "),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(59,st,1,0,"i",37),e.\u0275\u0275pipe(60,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()}2&t&&(e.\u0275\u0275property("formGroup",i.service.visiteForm),e.\u0275\u0275advance(1),e.\u0275\u0275property("Loading",e.\u0275\u0275pipeBind1(2,33,i.service.loading$))("breadcrumbItems",i.breadCrumbItems),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",i.alerts),e.\u0275\u0275advance(11),e.\u0275\u0275property("minDate",e.\u0275\u0275pureFunction0(49,ot)),e.\u0275\u0275advance(3),e.\u0275\u0275property("spinners",!1),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(24,35,i.service.departments$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.showError&&!i.service.department.value),e.\u0275\u0275advance(5),e.\u0275\u0275property("items",e.\u0275\u0275pipeBind1(31,37,i.service.ANode$))("minTermLength",2)("readonly",!i.service.department.value)("loading",i.service.ANodeLoading)("ngClass",e.\u0275\u0275pureFunction1(50,lt,i.service.ANode.invalid&&i.service.submitted))("typeahead",i.service.ANodeInput$),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.service.submitted&&i.service.ANode.errors),e.\u0275\u0275advance(5),e.\u0275\u0275property("items",e.\u0275\u0275pipeBind1(38,39,i.service.BNode$))("minTermLength",2)("multiple",!0)("readonly",!i.service.department.value)("loading",i.service.BNodeLoading)("typeahead",i.service.BNodeInput$),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",i.service.submitted&&i.service.BNode.errors),e.\u0275\u0275advance(6),e.\u0275\u0275property("anomalies",i.anomalies)("currentEdge",i.currentEdge)("parentFormGroup",i.service.visiteForm)("showErrors",i.service.submitted),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(48,41,i.service.loading$)||i.service.anomalyLoading),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!i.service.EditeMode),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(52,43,i.service.loading$)||i.service.anomalyLoading),e.\u0275\u0275advance(4),e.\u0275\u0275classProp("d-none",!i.service.EditeMode||!i.service.existingVisit),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(56,45,i.service.loading$)||i.service.anomalyLoading),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",i.service.submitted&&(e.\u0275\u0275pipeBind1(60,47,i.service.loading$)||i.service.anomalyLoading)))},directives:[m._Y,m.JL,m.sg,B.V,p.NgForOf,c.J4,m.Fj,m.JJ,m.u,c.Pm,S.w9,p.NgIf,p.NgClass,m.wV,V.T,c.xm,S.xv],pipes:[p.AsyncPipe],encapsulation:2}),n})();const mt=[{path:"",component:Xe,canActivate:[x.p],data:{access:"visites_show"}},{path:"details/:id",component:oe,canActivate:[x.p],data:{access:"visites_details"}},{path:"persist/:id",component:Q,canActivate:[x.p],data:{access:"visites_update"}},{path:"persist",component:Q,canActivate:[x.p],data:{access:"visites_add"}}];let pt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=e.\u0275\u0275defineInjector({imports:[[h.Bz.forChild(mt)],h.Bz]}),n})();var ct=o(9922),ut=o(6831);let vt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=e.\u0275\u0275defineInjector({imports:[[pt,ct.m,c.M,c.UL,c.dT,c._A,M.X,ut.U]]}),n})()}}]);