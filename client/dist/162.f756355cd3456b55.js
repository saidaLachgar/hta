"use strict";(self.webpackChunkskote=self.webpackChunkskote||[]).push([[162],{6761:(K,L,e)=>{e.d(L,{l:()=>_});var c=e(1824),P=e(3405),E=e(3596),o=e(2411),D=e(6813),u=e(5686),f=e(5389),n=e(8735),p=e(1366),d=e(9204),j=e(8053),U=e(2047),l=e(8260),g=e(3668),C=e(5633),I=e(5069),B=e(8274),R=e(4522);let _=(()=>{class O extends c.c8{constructor(t,i,r,a,v){super("departments",t),this.serviceElementsFactory=t,this.confirmDialogService=i,this.MediasService=r,this.toast=a,this.http=v,this.pageSize=l.N.pageSize,this.server=l.N.serverURL,this.teamLoading=!1,this.teamInput$=new P.xQ,this.submitted=!1,this.isLoading=!1,this.FileRemoved=!1,this.page=1}findAll(){this.findByCriteria({page:1})}loadTeams(t=[]){this.teams$=(0,E.z)((0,o.of)(t),this.teamInput$.pipe((0,u.b)(500),(0,f.x)(),(0,n.h)(i=>null!=i),(0,p.b)(()=>this.teamLoading=!0),(0,d.w)(i=>this.http.get(`${this.server}/api/teams?properties[]=id&properties[]=titre&titre=`+i).pipe((0,j.U)(r=>r["hydra:member"]),(0,U.K)(()=>(0,o.of)([])),(0,p.b)(()=>this.teamLoading=!1)))))}getPagination(){this.pagination$=(0,o.of)(),this.pagination$=this.selectors$.entityActions$.pipe((0,j.U)(t=>t.payload.pagination))}deleteItem(t,i){this.confirmDialogService.setConfirmation("Vous \xeates s\xfbr de vouloir supprimer?",()=>{this.delete(t).pipe(this.toast.observe({loading:"Suppression...",success:()=>(i.closest("tr").remove(),"D\xe9part supprim\xe9 avec succ\xe8s"),error:"un probl\xe8me est survenu, veuillez r\xe9essayer"})).subscribe()})}onSearch(){this.page=1,this.lastSearchedParams=this.departmentForm.value,this.findByCriteria(Object.assign({page:1},this.lastSearchedParams))}onCreate(){let t=this.departmentForm;if(this.submitted=!0,t.invalid)return;this.submitted=!1,this.isLoading=!0;let r,i=this.toast,a=this,v=Object.entries(t.value);const m=Object.fromEntries(v.filter(([h,M])=>""!==M));r=this.selectedFile?this.MediasService.Upload(this.selectedFile[0]).pipe((0,d.w)(h=>(m.visuel=h["@id"],this.add(m)))):this.add(m),r.subscribe({error:()=>{a.isLoading=!1,i.error("un probl\xe8me est survenu, veuillez r\xe9essayer")},complete(){t.reset(),a.isLoading=!1,a.selectedFile=null,i.success("D\xe9part ajout\xe9 avec succ\xe8s")}})}onUpdate(t){let i=this.departmentForm;if(this.submitted=!0,i.invalid)return;this.submitted=!1,this.isLoading=!0;let r=this,a=this.toast,v=[],m=Object.entries(i.value);const h=Object.fromEntries(m.filter(([M,A])=>""!==A));h.id=t,!1!==this.FileRemoved&&(h.visuel=null),this.selectedFile?(this.isLoading=!0,v.push(this.MediasService.Upload(this.selectedFile[0]).pipe((0,d.w)(M=>(this.uploadedFile={id:M.id,url:M.contentUrl},this.selectedFile=null,this.FileRemoved=!1,h.visuel=M["@id"],this.update(h)))))):v.push(this.update(h)),(0,D.D)(v).subscribe({error:()=>{r.isLoading=!1,a.error("un probl\xe8me est survenu, veuillez r\xe9essayer")},complete(){!1!==r.FileRemoved?r.MediasService.delete(r.FileRemoved).subscribe(()=>{r.isLoading=!1,a.success("D\xe9part a \xe9t\xe9 mis \xe0 jour avec succ\xe8s")}):(r.isLoading=!1,a.success("D\xe9part a \xe9t\xe9 mis \xe0 jour avec succ\xe8s"))}})}get titre(){return this.departmentForm.get("titre")}get visuel(){return this.departmentForm.get("visuel")}get team(){return this.departmentForm.get("team")}findByCriteria(t){this.departments$=(0,o.of)([]);let i=Object.keys(t).filter(r=>""!=t[r]&&null!=t[r]).reduce((r,a)=>Object.assign(Object.assign({},r),{[a]:t[a]}),{});this.departments$=this.getWithQuery(i),this.getPagination()}onPaginate(t){this.findByCriteria(Object.assign({page:t},this.lastSearchedParams))}}return O.\u0275fac=function(t){return new(t||O)(g.\u0275\u0275inject(c.yV),g.\u0275\u0275inject(C.D),g.\u0275\u0275inject(I.q),g.\u0275\u0275inject(B.jE),g.\u0275\u0275inject(R.eN))},O.\u0275prov=g.\u0275\u0275defineInjectable({token:O,factory:O.\u0275fac,providedIn:"root"}),O})()},5069:(K,L,e)=>{e.d(L,{q:()=>D});var c=e(1824),P=e(8260),E=e(3668),o=e(4522);let D=(()=>{class u extends c.c8{constructor(n,p){super("media_objects",n),this.serviceElementsFactory=n,this.http=p,this.server=P.N.serverURL}Upload(n){let p=`${this.server}/api/media_objects`,d=new FormData;return d.append("file",n,n.name),this.http.post(p,d,{reportProgress:!0,responseType:"json"}).pipe()}}return u.\u0275fac=function(n){return new(n||u)(E.\u0275\u0275inject(c.yV),E.\u0275\u0275inject(o.eN))},u.\u0275prov=E.\u0275\u0275defineInjectable({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()},6162:(K,L,e)=>{e.d(L,{Y:()=>R});var c=e(1824),P=e(3405),E=e(3596),o=e(2411),D=e(5686),u=e(5389),f=e(8735),n=e(1366),p=e(9204),d=e(2047),j=e(8053),U=e(8260),l=e(3668),g=e(5633),C=e(6761),I=e(5565),B=e(8274);let R=(()=>{class _ extends c.c8{constructor(s,t,i,r,a){super("teams",s),this.serviceElementsFactory=s,this.confirmDialogService=t,this.departmentService=i,this.UserService=r,this.toast=a,this.pageSize=U.N.pageSize,this.membreLoading=!1,this.membreInput$=new P.xQ,this.departmentLoading=!1,this.departmentInput$=new P.xQ,this.submitted=!1,this.page=1}findAll(){this.findByCriteria({page:1})}loadMembers(s=[]){this.membres$=(0,E.z)((0,o.of)(s),this.membreInput$.pipe((0,D.b)(500),(0,u.x)(),(0,f.h)(t=>null!=t),(0,n.b)(()=>this.membreLoading=!0),(0,p.w)(t=>this.UserService.getWithQuery("properties[]=id&properties[]=fullName&fullName="+t).pipe((0,d.K)(()=>(0,o.of)([])),(0,n.b)(()=>this.membreLoading=!1)))))}loadDepartments(s=!0){this.departments$=s?(0,E.z)((0,o.of)([]),this.departmentInput$.pipe((0,D.b)(500),(0,u.x)(),(0,f.h)(t=>null!=t),(0,n.b)(()=>this.departmentLoading=!0),(0,p.w)(t=>this.departmentService.getWithQuery("properties[]=id&properties[]=titre&titre="+t).pipe((0,d.K)(()=>(0,o.of)([])),(0,n.b)(()=>this.departmentLoading=!1))))):this.departmentService.getWithQuery("properties[]=id&properties[]=titre")}getPagination(){this.pagination$=(0,o.of)(),this.pagination$=this.selectors$.entityActions$.pipe((0,j.U)(s=>s.payload.pagination))}deleteItem(s,t){this.confirmDialogService.setConfirmation("Vous \xeates s\xfbr de vouloir supprimer?",()=>{this.delete(s).pipe(this.toast.observe({loading:"Suppression...",success:()=>(t.closest("tr").remove(),"L'\xe9quipe supprim\xe9 avec succ\xe8s"),error:"un probl\xe8me est survenu, veuillez r\xe9essayer"})).subscribe()})}onSearch(){this.page=1,this.lastSearchedParams=this.teamForm.value,this.findByCriteria(Object.assign({page:1},this.lastSearchedParams))}onCreate(){let s=this.teamForm;if(this.submitted=!0,s.invalid)return;this.submitted=!1;let t=this.toast;this.add(s.value).subscribe({error:()=>t.error("un probl\xe8me est survenu, veuillez r\xe9essayer"),complete(){s.reset(),s.setValue({titre:[""],departments:[null],membres:[[]]}),t.success("L'\xe9quipe ajout\xe9 avec succ\xe8s")}})}onUpdate(s){let t=this.teamForm;if(this.submitted=!0,t.invalid)return;this.submitted=!1;let i=this.toast,r=Object.assign({},t.value);r.id=s,this.update(r).subscribe({error:()=>i.error("un probl\xe8me est survenu, veuillez r\xe9essayer"),complete(){i.success("L'\xe9quipe a \xe9t\xe9 mis \xe0 jour avec succ\xe8s")}})}get titre(){return this.teamForm.get("titre")}get membres(){return this.teamForm.get("membres")}get departments(){return this.teamForm.get("departments")}findByCriteria(s){this.teams$=(0,o.of)([]);let t=Object.keys(s).filter(i=>""!=s[i]&&null!=s[i]).reduce((i,r)=>Object.assign(Object.assign({},i),{[r]:s[r]}),{});this.teams$=this.getWithQuery(t),this.getPagination()}onPaginate(s){this.findByCriteria(Object.assign({page:s},this.lastSearchedParams))}}return _.\u0275fac=function(s){return new(s||_)(l.\u0275\u0275inject(c.yV),l.\u0275\u0275inject(g.D),l.\u0275\u0275inject(C.l),l.\u0275\u0275inject(I.K),l.\u0275\u0275inject(B.jE))},_.\u0275prov=l.\u0275\u0275defineInjectable({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()},5565:(K,L,e)=>{e.d(L,{K:()=>R});var c=e(1824),P=e(3405),E=e(3596),o=e(2411),D=e(5686),u=e(5389),f=e(8735),n=e(1366),p=e(9204),d=e(8053),j=e(2047),U=e(8260),l=e(3668),g=e(5633),C=e(4522),I=e(7686),B=e(8274);let R=(()=>{class _ extends c.c8{constructor(s,t,i,r,a){super("users",s),this.serviceElementsFactory=s,this.confirmDialogService=t,this.http=i,this.authService=r,this.toast=a,this.pageSize=U.N.pageSize,this.server=U.N.serverURL,this.teamLoading=!1,this.teamInput$=new P.xQ,this.submitted=!1,this.loading=!1,this.page=1}findAll(){this.findByCriteria({page:1})}loadTeams(s=[]){this.teams$=(0,E.z)((0,o.of)(s),this.teamInput$.pipe((0,D.b)(500),(0,u.x)(),(0,f.h)(t=>null!=t),(0,n.b)(()=>this.teamLoading=!0),(0,p.w)(t=>this.http.get(`${this.server}/api/teams?properties[]=id&properties[]=titre&titre=`+t).pipe((0,d.U)(i=>i["hydra:member"]),(0,j.K)(()=>(0,o.of)([])),(0,n.b)(()=>this.teamLoading=!1)))))}getPagination(){this.pagination$=(0,o.of)(),this.pagination$=this.selectors$.entityActions$.pipe((0,d.U)(s=>s.payload.pagination))}deleteItem(s,t){this.confirmDialogService.setConfirmation("Vous \xeates s\xfbr de vouloir supprimer?",()=>{this.delete(s).pipe(this.toast.observe({loading:"Suppression...",success:()=>(t.closest("tr").remove(),"Utilisateur supprim\xe9 avec succ\xe8s"),error:"un probl\xe8me est survenu, veuillez r\xe9essayer"})).subscribe()})}onSearch(){this.page=1,this.lastSearchedParams=this.userForm.value,this.findByCriteria(Object.assign({page:1},this.lastSearchedParams))}onCreate(){let s=this.userForm;if(this.submitted=!0,s.invalid)return;this.submitted=!1;let t=this.toast,i=Object.entries(s.value);const r=Object.fromEntries(i.filter(([a,v])=>""!==v));r.roles=[r.roles.toString()],this.add(r).subscribe({error:()=>t.error("un probl\xe8me est survenu, veuillez r\xe9essayer"),complete(){s.reset(),t.success("Utilisateur ajout\xe9 avec succ\xe8s")}})}onUpdate(s,t=!1){let i=this.userForm;if(this.submitted=!0,i.invalid)return;this.submitted=!1;let r=this,a=this.toast,v=this.authService.user,m=Object.assign({},i.value);m.id=s,t?m=Object.entries(m).reduce((h,[M,A])=>(""!==A&&null!==A&&(h[M]=A),h),{}):m.roles=[m.roles.toString()],this.update(m).subscribe({error:()=>a.error("un probl\xe8me est survenu, veuillez r\xe9essayer"),complete(){v.id==s?(r.loading=!0,r.authService.logout(!1),r.authService.login(m.username,m.password).subscribe({error:h=>{h&&a.error(h.error.message),r.loading=!1},complete(){r.loading=!1,a.success("L'utilisateur a \xe9t\xe9 mis \xe0 jour avec succ\xe8s"),setTimeout(()=>window.location.reload(),10)}})):a.success("L'utilisateur a \xe9t\xe9 mis \xe0 jour avec succ\xe8s")}})}get fullName(){return this.userForm.get("fullName")}get username(){return this.userForm.get("username")}get password(){return this.userForm.get("password")}get roles(){return this.userForm.get("roles")}get team(){return this.userForm.get("team")}findByCriteria(s){this.users$=(0,o.of)([]);let t=Object.keys(s).filter(i=>""!=s[i]&&null!=s[i]).reduce((i,r)=>Object.assign(Object.assign({},i),{[r]:s[r]}),{});this.users$=this.getWithQuery(t),this.getPagination()}onPaginate(s){this.findByCriteria(Object.assign({page:s},this.lastSearchedParams))}}return _.\u0275fac=function(s){return new(s||_)(l.\u0275\u0275inject(c.yV),l.\u0275\u0275inject(g.D),l.\u0275\u0275inject(C.eN),l.\u0275\u0275inject(I.$),l.\u0275\u0275inject(B.jE))},_.\u0275prov=l.\u0275\u0275defineInjectable({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()}}]);