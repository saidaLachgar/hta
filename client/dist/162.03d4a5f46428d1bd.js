"use strict";(self.webpackChunkskote=self.webpackChunkskote||[]).push([[162],{6761:(A,f,e)=>{e.d(f,{l:()=>E});var d=e(1824),g=e(3405),c=e(3596),o=e(2411),O=e(6813),_=e(5686),P=e(5389),n=e(8735),u=e(1366),h=e(9204),L=e(8053),j=e(2047),m=e(8260),p=e(3668),C=e(5633),I=e(5069),B=e(8274),v=e(4522);let E=(()=>{class i extends d.c8{constructor(t,r,a,l,M){super("departments",t),this.serviceElementsFactory=t,this.confirmDialogService=r,this.MediasService=a,this.toast=l,this.http=M,this.pageSize=m.N.pageSize,this.server=m.N.serverURL,this.teamLoading=!1,this.teamInput$=new g.xQ,this.submitted=!1,this.isLoading=!1,this.FileRemoved=!1,this.page=1}findAll(){this.findByCriteria({page:1})}loadTeams(t=[]){this.teams$=(0,c.z)((0,o.of)(t),this.teamInput$.pipe((0,_.b)(500),(0,P.x)(),(0,n.h)(r=>null!=r),(0,u.b)(()=>this.teamLoading=!0),(0,h.w)(r=>this.http.get(`${this.server}/api/teams?properties[]=id&properties[]=titre&titre=`+r).pipe((0,L.U)(a=>a["hydra:member"]),(0,j.K)(()=>(0,o.of)([])),(0,u.b)(()=>this.teamLoading=!1)))))}getPagination(){this.pagination$=(0,o.of)(),this.pagination$=this.selectors$.entityActions$.pipe((0,L.U)(t=>t.payload.pagination))}deleteItem(t,r){this.confirmDialogService.setConfirmation("Vous \xeates s\xfbr de vouloir supprimer?",()=>{this.delete(t).pipe(this.toast.observe({loading:"Suppression...",success:()=>(r.closest("tr").remove(),"D\xe9part supprim\xe9 avec succ\xe8s"),error:"un probl\xe8me est survenu, veuillez r\xe9essayer"})).subscribe()})}onSearch(){this.page=1,this.lastSearchedParams=this.departmentForm.value,this.findByCriteria(Object.assign({page:1},this.lastSearchedParams))}onCreate(){let t=this.departmentForm;if(this.submitted=!0,t.invalid)return;this.submitted=!1,this.isLoading=!0;let a,r=this.toast,l=this,M=Object.entries(t.value);const R=Object.fromEntries(M.filter(([D,U])=>""!==U));a=this.selectedFile?this.MediasService.Upload(this.selectedFile[0]).pipe((0,h.w)(D=>(R.visuel=D["@id"],this.add(R)))):this.add(R),a.subscribe({error:()=>{l.isLoading=!1,r.error("un probl\xe8me est survenu, veuillez r\xe9essayer")},complete(){t.reset(),l.isLoading=!1,l.selectedFile=null,r.success("D\xe9part ajout\xe9 avec succ\xe8s")}})}onUpdate(t){let r=this.departmentForm;if(this.submitted=!0,r.invalid)return;this.submitted=!1,this.isLoading=!0;let a=this,l=this.toast,M=[],R=Object.entries(r.value);const D=Object.fromEntries(R.filter(([U,K])=>""!==K));D.id=t,!1!==this.FileRemoved&&(D.visuel=null),this.selectedFile?(this.isLoading=!0,M.push(this.MediasService.Upload(this.selectedFile[0]).pipe((0,h.w)(U=>(this.uploadedFile={id:U.id,url:U.contentUrl},this.selectedFile=null,this.FileRemoved=!1,D.visuel=U["@id"],this.update(D)))))):M.push(this.update(D)),(0,O.D)(M).subscribe({error:()=>{a.isLoading=!1,l.error("un probl\xe8me est survenu, veuillez r\xe9essayer")},complete(){!1!==a.FileRemoved?a.MediasService.delete(a.FileRemoved).subscribe(()=>{a.isLoading=!1,l.success("D\xe9part a \xe9t\xe9 mis \xe0 jour avec succ\xe8s")}):(a.isLoading=!1,l.success("D\xe9part a \xe9t\xe9 mis \xe0 jour avec succ\xe8s"))}})}get titre(){return this.departmentForm.get("titre")}get visuel(){return this.departmentForm.get("visuel")}get team(){return this.departmentForm.get("team")}findByCriteria(t){this.departments$=(0,o.of)([]);let r=Object.keys(t).filter(a=>""!=t[a]&&null!=t[a]).reduce((a,l)=>Object.assign(Object.assign({},a),{[l]:t[l]}),{});this.departments$=this.getWithQuery(r),this.getPagination()}onPaginate(t){this.findByCriteria(Object.assign({page:t},this.lastSearchedParams))}}return i.\u0275fac=function(t){return new(t||i)(p.\u0275\u0275inject(d.yV),p.\u0275\u0275inject(C.D),p.\u0275\u0275inject(I.q),p.\u0275\u0275inject(B.jE),p.\u0275\u0275inject(v.eN))},i.\u0275prov=p.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac,providedIn:"root"}),i})()},5069:(A,f,e)=>{e.d(f,{q:()=>O});var d=e(1824),g=e(8260),c=e(3668),o=e(4522);let O=(()=>{class _ extends d.c8{constructor(n,u){super("media_objects",n),this.serviceElementsFactory=n,this.http=u,this.server=g.N.serverURL}Upload(n){let u=`${this.server}/api/media_objects`,h=new FormData;return h.append("file",n,n.name),this.http.post(u,h,{reportProgress:!0,responseType:"json"}).pipe()}}return _.\u0275fac=function(n){return new(n||_)(c.\u0275\u0275inject(d.yV),c.\u0275\u0275inject(o.eN))},_.\u0275prov=c.\u0275\u0275defineInjectable({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()},6162:(A,f,e)=>{e.d(f,{Y:()=>v});var d=e(1824),g=e(3405),c=e(3596),o=e(2411),O=e(5686),_=e(5389),P=e(8735),n=e(1366),u=e(9204),h=e(2047),L=e(8053),j=e(8260),m=e(3668),p=e(5633),C=e(6761),I=e(5565),B=e(8274);let v=(()=>{class E extends d.c8{constructor(s,t,r,a,l){super("teams",s),this.serviceElementsFactory=s,this.confirmDialogService=t,this.departmentService=r,this.UserService=a,this.toast=l,this.pageSize=j.N.pageSize,this.membreLoading=!1,this.membreInput$=new g.xQ,this.departmentLoading=!1,this.departmentInput$=new g.xQ,this.submitted=!1,this.page=1}findAll(){this.findByCriteria({page:1})}loadMembers(s=[]){this.membres$=(0,c.z)((0,o.of)(s),this.membreInput$.pipe((0,O.b)(500),(0,_.x)(),(0,P.h)(t=>null!=t),(0,n.b)(()=>this.membreLoading=!0),(0,u.w)(t=>this.UserService.getWithQuery("properties[]=id&properties[]=fullName&fullName="+t).pipe((0,h.K)(()=>(0,o.of)([])),(0,n.b)(()=>this.membreLoading=!1)))))}loadDepartments(s=!0){this.departments$=s?(0,c.z)((0,o.of)([]),this.departmentInput$.pipe((0,O.b)(500),(0,_.x)(),(0,P.h)(t=>null!=t),(0,n.b)(()=>this.departmentLoading=!0),(0,u.w)(t=>this.departmentService.getWithQuery("properties[]=id&properties[]=titre&titre="+t).pipe((0,h.K)(()=>(0,o.of)([])),(0,n.b)(()=>this.departmentLoading=!1))))):this.departmentService.getWithQuery("properties[]=id&properties[]=titre")}getPagination(){this.pagination$=(0,o.of)(),this.pagination$=this.selectors$.entityActions$.pipe((0,L.U)(s=>s.payload.pagination))}deleteItem(s,t){this.confirmDialogService.setConfirmation("Vous \xeates s\xfbr de vouloir supprimer?",()=>{this.delete(s).pipe(this.toast.observe({loading:"Suppression...",success:()=>(t.closest("tr").remove(),"L'\xe9quipe supprim\xe9 avec succ\xe8s"),error:"un probl\xe8me est survenu, veuillez r\xe9essayer"})).subscribe()})}onSearch(){this.page=1,this.lastSearchedParams=this.teamForm.value,this.findByCriteria(Object.assign({page:1},this.lastSearchedParams))}onCreate(){let s=this.teamForm;if(this.submitted=!0,s.invalid)return;this.submitted=!1;let t=this.toast;this.add(s.value).subscribe({error:()=>t.error("un probl\xe8me est survenu, veuillez r\xe9essayer"),complete(){s.reset(),s.setValue({titre:[""],departments:[null],membres:[[]]}),t.success("L'\xe9quipe ajout\xe9 avec succ\xe8s")}})}onUpdate(s){let t=this.teamForm;if(this.submitted=!0,t.invalid)return;this.submitted=!1;let r=this.toast,a=Object.assign({},t.value);a.id=s,this.update(a).subscribe({error:()=>r.error("un probl\xe8me est survenu, veuillez r\xe9essayer"),complete(){r.success("L'\xe9quipe a \xe9t\xe9 mis \xe0 jour avec succ\xe8s")}})}get titre(){return this.teamForm.get("titre")}get membres(){return this.teamForm.get("membres")}get departments(){return this.teamForm.get("departments")}findByCriteria(s){this.teams$=(0,o.of)([]);let t=Object.keys(s).filter(r=>""!=s[r]&&null!=s[r]).reduce((r,a)=>Object.assign(Object.assign({},r),{[a]:s[a]}),{});this.teams$=this.getWithQuery(t),this.getPagination()}onPaginate(s){this.findByCriteria(Object.assign({page:s},this.lastSearchedParams))}}return E.\u0275fac=function(s){return new(s||E)(m.\u0275\u0275inject(d.yV),m.\u0275\u0275inject(p.D),m.\u0275\u0275inject(C.l),m.\u0275\u0275inject(I.K),m.\u0275\u0275inject(B.jE))},E.\u0275prov=m.\u0275\u0275defineInjectable({token:E,factory:E.\u0275fac,providedIn:"root"}),E})()},5565:(A,f,e)=>{e.d(f,{K:()=>B});var d=e(1824),g=e(3405),c=e(3596),o=e(2411),O=e(5686),_=e(5389),P=e(8735),n=e(1366),u=e(9204),h=e(8053),L=e(2047),j=e(8260),m=e(3668),p=e(5633),C=e(4522),I=e(8274);let B=(()=>{class v extends d.c8{constructor(i,s,t,r){super("users",i),this.serviceElementsFactory=i,this.confirmDialogService=s,this.http=t,this.toast=r,this.pageSize=j.N.pageSize,this.server=j.N.serverURL,this.teamLoading=!1,this.teamInput$=new g.xQ,this.submitted=!1,this.page=1}findAll(){this.findByCriteria({page:1})}loadTeams(i=[]){this.teams$=(0,c.z)((0,o.of)(i),this.teamInput$.pipe((0,O.b)(500),(0,_.x)(),(0,P.h)(s=>null!=s),(0,n.b)(()=>this.teamLoading=!0),(0,u.w)(s=>this.http.get(`${this.server}/api/teams?properties[]=id&properties[]=titre&titre=`+s).pipe((0,h.U)(t=>t["hydra:member"]),(0,L.K)(()=>(0,o.of)([])),(0,n.b)(()=>this.teamLoading=!1)))))}getPagination(){this.pagination$=(0,o.of)(),this.pagination$=this.selectors$.entityActions$.pipe((0,h.U)(i=>i.payload.pagination))}deleteItem(i,s){this.confirmDialogService.setConfirmation("Vous \xeates s\xfbr de vouloir supprimer?",()=>{this.delete(i).pipe(this.toast.observe({loading:"Suppression...",success:()=>(s.closest("tr").remove(),"Utilisateur supprim\xe9 avec succ\xe8s"),error:"un probl\xe8me est survenu, veuillez r\xe9essayer"})).subscribe()})}onSearch(){this.page=1,this.lastSearchedParams=this.userForm.value,this.findByCriteria(Object.assign({page:1},this.lastSearchedParams))}onCreate(){let i=this.userForm;if(this.submitted=!0,i.invalid)return;this.submitted=!1;let s=this.toast,t=Object.entries(i.value);const r=Object.fromEntries(t.filter(([a,l])=>""!==l));r.roles=[r.roles.toString()],this.add(r).subscribe({error:()=>s.error("un probl\xe8me est survenu, veuillez r\xe9essayer"),complete(){i.reset(),s.success("Utilisateur ajout\xe9 avec succ\xe8s")}})}onUpdate(i){let s=this.userForm;if(this.submitted=!0,s.invalid)return;this.submitted=!1;let t=this.toast,r=Object.assign({},s.value);r.id=i,r.roles=[r.roles.toString()],this.update(r).subscribe({error:()=>t.error("un probl\xe8me est survenu, veuillez r\xe9essayer"),complete(){t.success("L'utilisateur a \xe9t\xe9 mis \xe0 jour avec succ\xe8s")}})}get fullName(){return this.userForm.get("fullName")}get username(){return this.userForm.get("username")}get password(){return this.userForm.get("password")}get roles(){return this.userForm.get("roles")}get team(){return this.userForm.get("team")}findByCriteria(i){this.users$=(0,o.of)([]);let s=Object.keys(i).filter(t=>""!=i[t]&&null!=i[t]).reduce((t,r)=>Object.assign(Object.assign({},t),{[r]:i[r]}),{});this.users$=this.getWithQuery(s),this.getPagination()}onPaginate(i){this.findByCriteria(Object.assign({page:i},this.lastSearchedParams))}}return v.\u0275fac=function(i){return new(i||v)(m.\u0275\u0275inject(d.yV),m.\u0275\u0275inject(p.D),m.\u0275\u0275inject(C.eN),m.\u0275\u0275inject(I.jE))},v.\u0275prov=m.\u0275\u0275defineInjectable({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()}}]);