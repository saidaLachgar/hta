"use strict";
(self["webpackChunkskote"] = self["webpackChunkskote"] || []).push([["default-node_modules_ngx-ui-switch___ivy_ngcc___ui-switch_es2015_js-src_app_pages_anomalies_a-93b9d7"],{

/***/ 54247:
/*!*********************************************************************!*\
  !*** ./node_modules/ngx-ui-switch/__ivy_ngcc__/ui-switch.es2015.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "UiSwitchComponent": () => (/* binding */ UiSwitchComponent),
/* harmony export */   "UiSwitchModule": () => (/* binding */ UiSwitchModule),
/* harmony export */   "ɵa": () => (/* binding */ UI_SWITCH_OPTIONS)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 14001);
/* harmony import */ var _angular_forms__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/forms */ 18346);
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/common */ 28267);





/**
 * @fileoverview added by tsickle
 * Generated from: ui-switch/ui-switch.token.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @type {?} */



function UiSwitchComponent_label_1_Template(rf, ctx) { if (rf & 1) {
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](0, "label", 2);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](1, "span", 3);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtext"](2);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](3, "span", 4);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtext"](4);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementEnd"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementEnd"]();
} if (rf & 2) {
    const ctx_r0 = _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵnextContext"]();
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵstyleProp"]("color", ctx_r0.getColor("checkedTextColor"));
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵattribute"]("aria-label", ctx_r0.checkedLabel);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtextInterpolate"](ctx_r0.checkedLabel);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵstyleProp"]("color", ctx_r0.getColor("uncheckedTextColor"));
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵattribute"]("aria-label", ctx_r0.uncheckedLabel);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵadvance"](1);
    _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtextInterpolate"](ctx_r0.uncheckedLabel);
} }
const _c0 = ["*"];
const UI_SWITCH_OPTIONS = new _angular_core__WEBPACK_IMPORTED_MODULE_0__.InjectionToken('UI_SWITCH_OPTIONS');

/**
 * @fileoverview added by tsickle
 * Generated from: ui-switch/ui-switch.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/** @type {?} */
const UI_SWITCH_CONTROL_VALUE_ACCESSOR = {
    provide: _angular_forms__WEBPACK_IMPORTED_MODULE_1__.NG_VALUE_ACCESSOR,
    /* tslint:disable-next-line: no-use-before-declare */
    useExisting: (0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.forwardRef)((/**
     * @return {?}
     */
    () => UiSwitchComponent)),
    multi: true,
};
class UiSwitchComponent {
    /**
     * @param {?=} config
     * @param {?=} cdr
     */
    constructor(config = {}, cdr) {
        this.cdr = cdr;
        /**
         * Emits changed value
         */
        this.change = new _angular_core__WEBPACK_IMPORTED_MODULE_0__.EventEmitter();
        /**
         * Emits DOM event
         */
        this.changeEvent = new _angular_core__WEBPACK_IMPORTED_MODULE_0__.EventEmitter();
        /**
         * Emits changed value
         */
        this.valueChange = new _angular_core__WEBPACK_IMPORTED_MODULE_0__.EventEmitter();
        this.onTouchedCallback = (/**
         * @param {?} v
         * @return {?}
         */
        (v) => { });
        this.onChangeCallback = (/**
         * @param {?} v
         * @return {?}
         */
        (v) => { });
        this.size = (config && config.size) || 'medium';
        this.color = config && config.color;
        this.switchOffColor = config && config.switchOffColor;
        this.switchColor = config && config.switchColor;
        this.defaultBgColor = config && config.defaultBgColor;
        this.defaultBoColor = config && config.defaultBoColor;
        this.checkedLabel = config && config.checkedLabel;
        this.uncheckedLabel = config && config.uncheckedLabel;
        this.checkedTextColor = config && config.checkedTextColor;
        this.uncheckedTextColor = config && config.uncheckedTextColor;
    }
    /**
     * @param {?} v
     * @return {?}
     */
    set checked(v) {
        this._checked = v !== false;
    }
    /**
     * @return {?}
     */
    get checked() {
        return this._checked;
    }
    /**
     * @param {?} v
     * @return {?}
     */
    set disabled(v) {
        this._disabled = v !== false;
    }
    /**
     * @return {?}
     */
    get disabled() {
        return this._disabled;
    }
    /**
     * @param {?} v
     * @return {?}
     */
    set reverse(v) {
        this._reverse = v !== false;
    }
    /**
     * @return {?}
     */
    get reverse() {
        return this._reverse;
    }
    /**
     * @param {?} v
     * @return {?}
     */
    set loading(v) {
        this._loading = v !== false;
    }
    /**
     * @return {?}
     */
    get loading() {
        return this._loading;
    }
    /**
     * @param {?=} flag
     * @return {?}
     */
    getColor(flag = '') {
        if (flag === 'borderColor') {
            return this.defaultBoColor;
        }
        if (flag === 'switchColor') {
            if (this.reverse) {
                return !this.checked ? this.switchColor : this.switchOffColor || this.switchColor;
            }
            return this.checked ? this.switchColor : this.switchOffColor || this.switchColor;
        }
        if (flag === 'checkedTextColor') {
            return this.reverse ? this.uncheckedTextColor : this.checkedTextColor;
        }
        if (flag === 'uncheckedTextColor') {
            return this.reverse ? this.checkedTextColor : this.uncheckedTextColor;
        }
        if (this.reverse) {
            return !this.checked ? this.color : this.defaultBgColor;
        }
        return this.checked ? this.color : this.defaultBgColor;
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onClick(event) {
        if (this.disabled) {
            return;
        }
        this.checked = !this.checked;
        // Component events
        this.change.emit(this.checked);
        this.valueChange.emit(this.checked);
        this.changeEvent.emit(event);
        // value accessor callbacks
        this.onChangeCallback(this.checked);
        this.onTouchedCallback(this.checked);
        this.cdr.markForCheck();
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onToggle(event) {
        if (this.disabled) {
            return;
        }
        if (this.beforeChange) {
            this._beforeChange = this.beforeChange.subscribe((/**
             * @param {?} confirm
             * @return {?}
             */
            (confirm) => {
                if (confirm) {
                    this.onClick(event);
                }
            }));
        }
        else {
            this.onClick(event);
        }
    }
    /**
     * @param {?} obj
     * @return {?}
     */
    writeValue(obj) {
        if (obj !== this.checked) {
            this.checked = !!obj;
        }
        this.onChangeCallback(this.checked);
        if (this.cdr) {
            this.cdr.markForCheck();
        }
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnChange(fn) {
        this.onChangeCallback = fn;
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnTouched(fn) {
        this.onTouchedCallback = fn;
    }
    /**
     * @param {?} isDisabled
     * @return {?}
     */
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        if (this._beforeChange) {
            this._beforeChange.unsubscribe();
        }
    }
}
UiSwitchComponent.ɵfac = function UiSwitchComponent_Factory(t) { return new (t || UiSwitchComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdirectiveInject"](UI_SWITCH_OPTIONS, 8), _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdirectiveInject"](_angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectorRef)); };
UiSwitchComponent.ɵcmp = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineComponent"]({ type: UiSwitchComponent, selectors: [["ui-switch"]], hostBindings: function UiSwitchComponent_HostBindings(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵlistener"]("click", function UiSwitchComponent_click_HostBindingHandler($event) { return ctx.onToggle($event); });
    } }, inputs: { size: "size", color: "color", switchOffColor: "switchOffColor", switchColor: "switchColor", defaultBgColor: "defaultBgColor", defaultBoColor: "defaultBoColor", checkedLabel: "checkedLabel", uncheckedLabel: "uncheckedLabel", checkedTextColor: "checkedTextColor", uncheckedTextColor: "uncheckedTextColor", checked: "checked", disabled: "disabled", reverse: "reverse", loading: "loading", beforeChange: "beforeChange" }, outputs: { change: "change", changeEvent: "changeEvent", valueChange: "valueChange" }, features: [_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵProvidersFeature"]([UI_SWITCH_CONTROL_VALUE_ACCESSOR])], ngContentSelectors: _c0, decls: 4, vars: 20, consts: [["type", "button", "role", "switch", 1, "switch"], ["class", "switch-pane", 4, "ngIf"], [1, "switch-pane"], [1, "switch-label-checked"], [1, "switch-label-unchecked"]], template: function UiSwitchComponent_Template(rf, ctx) { if (rf & 1) {
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵprojectionDef"]();
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](0, "button", 0);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵtemplate"](1, UiSwitchComponent_label_1_Template, 5, 8, "label", 1);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementStart"](2, "small");
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵprojection"](3);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementEnd"]();
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵelementEnd"]();
    } if (rf & 2) {
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵstyleProp"]("background-color", ctx.getColor())("border-color", ctx.getColor("borderColor"));
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵclassProp"]("checked", ctx.checked)("disabled", ctx.disabled)("loading", ctx.loading)("switch-large", ctx.size === "large")("switch-medium", ctx.size === "medium")("switch-small", ctx.size === "small");
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵattribute"]("aria-checked", ctx.checked);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵproperty"]("ngIf", ctx.checkedLabel || ctx.uncheckedLabel);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵadvance"](1);
        _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵstyleProp"]("background", ctx.getColor("switchColor"));
    } }, directives: [_angular_common__WEBPACK_IMPORTED_MODULE_2__.NgIf], encapsulation: 2 });
/** @nocollapse */
UiSwitchComponent.ctorParameters = () => [
    { type: undefined, decorators: [{ type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Inject, args: [UI_SWITCH_OPTIONS,] }, { type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Optional }] },
    { type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectorRef }
];
UiSwitchComponent.propDecorators = {
    size: [{ type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input }],
    color: [{ type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input }],
    switchOffColor: [{ type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input }],
    switchColor: [{ type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input }],
    defaultBgColor: [{ type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input }],
    defaultBoColor: [{ type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input }],
    checkedLabel: [{ type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input }],
    uncheckedLabel: [{ type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input }],
    checkedTextColor: [{ type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input }],
    uncheckedTextColor: [{ type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input }],
    beforeChange: [{ type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input }],
    checked: [{ type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input }],
    disabled: [{ type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input }],
    reverse: [{ type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input }],
    loading: [{ type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input }],
    change: [{ type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Output }],
    changeEvent: [{ type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Output }],
    valueChange: [{ type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Output }],
    onToggle: [{ type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.HostListener, args: ['click', ['$event'],] }]
};
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵsetClassMetadata"](UiSwitchComponent, [{
        type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Component,
        args: [{
                selector: 'ui-switch',
                template: "<button\n  type=\"button\"\n  class=\"switch\"\n  role=\"switch\"\n  [attr.aria-checked]=\"checked\"\n  [class.checked]=\"checked\"\n  [class.disabled]=\"disabled\"\n  [class.loading]=\"loading\"\n  [class.switch-large]=\"size === 'large'\"\n  [class.switch-medium]=\"size === 'medium'\"\n  [class.switch-small]=\"size === 'small'\"\n  [style.background-color]=\"getColor()\"\n  [style.border-color]=\"getColor('borderColor')\"\n>\n  <label class=\"switch-pane\" *ngIf=\"checkedLabel || uncheckedLabel\">\n    <span\n      [attr.aria-label]=\"this.checkedLabel\"\n      class=\"switch-label-checked\"\n      [style.color]=\"getColor('checkedTextColor')\"\n      >{{ this.checkedLabel }}</span\n    >\n    <span\n      [attr.aria-label]=\"this.uncheckedLabel\"\n      class=\"switch-label-unchecked\"\n      [style.color]=\"getColor('uncheckedTextColor')\"\n      >{{ this.uncheckedLabel }}</span\n    >\n  </label>\n  <small [style.background]=\"getColor('switchColor')\">\n    <ng-content></ng-content>\n  </small>\n</button>\n",
                providers: [UI_SWITCH_CONTROL_VALUE_ACCESSOR]
            }]
    }], function () { return [{ type: undefined, decorators: [{
                type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Inject,
                args: [UI_SWITCH_OPTIONS]
            }, {
                type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Optional
            }] }, { type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.ChangeDetectorRef }]; }, { change: [{
            type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Output
        }], changeEvent: [{
            type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Output
        }], valueChange: [{
            type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Output
        }], size: [{
            type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input
        }], color: [{
            type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input
        }], switchOffColor: [{
            type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input
        }], switchColor: [{
            type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input
        }], defaultBgColor: [{
            type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input
        }], defaultBoColor: [{
            type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input
        }], checkedLabel: [{
            type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input
        }], uncheckedLabel: [{
            type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input
        }], checkedTextColor: [{
            type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input
        }], uncheckedTextColor: [{
            type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input
        }], checked: [{
            type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input
        }], disabled: [{
            type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input
        }], reverse: [{
            type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input
        }], loading: [{
            type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input
        }], 
    /**
     * @param {?} event
     * @return {?}
     */
    onToggle: [{
            type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.HostListener,
            args: ['click', ['$event']]
        }], beforeChange: [{
            type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Input
        }] }); })();

/**
 * @fileoverview added by tsickle
 * Generated from: ui-switch/ui-switch.module.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
class UiSwitchModule {
    /**
     * @param {?} config
     * @return {?}
     */
    static forRoot(config) {
        return {
            ngModule: UiSwitchModule,
            providers: [{ provide: UI_SWITCH_OPTIONS, useValue: config || {} }],
        };
    }
}
UiSwitchModule.ɵfac = function UiSwitchModule_Factory(t) { return new (t || UiSwitchModule)(); };
UiSwitchModule.ɵmod = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineNgModule"]({ type: UiSwitchModule });
UiSwitchModule.ɵinj = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineInjector"]({ imports: [[_angular_common__WEBPACK_IMPORTED_MODULE_2__.CommonModule, _angular_forms__WEBPACK_IMPORTED_MODULE_1__.FormsModule], _angular_forms__WEBPACK_IMPORTED_MODULE_1__.FormsModule] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵsetClassMetadata"](UiSwitchModule, [{
        type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.NgModule,
        args: [{
                declarations: [UiSwitchComponent],
                imports: [_angular_common__WEBPACK_IMPORTED_MODULE_2__.CommonModule, _angular_forms__WEBPACK_IMPORTED_MODULE_1__.FormsModule],
                exports: [_angular_forms__WEBPACK_IMPORTED_MODULE_1__.FormsModule, UiSwitchComponent]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵsetNgModuleScope"](UiSwitchModule, { declarations: function () { return [UiSwitchComponent]; }, imports: function () { return [_angular_common__WEBPACK_IMPORTED_MODULE_2__.CommonModule, _angular_forms__WEBPACK_IMPORTED_MODULE_1__.FormsModule]; }, exports: function () { return [_angular_forms__WEBPACK_IMPORTED_MODULE_1__.FormsModule, UiSwitchComponent]; } }); })();

/**
 * @fileoverview added by tsickle
 * Generated from: public_api.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * Generated from: index.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/**
 * Generated bundle index. Do not edit.
 */





/***/ }),

/***/ 81728:
/*!*********************************************!*\
  !*** ./src/app/core/models/access.model.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ 24435:
/*!**********************************************!*\
  !*** ./src/app/core/models/anomaly.model.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SEVERITY_OPTIONS": () => (/* binding */ SEVERITY_OPTIONS)
/* harmony export */ });
const SEVERITY_OPTIONS = [
    { label: 'Urgent < mois', value: 'ELEVE', color: 'danger' },
    { label: 'Court terme < 1an', value: 'FAIBLE', color: 'warning' },
    { label: 'Faible terme > 1an', value: 'NORMAL', color: 'success' },
    { label: 'Autre', value: 'OTHER', color: 'info' },
];


/***/ }),

/***/ 63718:
/*!**********************************************!*\
  !*** ./src/app/core/models/commune.model.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ 55796:
/*!*************************************************!*\
  !*** ./src/app/core/models/department.model.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ 40786:
/*!******************************************!*\
  !*** ./src/app/core/models/dps.model.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ 62573:
/*!*******************************************!*\
  !*** ./src/app/core/models/edge.model.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ 26485:
/*!*************************************************!*\
  !*** ./src/app/core/models/goal-group.model.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ 48297:
/*!*******************************************!*\
  !*** ./src/app/core/models/goal.model.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ 83084:
/*!**************************************!*\
  !*** ./src/app/core/models/index.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CausesList": () => (/* reexport safe */ _mission_model__WEBPACK_IMPORTED_MODULE_7__.CausesList),
/* harmony export */   "SEVERITY_OPTIONS": () => (/* reexport safe */ _anomaly_model__WEBPACK_IMPORTED_MODULE_8__.SEVERITY_OPTIONS)
/* harmony export */ });
/* harmony import */ var _dps_model__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dps.model */ 40786);
/* harmony import */ var _team_model__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./team.model */ 96593);
/* harmony import */ var _department_model__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./department.model */ 55796);
/* harmony import */ var _commune_model__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./commune.model */ 63718);
/* harmony import */ var _edge_model__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./edge.model */ 62573);
/* harmony import */ var _node_model__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./node.model */ 36998);
/* harmony import */ var _poste_model__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./poste.model */ 62840);
/* harmony import */ var _mission_model__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./mission.model */ 3973);
/* harmony import */ var _anomaly_model__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./anomaly.model */ 24435);
/* harmony import */ var _visite_model__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./visite.model */ 85433);
/* harmony import */ var _objective_model__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./objective.model */ 21584);
/* harmony import */ var _goal_model__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./goal.model */ 48297);
/* harmony import */ var _goal_group_model__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./goal-group.model */ 26485);
/* harmony import */ var _pagination_model__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./pagination.model */ 74751);
/* harmony import */ var _menu_model__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./menu.model */ 26605);
/* harmony import */ var _media_model__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./media.model */ 86307);
/* harmony import */ var _access_model__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./access.model */ 81728);
/* harmony import */ var _user_model__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./user.model */ 80956);
/* harmony import */ var _log_model__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./log.model */ 5372);





















/***/ }),

/***/ 5372:
/*!******************************************!*\
  !*** ./src/app/core/models/log.model.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ 86307:
/*!********************************************!*\
  !*** ./src/app/core/models/media.model.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ 26605:
/*!*******************************************!*\
  !*** ./src/app/core/models/menu.model.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ 3973:
/*!**********************************************!*\
  !*** ./src/app/core/models/mission.model.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CausesList": () => (/* binding */ CausesList)
/* harmony export */ });
var CausesList;
(function (CausesList) {
    CausesList[CausesList["D\u00E9fauts mat\u00E9riels"] = 0] = "D\u00E9fauts mat\u00E9riels";
    CausesList[CausesList["Telescopare"] = 1] = "Telescopare";
    CausesList[CausesList["Intenpaire"] = 2] = "Intenpaire";
    CausesList[CausesList["Cause inconnue"] = 3] = "Cause inconnue";
})(CausesList || (CausesList = {}));
;


/***/ }),

/***/ 36998:
/*!*******************************************!*\
  !*** ./src/app/core/models/node.model.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ 21584:
/*!************************************************!*\
  !*** ./src/app/core/models/objective.model.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ 74751:
/*!*************************************************!*\
  !*** ./src/app/core/models/pagination.model.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ 62840:
/*!********************************************!*\
  !*** ./src/app/core/models/poste.model.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ 96593:
/*!*******************************************!*\
  !*** ./src/app/core/models/team.model.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ 80956:
/*!*******************************************!*\
  !*** ./src/app/core/models/user.model.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ 85433:
/*!*********************************************!*\
  !*** ./src/app/core/models/visite.model.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ 24038:
/*!****************************************************!*\
  !*** ./src/app/pages/anomalies/anomaly.service.ts ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "anomalyService": () => (/* binding */ anomalyService)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! tslib */ 98806);
/* harmony import */ var _ngrx_data__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @ngrx/data */ 97544);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! rxjs */ 64008);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! rxjs */ 41119);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! rxjs */ 81220);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! rxjs */ 18252);
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! rxjs/operators */ 9820);
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! rxjs/operators */ 98785);
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! rxjs/operators */ 48027);
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! rxjs/operators */ 85029);
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! rxjs/operators */ 29026);
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! rxjs/operators */ 10592);
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! rxjs/operators */ 88377);
/* harmony import */ var src_app_core_models__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! src/app/core/models */ 83084);
/* harmony import */ var src_environments_environment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! src/environments/environment */ 18260);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! @angular/core */ 14001);
/* harmony import */ var src_app_shared_components_confirm_dialog_confirm_dialog_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! src/app/shared/components/confirm-dialog/confirm-dialog.service */ 7393);
/* harmony import */ var _departments_department_service__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../departments/department.service */ 66761);
/* harmony import */ var _communes_commune_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../communes/commune.service */ 87777);
/* harmony import */ var _edges_edge_service__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../edges/edge.service */ 44885);
/* harmony import */ var _users_user_service__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../users/user.service */ 95565);
/* harmony import */ var _angular_common_http__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! @angular/common/http */ 83981);
/* harmony import */ var _ngneat_hot_toast__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! @ngneat/hot-toast */ 82456);















const formatDate = (date) => date !== "" ? date.year + "-" + date.month + "-" + ("0" + date.day).slice(-2) : "";
class anomalyService extends _ngrx_data__WEBPACK_IMPORTED_MODULE_7__.EntityCollectionServiceBase {
    constructor(serviceElementsFactory, confirmDialogService, departmentService, communeService, edgeService, userService, http, toast) {
        super("anomalies", serviceElementsFactory);
        this.serviceElementsFactory = serviceElementsFactory;
        this.confirmDialogService = confirmDialogService;
        this.departmentService = departmentService;
        this.communeService = communeService;
        this.edgeService = edgeService;
        this.userService = userService;
        this.http = http;
        this.toast = toast;
        this.pageSize = src_environments_environment__WEBPACK_IMPORTED_MODULE_1__.environment.pageSize;
        this.server = src_environments_environment__WEBPACK_IMPORTED_MODULE_1__.environment.serverURL;
        this.severityOptions = src_app_core_models__WEBPACK_IMPORTED_MODULE_0__.SEVERITY_OPTIONS;
        this.departmentLoading = false;
        this.departmentInput$ = new rxjs__WEBPACK_IMPORTED_MODULE_8__.Subject();
        this.usersLoading = false;
        this.usersInput$ = new rxjs__WEBPACK_IMPORTED_MODULE_8__.Subject();
        this.edgesInRange$ = new rxjs__WEBPACK_IMPORTED_MODULE_9__.BehaviorSubject([]);
        this.edgesLoading = false;
        this.edgesInput$ = new rxjs__WEBPACK_IMPORTED_MODULE_8__.Subject();
        this.submitted = false;
        this.statusLoading = 0;
        this.page = 1;
    }
    /**
     * Get records
     */
    findAll() {
        this.findByCriteria({ page: 1 });
    }
    loadDepartments(byTerm = true) {
        if (byTerm) {
            this.departments$ = (0,rxjs__WEBPACK_IMPORTED_MODULE_10__.concat)((0,rxjs__WEBPACK_IMPORTED_MODULE_11__.of)([]), // default items
            this.departmentInput$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.debounceTime)(500), (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.distinctUntilChanged)(), (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_14__.filter)((val) => val != null), (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.tap)(() => this.departmentLoading = true), (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_16__.switchMap)(term => this.departmentService.getWithQuery("properties[]=id&properties[]=titre&titre=" + term).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_17__.catchError)(() => (0,rxjs__WEBPACK_IMPORTED_MODULE_11__.of)([])), // empty list on error
            (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.tap)(() => this.departmentLoading = false)))));
        }
        else {
            this.departments$ = this.departmentService.getWithQuery("properties[]=id&properties[]=titre");
        }
    }
    loadUsers(defaultVal = []) {
        this.users$ = (0,rxjs__WEBPACK_IMPORTED_MODULE_10__.concat)((0,rxjs__WEBPACK_IMPORTED_MODULE_11__.of)(defaultVal), // default items
        this.usersInput$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.debounceTime)(500), (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.distinctUntilChanged)(), (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_14__.filter)((val) => val != null), (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.tap)(() => this.usersLoading = true), (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_16__.switchMap)(term => this.userService.getWithQuery("properties[]=id&properties[]=fullName&fullName=" + term).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_17__.catchError)(() => (0,rxjs__WEBPACK_IMPORTED_MODULE_11__.of)([])), // empty list on error
        (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.tap)(() => this.usersLoading = false)))));
    }
    loadEdgesInRange(range, edgesInRange) {
        let obj = Object.assign({}, range);
        obj["id[]"] = edgesInRange;
        obj["properties[]"] = "id";
        obj["properties[node_a][]"] = "titre";
        obj["properties[node_b][]"] = "titre";
        delete obj.node_a;
        obj.node_b && delete obj.node_b;
        this.edgeService.getWithQuery(obj).subscribe(edges => {
            this.edgesInRange$.next(edges);
        });
    }
    loadEdgesByDepar($event) {
        this.edge.reset();
        this.edgesInRange$.next([]);
        this.edgeService.getWithQuery(`properties[]=id&properties[]=node_a&properties[]=node_b&itemsPerPage=1000&department.id=` + $event.match(/\d+/)[0]).subscribe(edges => {
            this.edgesInRange$.next(edges);
        });
    }
    /**
     * Get pagination
     */
    getPagination() {
        this.pagination$ = (0,rxjs__WEBPACK_IMPORTED_MODULE_11__.of)(); // reset pagination
        // console.log("getPagination")
        this.pagination$ = this.selectors$.entityActions$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_18__.map)(action => action.payload.pagination));
    }
    /**
     * Delete item
     * @param id anomaly id
     * @param target html element
     */
    deleteItem(id, target) {
        this.confirmDialogService.setConfirmation("Vous êtes sûr de vouloir supprimer?", () => {
            this.delete(id)
                .pipe(this.toast.observe({
                loading: "Suppression...",
                success: () => {
                    target.closest("tr").remove();
                    return "Anomaly supprimé avec succès";
                },
                error: "un problème est survenu, veuillez réessayer",
            }))
                .subscribe();
        });
    }
    /**
     * Search
     */
    onSearch() {
        this.page = 1;
        this.lastSearchedParams = this.anomalyForm.value;
        this.findByCriteria(Object.assign({ page: 1 }, this.lastSearchedParams));
    }
    /**
     * Persist : Create
     */
    onCreate() {
        let anomalyForm = this.anomalyForm;
        this.submitted = true;
        if (anomalyForm.invalid)
            return;
        this.submitted = false;
        let toast = this.toast;
        let obj = Object.entries(anomalyForm.value);
        // remove empty values
        const anomaly = Object.fromEntries(obj.filter(([key, value]) => value !== ""));
        this.add(anomaly).subscribe({
            error: () => toast.error("un problème est survenu, veuillez réessayer"),
            complete() {
                anomalyForm.reset();
                toast.success("Anomaly ajouté avec succès");
            },
        });
    }
    /**
     * Persist : update
     */
    onUpdate(id) {
        let anomalyForm = this.anomalyForm;
        this.submitted = true;
        if (anomalyForm.invalid)
            return;
        this.submitted = false;
        let toast = this.toast;
        let obj = Object.entries(anomalyForm.value);
        // remove empty values
        const anomaly = Object.fromEntries(obj.filter(([key, value]) => value !== ""));
        anomaly.id = id;
        this.update(anomaly).subscribe({
            error: () => toast.error("un problème est survenu, veuillez réessayer"),
            complete() {
                toast.success("Anomaly a été mis à jour avec succès");
            },
        });
    }
    updateStatus($event, id) {
        $event.stopPropagation();
        let _this = this;
        let checked = !$event.target.classList.contains("checked");
        let anomaly = { id: id, status: checked };
        this.statusLoading = id;
        this.update(anomaly).subscribe({
            error: () => _this.toast.error("un problème est survenu, veuillez réessayer"),
            complete() {
                _this.statusLoading = 0;
                _this.toast.success("Statut a été mis à jour avec succès");
            },
        });
    }
    bulkCreate(anomalies) {
        return this.http.post(`${this.server}/api/anomalies/bulk?action=create`, { anomalies: anomalies });
    }
    // get edges and anomalies of current mission range
    getRelatedAnomalies(anode, bnode, depar) {
        anode && anode.trim() !== '' && this.findByCriteria(Object.assign(Object.assign({ page: 1, "status[]": [false, null] }, { node_a: anode.match(/\d+/)[0], depar: depar.match(/\d+/)[0] }), (bnode && bnode.length !== 0 && { node_b: bnode.map((node) => node.match(/\d+/)[0]) })));
    }
    /**
     * find By Criteria
     * @param obj query parameters
     */
    findByCriteria(obj) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_19__.__awaiter)(this, void 0, void 0, function* () {
            this.anomalies$ = (0,rxjs__WEBPACK_IMPORTED_MODULE_11__.of)([]); // clear table
            if (Object.keys(obj).length > 1) {
                // format date
                const updateObj = (key) => obj[key] && delete Object.assign(obj, { ["createdAt[" + key + "]"]: formatDate(obj[key]) })[key];
                updateObj("before");
                updateObj("after");
                // get anomalies of node range
                if (obj.node_a) {
                    // get edges as an array then add edge.id[] to the object
                    let edgesInRange = yield this.edgeService.getEdgesInRange(obj.depar, obj.node_a, obj.node_b ? obj.node_b : null).toPromise();
                    // get edges of current mission range
                    this.loadEdgesInRange(obj, edgesInRange);
                    obj["edge.id[]"] = edgesInRange;
                    delete obj.node_a;
                    obj.node_b && delete obj.node_b;
                }
            }
            // remove empty values
            let queryParams = Object.keys(obj)
                .filter((k) => obj[k] != "" && obj[k] != null)
                .reduce((a, k) => (Object.assign(Object.assign({}, a), { [k]: obj[k] })), {});
            this.anomalies$ = this.getWithQuery(queryParams);
            this.getPagination();
        });
    }
    /**
     * on Paginate
     * @param page page to search for
     */
    onPaginate(page) {
        this.findByCriteria(Object.assign({ page: page }, this.lastSearchedParams));
    }
    getSeverity(value, color) {
        const severity = this.severityOptions.find(option => option.value === value);
        return severity ? (color ? severity.color : severity.label) : '';
    }
    get department() {
        return this.anomalyForm.get("department");
    }
    get title() {
        return this.anomalyForm.get("title");
    }
    get edge() {
        return this.anomalyForm.get("edge");
    }
}
anomalyService.ɵfac = function anomalyService_Factory(t) { return new (t || anomalyService)(_angular_core__WEBPACK_IMPORTED_MODULE_20__["ɵɵinject"](_ngrx_data__WEBPACK_IMPORTED_MODULE_7__.EntityCollectionServiceElementsFactory), _angular_core__WEBPACK_IMPORTED_MODULE_20__["ɵɵinject"](src_app_shared_components_confirm_dialog_confirm_dialog_service__WEBPACK_IMPORTED_MODULE_2__.ConfirmDialogService), _angular_core__WEBPACK_IMPORTED_MODULE_20__["ɵɵinject"](_departments_department_service__WEBPACK_IMPORTED_MODULE_3__.departmentService), _angular_core__WEBPACK_IMPORTED_MODULE_20__["ɵɵinject"](_communes_commune_service__WEBPACK_IMPORTED_MODULE_4__.communeService), _angular_core__WEBPACK_IMPORTED_MODULE_20__["ɵɵinject"](_edges_edge_service__WEBPACK_IMPORTED_MODULE_5__.edgeService), _angular_core__WEBPACK_IMPORTED_MODULE_20__["ɵɵinject"](_users_user_service__WEBPACK_IMPORTED_MODULE_6__.UserService), _angular_core__WEBPACK_IMPORTED_MODULE_20__["ɵɵinject"](_angular_common_http__WEBPACK_IMPORTED_MODULE_21__.HttpClient), _angular_core__WEBPACK_IMPORTED_MODULE_20__["ɵɵinject"](_ngneat_hot_toast__WEBPACK_IMPORTED_MODULE_22__.HotToastService)); };
anomalyService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_20__["ɵɵdefineInjectable"]({ token: anomalyService, factory: anomalyService.ɵfac, providedIn: "root" });


/***/ }),

/***/ 95565:
/*!*********************************************!*\
  !*** ./src/app/pages/users/user.service.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "UserService": () => (/* binding */ UserService)
/* harmony export */ });
/* harmony import */ var _ngrx_data__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @ngrx/data */ 97544);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! rxjs */ 64008);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! rxjs */ 81220);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! rxjs */ 18252);
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! rxjs/operators */ 9820);
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! rxjs/operators */ 98785);
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! rxjs/operators */ 48027);
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! rxjs/operators */ 85029);
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! rxjs/operators */ 29026);
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! rxjs/operators */ 88377);
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! rxjs/operators */ 10592);
/* harmony import */ var src_environments_environment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! src/environments/environment */ 18260);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @angular/core */ 14001);
/* harmony import */ var src_app_shared_components_confirm_dialog_confirm_dialog_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! src/app/shared/components/confirm-dialog/confirm-dialog.service */ 7393);
/* harmony import */ var _angular_common_http__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @angular/common/http */ 83981);
/* harmony import */ var src_app_core_services_auth_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! src/app/core/services/auth.service */ 67686);
/* harmony import */ var _ngneat_hot_toast__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @ngneat/hot-toast */ 82456);










class UserService extends _ngrx_data__WEBPACK_IMPORTED_MODULE_3__.EntityCollectionServiceBase {
    constructor(serviceElementsFactory, confirmDialogService, http, authService, toast) {
        super("users", serviceElementsFactory);
        this.serviceElementsFactory = serviceElementsFactory;
        this.confirmDialogService = confirmDialogService;
        this.http = http;
        this.authService = authService;
        this.toast = toast;
        this.pageSize = src_environments_environment__WEBPACK_IMPORTED_MODULE_0__.environment.pageSize;
        this.server = src_environments_environment__WEBPACK_IMPORTED_MODULE_0__.environment.serverURL;
        this.teamLoading = false;
        this.teamInput$ = new rxjs__WEBPACK_IMPORTED_MODULE_4__.Subject();
        this.submitted = false;
        this.loading = false;
        this.page = 1;
    }
    /**
     * Get records
     */
    findAll() {
        this.findByCriteria({ page: 1 });
    }
    loadTeams(defaultVal = []) {
        this.teams$ = (0,rxjs__WEBPACK_IMPORTED_MODULE_5__.concat)((0,rxjs__WEBPACK_IMPORTED_MODULE_6__.of)(defaultVal), // default items
        this.teamInput$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.debounceTime)(500), (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.distinctUntilChanged)(), (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_9__.filter)((val) => val != null), (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_10__.tap)(() => this.teamLoading = true), (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.switchMap)(term => this.http.get(`${this.server}/api/teams?properties[]=id&properties[]=titre&titre=` + term)
            .pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.map)(response => response["hydra:member"]), (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.catchError)(() => (0,rxjs__WEBPACK_IMPORTED_MODULE_6__.of)([])), // empty list on error
        (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_10__.tap)(() => this.teamLoading = false)))));
    }
    /**
     * Get pagination
     */
    getPagination() {
        this.pagination$ = (0,rxjs__WEBPACK_IMPORTED_MODULE_6__.of)(); // reset pagination
        // console.log("getPagination")
        this.pagination$ = this.selectors$.entityActions$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.map)(action => action.payload.pagination));
    }
    /**
     * Delete item
     * @param id user id
     * @param target html element
     */
    deleteItem(id, target) {
        this.confirmDialogService.setConfirmation("Vous êtes sûr de vouloir supprimer?", () => {
            this.delete(id)
                .pipe(this.toast.observe({
                loading: "Suppression...",
                success: () => {
                    target.closest("tr").remove();
                    return "Utilisateur supprimé avec succès";
                },
                error: "un problème est survenu, veuillez réessayer",
            }))
                .subscribe();
        });
    }
    /**
     * Search
     */
    onSearch() {
        this.page = 1;
        this.lastSearchedParams = this.userForm.value;
        this.findByCriteria(Object.assign({ page: 1 }, this.lastSearchedParams));
    }
    /**
     * Persist : Create
     */
    onCreate() {
        let userForm = this.userForm;
        this.submitted = true;
        if (userForm.invalid)
            return;
        this.submitted = false;
        let toast = this.toast;
        let obj = Object.entries(userForm.value);
        // remove empty values
        const user = Object.fromEntries(obj.filter(([key, value]) => value !== ""));
        user.roles = [user.roles.toString()];
        this.add(user).subscribe({
            error: () => toast.error("un problème est survenu, veuillez réessayer"),
            complete() {
                userForm.reset();
                toast.success("Utilisateur ajouté avec succès");
            },
        });
    }
    /**
     * Persist : update
     */
    onUpdate(id, ignoreEmpty = false) {
        let userForm = this.userForm;
        this.submitted = true;
        if (userForm.invalid)
            return;
        this.submitted = false;
        let that = this;
        let toast = this.toast;
        let currentUser = this.authService.user;
        let user = Object.assign({}, userForm.value);
        user.id = id;
        if (ignoreEmpty) {
            user = Object.entries(user).reduce((acc, [key, value]) => {
                if (value !== "" && value !== null) {
                    acc[key] = value;
                }
                return acc;
            }, {});
        }
        else {
            user.roles = [user.roles.toString()];
        }
        this.update(user).subscribe({
            error: () => toast.error("un problème est survenu, veuillez réessayer"),
            complete() {
                if (currentUser.id == id) {
                    that.loading = true;
                    that.authService.logout(false);
                    that.authService.login(user.username, user.password)
                        .subscribe({
                        error: (error) => {
                            error && toast.error(error.error.message);
                            that.loading = false;
                        },
                        complete() {
                            that.loading = false;
                            toast.success("L'utilisateur a été mis à jour avec succès");
                            setTimeout(() => window.location.reload(), 10);
                        },
                    });
                }
                else {
                    toast.success("L'utilisateur a été mis à jour avec succès");
                }
            },
        });
    }
    get fullName() {
        return this.userForm.get("fullName");
    }
    get username() {
        return this.userForm.get("username");
    }
    get password() {
        return this.userForm.get("password");
    }
    get roles() {
        return this.userForm.get("roles");
    }
    get team() {
        return this.userForm.get("team");
    }
    /**
     * find By Criteria
     * @param obj query parameters
     */
    findByCriteria(obj) {
        this.users$ = (0,rxjs__WEBPACK_IMPORTED_MODULE_6__.of)([]); // clear table
        // remove empty values
        let queryParams = Object.keys(obj)
            .filter((k) => obj[k] != "" && obj[k] != null)
            .reduce((a, k) => (Object.assign(Object.assign({}, a), { [k]: obj[k] })), {});
        this.users$ = this.getWithQuery(queryParams);
        this.getPagination();
    }
    /**
     * on Paginate
     * @param page page to search for
     */
    onPaginate(page) {
        this.findByCriteria(Object.assign({ page: page }, this.lastSearchedParams));
    }
}
UserService.ɵfac = function UserService_Factory(t) { return new (t || UserService)(_angular_core__WEBPACK_IMPORTED_MODULE_14__["ɵɵinject"](_ngrx_data__WEBPACK_IMPORTED_MODULE_3__.EntityCollectionServiceElementsFactory), _angular_core__WEBPACK_IMPORTED_MODULE_14__["ɵɵinject"](src_app_shared_components_confirm_dialog_confirm_dialog_service__WEBPACK_IMPORTED_MODULE_1__.ConfirmDialogService), _angular_core__WEBPACK_IMPORTED_MODULE_14__["ɵɵinject"](_angular_common_http__WEBPACK_IMPORTED_MODULE_15__.HttpClient), _angular_core__WEBPACK_IMPORTED_MODULE_14__["ɵɵinject"](src_app_core_services_auth_service__WEBPACK_IMPORTED_MODULE_2__.AuthenticationService), _angular_core__WEBPACK_IMPORTED_MODULE_14__["ɵɵinject"](_ngneat_hot_toast__WEBPACK_IMPORTED_MODULE_16__.HotToastService)); };
UserService.ɵprov = /*@__PURE__*/ _angular_core__WEBPACK_IMPORTED_MODULE_14__["ɵɵdefineInjectable"]({ token: UserService, factory: UserService.ɵfac, providedIn: "root" });


/***/ })

}]);
//# sourceMappingURL=default-node_modules_ngx-ui-switch___ivy_ngcc___ui-switch_es2015_js-src_app_pages_anomalies_a-93b9d7.js.map