"use strict";(self.webpackChunkskote=self.webpackChunkskote||[]).push([[208],{9167:(B,L,e)=>{e.d(L,{p:()=>c});var t=e(3668),E=e(7317),f=e(7686);let c=(()=>{class u{constructor(v,r){this.router=v,this.authService=r}canActivate(v,r){return!!this.authService.isAuthorized(v.data.access)||(alert("acc\xe8s refus\xe9"),this.router.navigate(["/dashboard"]),!1)}}return u.\u0275fac=function(v){return new(v||u)(t.\u0275\u0275inject(E.F0),t.\u0275\u0275inject(f.$))},u.\u0275prov=t.\u0275\u0275defineInjectable({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()},7777:(B,L,e)=>{e.d(L,{s:()=>r});var t=e(1824),E=e(2411),f=e(8053),c=e(8260),u=e(3668),g=e(5633),v=e(8274);let r=(()=>{class m extends t.c8{constructor(n,P,l){super("communes",n),this.serviceElementsFactory=n,this.confirmDialogService=P,this.toast=l,this.pageSize=c.N.pageSize,this.persistence=!1,this.submitted=!1,this.page=1}findAll(){this.findByCriteria({page:1})}getPagination(){this.pagination$=(0,E.of)(),this.pagination$=this.selectors$.entityActions$.pipe((0,f.U)(n=>n.payload.pagination))}deleteItem(n,P){this.confirmDialogService.setConfirmation("Vous \xeates s\xfbr de vouloir supprimer?",()=>{this.delete(n).pipe(this.toast.observe({loading:"Suppression...",success:()=>(P.closest("tr").remove(),"Commune supprim\xe9 avec succ\xe8s"),error:"un probl\xe8me est survenu, veuillez r\xe9essayer"})).subscribe()})}onSearch(){this.page=1,this.lastSearchedParams=this.communeForm.value,this.findByCriteria(Object.assign({page:1},this.lastSearchedParams))}onSave(){let n=this.communeForm;if(this.submitted=!0,n.invalid)return;let O,P=this.toast,l=this;if(!1===this.persistence)O=this.add(n.value);else{let C=Object.assign({},n.value);C.id=this.persistence,O=this.update(C)}O.subscribe({error:()=>P.error("un probl\xe8me est survenu, veuillez r\xe9essayer"),complete(){n.reset(),l.findByCriteria(Object.assign({page:1},l.lastSearchedParams)),P.success(`Commune a \xe9t\xe9 ${!1===l.persistence?"ajout\xe9":"mis \xe0 jour"} avec succ\xe8s`),l.persistence=!1,l.submitted=!1}})}onUpdate(n,P){this.persistence=n,this.communeForm.setValue({titre:P})}get titre(){return this.communeForm.get("titre")}findByCriteria(n){this.communes$=(0,E.of)([]);let P=Object.keys(n).filter(l=>""!=n[l]&&null!=n[l]).reduce((l,O)=>Object.assign(Object.assign({},l),{[O]:n[O]}),{});this.communes$=this.getWithQuery(P),this.getPagination()}onPaginate(n){this.findByCriteria(Object.assign({page:n},this.lastSearchedParams))}}return m.\u0275fac=function(n){return new(n||m)(u.\u0275\u0275inject(t.yV),u.\u0275\u0275inject(g.D),u.\u0275\u0275inject(v.jE))},m.\u0275prov=u.\u0275\u0275defineInjectable({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()},6761:(B,L,e)=>{e.d(L,{l:()=>S});var t=e(1824),E=e(3405),f=e(3596),c=e(2411),u=e(6813),g=e(5686),v=e(5389),r=e(8735),m=e(1366),h=e(9204),n=e(8053),P=e(2047),l=e(8260),O=e(3668),C=e(5633),b=e(5069),A=e(8274),j=e(4522);let S=(()=>{class o extends t.c8{constructor(a,s,i,d,p){super("departments",a),this.serviceElementsFactory=a,this.confirmDialogService=s,this.MediasService=i,this.toast=d,this.http=p,this.pageSize=l.N.pageSize,this.server=l.N.serverURL,this.teamLoading=!1,this.teamInput$=new E.xQ,this.submitted=!1,this.isLoading=!1,this.FileRemoved=!1,this.page=1}findAll(){this.findByCriteria({page:1})}loadTeams(a=[]){this.teams$=(0,f.z)((0,c.of)(a),this.teamInput$.pipe((0,g.b)(500),(0,v.x)(),(0,r.h)(s=>null!=s),(0,m.b)(()=>this.teamLoading=!0),(0,h.w)(s=>this.http.get(`${this.server}/api/teams?properties[]=id&properties[]=titre&titre=`+s).pipe((0,n.U)(i=>i["hydra:member"]),(0,P.K)(()=>(0,c.of)([])),(0,m.b)(()=>this.teamLoading=!1)))))}getPagination(){this.pagination$=(0,c.of)(),this.pagination$=this.selectors$.entityActions$.pipe((0,n.U)(a=>a.payload.pagination))}deleteItem(a,s){this.confirmDialogService.setConfirmation("Vous \xeates s\xfbr de vouloir supprimer?",()=>{this.delete(a).pipe(this.toast.observe({loading:"Suppression...",success:()=>(s.closest("tr").remove(),"D\xe9part supprim\xe9 avec succ\xe8s"),error:"un probl\xe8me est survenu, veuillez r\xe9essayer"})).subscribe()})}onSearch(){this.page=1,this.lastSearchedParams=this.departmentForm.value,this.findByCriteria(Object.assign({page:1},this.lastSearchedParams))}onCreate(){let a=this.departmentForm;if(this.submitted=!0,a.invalid)return;this.submitted=!1,this.isLoading=!0;let i,s=this.toast,d=this,p=Object.entries(a.value);const D=Object.fromEntries(p.filter(([M,I])=>""!==I));i=this.selectedFile?this.MediasService.Upload(this.selectedFile[0]).pipe((0,h.w)(M=>(D.visuel=M["@id"],this.add(D)))):this.add(D),i.subscribe({error:()=>{d.isLoading=!1,s.error("un probl\xe8me est survenu, veuillez r\xe9essayer")},complete(){a.reset(),d.isLoading=!1,d.selectedFile=null,s.success("D\xe9part ajout\xe9 avec succ\xe8s")}})}onUpdate(a){let s=this.departmentForm;if(this.submitted=!0,s.invalid)return;this.submitted=!1,this.isLoading=!0;let i=this,d=this.toast,p=[],D=Object.entries(s.value);const M=Object.fromEntries(D.filter(([I,y])=>""!==y));M.id=a,!1!==this.FileRemoved&&(M.visuel=null),this.selectedFile?(this.isLoading=!0,p.push(this.MediasService.Upload(this.selectedFile[0]).pipe((0,h.w)(I=>(this.uploadedFile={id:I.id,url:I.contentUrl},this.selectedFile=null,this.FileRemoved=!1,M.visuel=I["@id"],this.update(M)))))):p.push(this.update(M)),(0,u.D)(p).subscribe({error:()=>{i.isLoading=!1,d.error("un probl\xe8me est survenu, veuillez r\xe9essayer")},complete(){!1!==i.FileRemoved?i.MediasService.delete(i.FileRemoved).subscribe(()=>{i.isLoading=!1,d.success("D\xe9part a \xe9t\xe9 mis \xe0 jour avec succ\xe8s")}):(i.isLoading=!1,d.success("D\xe9part a \xe9t\xe9 mis \xe0 jour avec succ\xe8s"))}})}get titre(){return this.departmentForm.get("titre")}get visuel(){return this.departmentForm.get("visuel")}get team(){return this.departmentForm.get("team")}findByCriteria(a){this.departments$=(0,c.of)([]);let s=Object.keys(a).filter(i=>""!=a[i]&&null!=a[i]).reduce((i,d)=>Object.assign(Object.assign({},i),{[d]:a[d]}),{});this.departments$=this.getWithQuery(s),this.getPagination()}onPaginate(a){this.findByCriteria(Object.assign({page:a},this.lastSearchedParams))}}return o.\u0275fac=function(a){return new(a||o)(O.\u0275\u0275inject(t.yV),O.\u0275\u0275inject(C.D),O.\u0275\u0275inject(b.q),O.\u0275\u0275inject(A.jE),O.\u0275\u0275inject(j.eN))},o.\u0275prov=O.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()},4885:(B,L,e)=>{e.d(L,{p:()=>o});var t=e(1824),E=e(3405),f=e(3596),c=e(2411),u=e(5686),g=e(5389),v=e(8735),r=e(1366),m=e(9204),h=e(2047),n=e(8053),P=e(8260),l=e(3668),O=e(5633),C=e(6761),b=e(7777),A=e(2360),j=e(4522),S=e(8274);let o=(()=>{class _ extends t.c8{constructor(s,i,d,p,D,M,I){super("edges",s),this.serviceElementsFactory=s,this.confirmDialogService=i,this.departmentService=d,this.communeService=p,this.nodeService=D,this.http=M,this.toast=I,this.pageSize=P.N.pageSize,this.server=P.N.serverURL,this.departmentLoading=!1,this.departmentInput$=new E.xQ,this.communeLoading=!1,this.communeInput$=new E.xQ,this.ANodeLoading=!1,this.ANodeInput$=new E.xQ,this.BNodeLoading=!1,this.BNodeInput$=new E.xQ,this.submitted=!1,this.isLoading=!1,this.page=1}findAll(){this.findByCriteria({page:1})}loadDepartments(s=!0){this.departments$=s?(0,f.z)((0,c.of)([]),this.departmentInput$.pipe((0,u.b)(500),(0,g.x)(),(0,v.h)(i=>null!=i),(0,r.b)(()=>this.departmentLoading=!0),(0,m.w)(i=>this.departmentService.getWithQuery("properties[]=id&properties[]=titre&titre="+i).pipe((0,h.K)(()=>(0,c.of)([])),(0,r.b)(()=>this.departmentLoading=!1))))):this.departmentService.getWithQuery("properties[]=id&properties[]=titre")}loadCommunes(s=[]){this.communes$=(0,f.z)((0,c.of)(s),this.communeInput$.pipe((0,u.b)(500),(0,g.x)(),(0,v.h)(i=>null!=i),(0,r.b)(()=>this.communeLoading=!0),(0,m.w)(i=>this.communeService.getWithQuery("properties[]=id&properties[]=titre&titre="+i).pipe((0,h.K)(()=>(0,c.of)([])),(0,r.b)(()=>this.communeLoading=!1)))))}loadANodes(s=[]){this.ANode$=(0,f.z)((0,c.of)(s),this.ANodeInput$.pipe((0,u.b)(500),(0,g.x)(),(0,v.h)(i=>null!=i),(0,r.b)(()=>this.ANodeLoading=!0),(0,m.w)(i=>this.nodeService.getWithQuery("properties[]=id&properties[]=titre&titre="+i+(this.department?"&department.id="+this.department.value.match(/\d+/)[0]:"")).pipe((0,h.K)(()=>(0,c.of)([])),(0,r.b)(()=>this.ANodeLoading=!1)))))}loadBNodes(s=[]){this.BNode$=(0,f.z)((0,c.of)(s),this.BNodeInput$.pipe((0,u.b)(500),(0,g.x)(),(0,v.h)(i=>null!=i),(0,r.b)(()=>this.BNodeLoading=!0),(0,m.w)(i=>this.nodeService.getWithQuery("properties[]=id&properties[]=titre&titre="+i+(this.department?"&department.id="+this.department.value.match(/\d+/)[0]:"")).pipe((0,h.K)(()=>(0,c.of)([])),(0,r.b)(()=>this.BNodeLoading=!1)))))}getEdgesInRange(s,i,d=[]){return this.http.get(`${this.server}/api/edges/by-range?depar=${s}&node_a=${i}${d?"&node_b="+d:""}`).pipe((0,n.U)(p=>p["hydra:member"]))}getPagination(){this.pagination$=(0,c.of)(),this.pagination$=this.selectors$.entityActions$.pipe((0,n.U)(s=>s.payload.pagination))}deleteItem(s,i){this.confirmDialogService.setConfirmation("Vous \xeates s\xfbr de vouloir supprimer cet edge ?",()=>{this.delete(s).pipe(this.toast.observe({loading:"Suppression...",success:()=>(i.closest("tr").remove(),"L'edge supprim\xe9 avec succ\xe8s"),error:"un probl\xe8me est survenu, veuillez r\xe9essayer"})).subscribe()})}onSearch(){this.page=1,this.lastSearchedParams=this.edgeForm.value,this.findByCriteria(Object.assign({page:1},this.lastSearchedParams))}onCreate(){let s=this.edgeForm;if(this.submitted=!0,s.invalid)return;this.submitted=!1;let i=this.toast,d=Object.entries(s.value);const p=Object.fromEntries(d.filter(([D,M])=>""!==M));this.add(p).subscribe({error:()=>i.error("un probl\xe8me est survenu, veuillez r\xe9essayer"),complete(){s.reset(),i.success("L'edge ajout\xe9 avec succ\xe8s")}})}onUpdate(s){let i=this.edgeForm;if(this.submitted=!0,i.invalid)return;this.submitted=!1;let d=this.toast,p=Object.assign({},i.value);p.id=s,this.update(p).subscribe({error:()=>d.error("un probl\xe8me est survenu, veuillez r\xe9essayer"),complete(){d.success("L'edge a \xe9t\xe9 mis \xe0 jour avec succ\xe8s")}})}get titre(){return this.edgeForm.get("titre")}get department(){return this.edgeForm.get("department")}get BNode(){return this.edgeForm.get("nodeA")}get ANode(){return this.edgeForm.get("nodeB")}get addNonExitingAssociation(){return this.importForm.get("addNonExitingAssociation")}get spreadSheet(){return this.importForm.get("spreadSheet")}get updateIfExist(){return this.importForm.get("updateIfExist")}findByCriteria(s){this.edges$=(0,c.of)([]);let i=Object.keys(s).filter(d=>""!=s[d]&&null!=s[d]).reduce((d,p)=>Object.assign(Object.assign({},d),{[p]:s[p]}),{});this.edges$=this.getWithQuery(i),this.getPagination()}onPaginate(s){this.findByCriteria(Object.assign({page:s},this.lastSearchedParams))}exportSpreadSheet(){let s=this.exportForm;this.isLoading=!0;let i=this,d=this.toast,p=`${this.server}/api/export_spreadsheet`,D=Object.entries(s.value);const M=Object.fromEntries(D.filter(([I,y])=>""!==y&&null!==y));this.http.post(p,{className:"edge",filter:M},{responseType:"blob"}).subscribe(I=>{i.isLoading=!1;const y=new Blob([I],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),U=window.URL.createObjectURL(y);window.open(U,"_blank").focus()},I=>{i.isLoading=!1,d.error("un probl\xe8me est survenu, veuillez r\xe9essayer"+I)})}importSpreadSheet(){if(this.submitted=!0,this.isLoading=!0,this.importForm.invalid)return;let s=`${this.server}/api/import_spreadsheet`,i=this,d=this.toast,p=new FormData;p.append("spreadSheet",this.selectedFile),p.append("addNonExAssoc",this.addNonExitingAssociation.value),p.append("updateIfExist",this.updateIfExist.value),p.append("className","edge"),p.append("uniqueColumns","NodeA,NodeB"),this.http.post(s,p,{reportProgress:!0,responseType:"json"}).pipe().subscribe(D=>{i.importForm.reset(),i.selectedFile=null,i.submitted=!1,i.isLoading=!1,i.uploadResponse=D.messages,d.show("L'op\xe9ration se termine avec succ\xe8s",{icon:""})},D=>{i.isLoading=!1,d.error("un probl\xe8me est survenu, veuillez r\xe9essayer"+D)})}}return _.\u0275fac=function(s){return new(s||_)(l.\u0275\u0275inject(t.yV),l.\u0275\u0275inject(O.D),l.\u0275\u0275inject(C.l),l.\u0275\u0275inject(b.s),l.\u0275\u0275inject(A.B),l.\u0275\u0275inject(j.eN),l.\u0275\u0275inject(S.jE))},_.\u0275prov=l.\u0275\u0275defineInjectable({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()},5069:(B,L,e)=>{e.d(L,{q:()=>u});var t=e(1824),E=e(8260),f=e(3668),c=e(4522);let u=(()=>{class g extends t.c8{constructor(r,m){super("media_objects",r),this.serviceElementsFactory=r,this.http=m,this.server=E.N.serverURL}Upload(r){let m=`${this.server}/api/media_objects`,h=new FormData;return h.append("file",r,r.name),this.http.post(m,h,{reportProgress:!0,responseType:"json"}).pipe()}}return g.\u0275fac=function(r){return new(r||g)(f.\u0275\u0275inject(t.yV),f.\u0275\u0275inject(c.eN))},g.\u0275prov=f.\u0275\u0275defineInjectable({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()},2360:(B,L,e)=>{e.d(L,{B:()=>A});var t=e(1824),E=e(3405),f=e(3596),c=e(2411),u=e(5686),g=e(5389),v=e(8735),r=e(1366),m=e(9204),h=e(2047),n=e(8053),P=e(8260),l=e(3668),O=e(5633),C=e(6761),b=e(8274);let A=(()=>{class j extends t.c8{constructor(o,_,a,s){super("nodes",o),this.serviceElementsFactory=o,this.confirmDialogService=_,this.departmentService=a,this.toast=s,this.pageSize=P.N.pageSize,this.departmentLoading=!1,this.departmentInput$=new E.xQ,this.submitted=!1,this.page=1}findAll(){this.findByCriteria({page:1})}loadDepartments(o=!0){this.departments$=o?(0,f.z)((0,c.of)([]),this.departmentInput$.pipe((0,u.b)(500),(0,g.x)(),(0,v.h)(_=>null!=_),(0,r.b)(()=>this.departmentLoading=!0),(0,m.w)(_=>this.departmentService.getWithQuery("properties[]=id&properties[]=titre&titre="+_).pipe((0,h.K)(()=>(0,c.of)([])),(0,r.b)(()=>this.departmentLoading=!1))))):this.departmentService.getWithQuery("properties[]=id&properties[]=titre")}getPagination(){this.pagination$=(0,c.of)(),this.pagination$=this.selectors$.entityActions$.pipe((0,n.U)(o=>o.payload.pagination))}deleteItem(o,_){this.confirmDialogService.setConfirmation("Vous \xeates s\xfbr de vouloir supprimer cet node ?",()=>{this.delete(o).pipe(this.toast.observe({loading:"Suppression...",success:()=>(_.closest("tr").remove(),"L'node supprim\xe9 avec succ\xe8s"),error:"un probl\xe8me est survenu, veuillez r\xe9essayer"})).subscribe()})}onSearch(){this.page=1,this.lastSearchedParams=this.nodeForm.value,this.findByCriteria(Object.assign({page:1},this.lastSearchedParams))}onCreate(){let o=this.nodeForm;if(this.submitted=!0,o.invalid)return;this.submitted=!1;let _=this.toast;this.add(o.value).subscribe({error:()=>_.error("un probl\xe8me est survenu, veuillez r\xe9essayer"),complete(){o.reset(),_.success("L'node ajout\xe9 avec succ\xe8s")}})}onUpdate(o){let _=this.nodeForm;if(this.submitted=!0,_.invalid)return;this.submitted=!1;let a=this.toast,s=Object.assign({},_.value);s.id=o,this.update(s).subscribe({error:()=>a.error("un probl\xe8me est survenu, veuillez r\xe9essayer"),complete(){a.success("L'node a \xe9t\xe9 mis \xe0 jour avec succ\xe8s")}})}get titre(){return this.nodeForm.get("titre")}get membres(){return this.nodeForm.get("membres")}get departments(){return this.nodeForm.get("departments")}findByCriteria(o){this.nodes$=(0,c.of)([]);let _=Object.keys(o).filter(a=>""!=o[a]&&null!=o[a]).reduce((a,s)=>Object.assign(Object.assign({},a),{[s]:o[s]}),{});this.nodes$=this.getWithQuery(_),this.getPagination()}onPaginate(o){this.findByCriteria(Object.assign({page:o},this.lastSearchedParams))}}return j.\u0275fac=function(o){return new(o||j)(l.\u0275\u0275inject(t.yV),l.\u0275\u0275inject(O.D),l.\u0275\u0275inject(C.l),l.\u0275\u0275inject(b.jE))},j.\u0275prov=l.\u0275\u0275defineInjectable({token:j,factory:j.\u0275fac,providedIn:"root"}),j})()},1950:(B,L,e)=>{e.d(L,{V:()=>v});var t=e(3668),E=e(6019);function f(r,m){1&r&&(t.\u0275\u0275elementStart(0,"div",8),t.\u0275\u0275elementStart(1,"span",9),t.\u0275\u0275text(2,"Loading..."),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementEnd())}function c(r,m){if(1&r&&(t.\u0275\u0275elementStart(0,"li",12),t.\u0275\u0275elementStart(1,"a",13),t.\u0275\u0275text(2),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementEnd()),2&r){const h=t.\u0275\u0275nextContext().$implicit;t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate(h.label)}}function u(r,m){if(1&r&&(t.\u0275\u0275elementStart(0,"li",14),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&r){const h=t.\u0275\u0275nextContext().$implicit;t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1("",h.label," ")}}function g(r,m){if(1&r&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275template(1,c,3,1,"li",10),t.\u0275\u0275template(2,u,2,1,"li",11),t.\u0275\u0275elementContainerEnd()),2&r){const h=m.$implicit;t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!h.active),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",h.active)}}let v=(()=>{class r{constructor(){}ngOnInit(){}}return r.\u0275fac=function(h){return new(h||r)},r.\u0275cmp=t.\u0275\u0275defineComponent({type:r,selectors:[["app-page-title"]],inputs:{breadcrumbItems:"breadcrumbItems",title:"title",Loading:"Loading"},decls:9,vars:3,consts:[[1,"row"],[1,"col-12"],[1,"page-title-box","d-flex","align-items-center","justify-content-between"],[1,"mb-0","font-size-18"],["role","status","class","spinner-grow ms-1 spinner-grow-sm text-primary",4,"ngIf"],[1,"page-title-right","d-none","d-md-block"],[1,"breadcrumb","m-0"],[4,"ngFor","ngForOf"],["role","status",1,"spinner-grow","ms-1","spinner-grow-sm","text-primary"],[1,"sr-only"],["class","breadcrumb-item",4,"ngIf"],["class","breadcrumb-item active",4,"ngIf"],[1,"breadcrumb-item"],["href","javascript: void(0);"],[1,"breadcrumb-item","active"]],template:function(h,n){1&h&&(t.\u0275\u0275elementStart(0,"div",0),t.\u0275\u0275elementStart(1,"div",1),t.\u0275\u0275elementStart(2,"div",2),t.\u0275\u0275elementStart(3,"h4",3),t.\u0275\u0275text(4),t.\u0275\u0275template(5,f,3,0,"div",4),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(6,"div",5),t.\u0275\u0275elementStart(7,"ol",6),t.\u0275\u0275template(8,g,3,2,"ng-container",7),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementEnd()),2&h&&(t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate1(" ",n.title," "),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",n.Loading),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngForOf",n.breadcrumbItems))},directives:[E.NgIf,E.NgForOf],encapsulation:2}),r})()}}]);